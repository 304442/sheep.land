<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Egypt's premier destination for premium sheep, livesheep, fresh meat, and Sharia-compliant Udheya services. Serving Egypt and international customers with quality guaranteed.">
    <title x-text="pageTitle()">Sheep Land</title>
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="sheep, udheya, qurbani, sacrifice, halal meat, live sheep, Egypt, fresh meat, عيد الأضحى, أضحية">
    <meta name="author" content="Sheep Land Egypt">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://sheep.land">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Sheep Land - Premium Live Sheep & Udheya Services">
    <meta property="og:description" content="Egypt's premier destination for premium sheep, livesheep, fresh meat, and Sharia-compliant Udheya services.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sheep.land">
    <meta property="og:image" content="https://sheep.land/images/og-image.jpg">
    <meta property="og:locale" content="en_US">
    <meta property="og:locale:alternate" content="ar_EG">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sheep Land - Premium Live Sheep & Udheya Services">
    <meta name="twitter:description" content="Egypt's premier destination for premium sheep and Sharia-compliant Udheya services.">
    <meta name="twitter:image" content="https://sheep.land/images/twitter-card.jpg">
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#2C5F41">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Kufi+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles-extra.css">
    <style>[x-cloak]{display:none!important}</style>
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Sheep Land Egypt",
        "url": "https://sheep.land",
        "logo": "https://sheep.land/logo.png",
        "description": "Egypt's premier destination for premium sheep, livesheep, fresh meat, and Sharia-compliant Udheya services.",
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "EG",
            "addressRegion": "Cairo"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+201234567890",
            "contactType": "customer service",
            "availableLanguage": ["en", "ar"]
        },
        "sameAs": [
            "https://www.facebook.com/sheeplandegypt",
            "https://www.instagram.com/sheeplandegypt"
        ]
    }
    </script>
</head>
<body x-data="sheepLand" x-init="initApp()" x-cloak :class="{'has-promo-bar': settings.promoActive && !cd.ended && !isPromoBarDismissed}">

<!-- Skip to content link for keyboard navigation -->
<a href="#main-content" class="skip-to-content">Skip to main content</a>

<div x-show="load.init && !apiErr" class="load-ind" aria-live="polite">Loading Sheep Land...</div>
<div x-show="apiErr" class="err-ind" role="alert" aria-live="assertive" tabindex="-1">
    <span x-show="!setupRequired" x-text="usrApiErr || 'Service temporarily unavailable. Please try again.'"></span>
    <span x-show="setupRequired" class="err-text" x-text="usrApiErr || 'System initialization required. Please contact administrator.'"></span>
</div>



<div x-show="isRefundModalOpen" class="modal-overlay" @click="closeRefundModal()" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
<div x-show="isRefundModalOpen" class="modal" role="dialog" aria-modal="true" aria-labelledby="refund-modal-title" @keydown.escape.window="closeRefundModal()" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform translate-y-4" x-transition:enter-end="opacity-100 transform translate-y-0" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 transform translate-y-0" x-transition:leave-end="opacity-0 transform translate-y-4">
    <div class="modal-header">
        <h2 id="refund-modal-title" class="bil-spread modal-title">
            <span class="en">Refund & Cancellation Policy</span><span class="ar" dir="rtl">سياسة الاسترداد والإلغاء</span>
        </h2>
        <button @click="closeRefundModal()" class="modal-close-btn" aria-label="Close refund policy modal">×</button>
    </div>
    <div class="modal-content policy-container">
         <div x-html="settings.refundPolicyHTMLContent || '<p>Loading refund policy...</p>'"></div>
    </div>
</div>

<div x-show="isOrderStatusModalOpen" class="modal-overlay" @click="closeOrderStatusModal()"></div>
<div x-show="isOrderStatusModalOpen" class="modal" role="dialog" aria-modal="true" aria-labelledby="order-status-modal-title" @keydown.escape.window="closeOrderStatusModal()">
    <div class="modal-header">
        <h2 id="order-status-modal-title" class="bil-spread modal-title">
            <span class="en">Check Order Status</span><span class="ar">تحقق من حالة الطلب</span>
        </h2>
        <button @click="closeOrderStatusModal()" class="modal-close-btn" aria-label="Close order status modal">×</button>
    </div>
    <div class="modal-content">
        <form @submit.prevent="submitStatValid()" novalidate>
            <div class="fg">
                <label for="order_id_lookup_modal" class="bil-spread lbl-req"><span class="en">Enter Order ID *</span><span class="ar">أدخل رقم الطلب *</span></label>
                <input type="text" id="order_id_lookup_modal" class="input" x-model="lookupOrderID" placeholder="e.g., A1B2C3D4E5" x-ref="lookupOrderIdInputModal" @input="clrErr('lookupOrderID')">
                <div class="err-msg" x-show="errs.lookupOrderID" x-text="errs.lookupOrderID ? (currLang === 'ar' ? errs.lookupOrderID.ar : errs.lookupOrderID.en) : ''"></div>
            </div>
            <div class="card-act">
                <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.status">
                    <span x-show="!load.status"><span class="en">Check Status</span><span class="ar">تحقق من الحالة</span></span>
                    <span x-show="load.status"><span class="en">Checking...</span><span class="ar">جاري...</span></span>
                </button>
            </div>
        </form>
        <div class="order-stat-res" x-show="load.status || statRes || statNotFound">
            <div x-show="load.status && !statRes && !statNotFound" class="load-text tc">Checking...</div>
            <div x-show="statRes && !load.status">
                <h4 class="form-subh bil-spread"><span class="en">Order Details</span><span class="ar">تفاصيل الطلب</span></h4>
                <div class="sum-item bil-row"><div class="en"><strong>ID:</strong> <span x-text="statRes?.orderIdTxt || ''"></span></div><div class="ar"><strong>رقم الطلب:</strong> <span x-text="statRes?.orderIdTxt || ''"></span></div></div>
                <div class="sum-item bil-row"><div class="en"><strong>Status:</strong> <span class="stat-hl" x-text="statRes?.order_status || ''"></span></div><div class="ar"><strong>حالة الطلب:</strong> <span class="stat-hl" x-text="statRes?.order_status || ''"></span></div></div>
                <div class="sum-item"><div><strong>Total:</strong> <span x-text="fmtPrice(statRes?.total_amount_due_egp)"></span></div></div>
            </div>
            <div class="stat-no-res bil-row tc" x-show="statNotFound && !statRes && !load.status"><p class="en">No order found. Check ID or contact support.</p><p class="ar">لم يتم العثور على طلب. تحقق من رقم الطلب أو اتصل بالدعم.</p></div>
        </div>
    </div>
</div>


<div x-show="isUdheyaConfigModalOpen" class="modal-overlay" @click="closeUdheyaConfiguration()"></div>
<div x-show="isUdheyaConfigModalOpen" class="modal udheya-config-modal" role="dialog" aria-modal="true" @keydown.escape.window="closeUdheyaConfiguration()">
    <div class="modal-header">
        <h2 class="bil-spread modal-title">
            <span class="en">Configure Your Udheya</span><span class="ar" dir="rtl">تخصيص الأضحية</span>
        </h2>
        <button @click="closeUdheyaConfiguration()" class="modal-close-btn">×</button>
    </div>
    <div class="modal-content">
        <div x-show="configuringUdheyaItem">
            <h3 class="bil-spread modal-section-title"><span x-text="configuringUdheyaItem?.nameENSpec"></span><span x-text="configuringUdheyaItem?.nameARSpec"></span></h3>
            <div class="fg">
                <label class="bil-spread lbl-req"><span class="en">Service Option *</span><span class="ar">خيار الخدمة *</span></label>
                <div class="rgrp">
                    <label class="bil-radio">
                        <input type="radio" name="service_option_udh_conf" value="standard_service" x-model="tempUdheyaConfig.serviceOption" @change="clrErr('udheya_service_config')">
                        <div class="radio-text">
                            <span class="en">Standard Service - <strong x-text="fmtPrice(settings.servFeeEGP)"></strong></span>
                            <span class="ar">الخدمة العادية - <strong x-text="fmtPrice(settings.servFeeEGP)"></strong></span>
                        </div>
                    </label>
                    <label class="bil-radio">
                        <input type="radio" name="service_option_udh_conf" value="live_animal_delivery" x-model="tempUdheyaConfig.serviceOption" @change="clrErr('udheya_service_config')">
                        <div class="radio-text">
                            <span class="en">Live Animal Delivery</span>
                            <span class="ar">توصيل حيوان حي</span>
                        </div>
                    </label>
                </div>
                <div class="err-msg" x-show="errs.udheya_service_config" x-text="getUdheyaConfigErrorText()"></div>
            </div>
            <div class="fg" x-show="tempUdheyaConfig.serviceOption === 'standard_service'">
                <label class="bil-spread lbl-req"><span class="en">Sacrifice Day *</span><span class="ar">يوم الذبح *</span></label>
                <select class="input" x-model="tempUdheyaConfig.sacrificeDay" @change="clrErr('udheya_sacrifice_day_config')">
                    <option value="">-- Select Day --</option>
                    <template x-for="(dayInfo, dayValue) in sacrificeDayMapInternal" :key="dayValue">
                        <option :value="dayValue"><span x-text="dayInfo.en + ' / ' + dayInfo.ar"></span></option>
                    </template>
                </select>
            </div>
            <div class="fg" x-show="tempUdheyaConfig.serviceOption === 'standard_service'">
                <label class="bil-spread lbl-req"><span class="en">Distribution Choice *</span><span class="ar">خيار التوزيع *</span></label>
                <div class="rgrp">
                    <template x-for="opt in distrOpts()" :key="opt.val">
                        <label class="bil-radio">
                            <input type="radio" name="distribution_choice_udh_conf" :value="opt.val" x-model="tempUdheyaConfig.distribution.choice" @change="clrErr('udheya_distribution_choice_config')">
                            <div class="radio-text">
                                <span class="en" x-text="opt.txtEn"></span>
                                <span class="ar" x-text="opt.txtAr"></span>
                            </div>
                        </label>
                    </template>
                </div>
                <div x-show="tempUdheyaConfig.distribution.choice === 'split'">
                    <template x-for="opt in splitOptsList()" :key="opt.val">
                        <label class="bil-radio">
                            <input type="radio" name="split_option_udh_conf" :value="opt.val" x-model="tempUdheyaConfig.distribution.splitOption">
                            <div class="radio-text">
                                <span class="en" x-text="opt.txtEn"></span>
                                <span class="ar" x-text="opt.txtAr"></span>
                            </div>
                        </label>
                    </template>
                    <textarea x-show="tempUdheyaConfig.distribution.splitOption === 'custom'" class="input" rows="2" x-model="tempUdheyaConfig.distribution.customSplitText" placeholder="Specify custom distribution"></textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" @click="confirmUdheyaConfigurationAndProceed()" class="btn bac">
            <span x-text="tempUdheyaConfig.isBuyNowIntent ? 'Confirm & Buy Now' : 'Confirm & Add to Cart'"></span>
        </button>
    </div>
</div>

<!-- Top Contact Bar -->
<div class="top-contact-bar">
    <div class="c">
        <div class="contact-bar-content">
            <div class="contact-bar-items">
                <button @click="openOrderStatusModal()" class="track-order-btn" title="Track Your Order">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    <span class="bil-inline">
                        <span class="en">Track Order</span>
                        <span class="ar">تتبع الطلب</span>
                    </span>
                </button>
                <div class="wa-contact-top">
                    <button @click="toggleWhatsAppChat()" class="wa-contact-btn" title="WhatsApp Chat">
                        <svg class="wa-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                        </svg>
                        <span x-text="settings.waNumDisp"></span>
                    </button>
                </div>
                <button @click="feedbackSystem.openFeedbackModal()" class="feedback-top-btn" title="Give Feedback">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
                    </svg>
                    <span class="bil-inline">
                        <span class="en">Feedback</span>
                        <span class="ar">رأيك</span>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Promo Bar -->
<div x-show="settings.promoActive && !cd.ended && !isPromoBarDismissed" class="promo-bar" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 transform translate-y-0" x-transition:leave-end="opacity-0 transform -translate-y-full">
    <div class="c">
        <div class="promo-bar-content">
            <div class="promo-bar-row promo-bar-text">
                <span class="promo-bar-title-en">🎉 Limited Time Offer!</span>
                <span class="promo-bar-title-ar">🎉 عرض لفترة محدودة!</span>
                <span class="promo-bar-discount">
                    <span x-text="settings.promoDiscPc + '%'"></span> OFF
                </span>
                <span class="promo-bar-code">
                    PROMO<span x-text="settings.promoDiscPc"></span>
                </span>
            </div>
            <div class="promo-bar-row promo-bar-countdown-row" x-show="!cd.ended">
                <div class="cd-mini">
                    <span class="cd-mini-item">
                        <span class="cd-mini-val" x-text="cd.days"></span>
                        <span class="cd-mini-lbl">d</span>
                    </span>
                    <span class="cd-mini-sep">:</span>
                    <span class="cd-mini-item">
                        <span class="cd-mini-val" x-text="cd.hours"></span>
                        <span class="cd-mini-lbl">h</span>
                    </span>
                    <span class="cd-mini-sep">:</span>
                    <span class="cd-mini-item">
                        <span class="cd-mini-val" x-text="cd.mins"></span>
                        <span class="cd-mini-lbl">m</span>
                    </span>
                    <span class="cd-mini-sep">:</span>
                    <span class="cd-mini-item">
                        <span class="cd-mini-val" x-text="cd.secs"></span>
                        <span class="cd-mini-lbl">s</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<header class="site-head" :class="{'with-promo': settings.promoActive && !cd.ended && !isPromoBarDismissed}">
    <div class="c nav-cont">
        <a href="#home" class="logo bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('home')">
            <span class="en" x-text="settings.site_title_en || 'Sheep Land Egypt'"></span>
            <span class="ar" x-text="settings.site_title_ar || 'أرض الأغنام مصر'"></span>
        </a>

        <nav class="nav-main nav-desk">
            <ul class="nav-list">
                <li>
                    <a href="#sacrifices" class="nav-link nav-bil-inline" @click.prevent="scrollToSection('sacrifices')">
                        <span class="en">Sacrifices</span>
                        <span class="ar">ذبائح</span>
                    </a>
                </li>
                <li>
                    <a href="#fresh-meat" class="nav-link nav-bil-inline" @click.prevent="scrollToSection('fresh-meat')">
                        <span class="en">Fresh Meat</span>
                        <span class="ar">لحوم طازجة</span>
                    </a>
                </li>
                <li>
                    <a href="#events-catering" class="nav-link nav-bil-inline" @click.prevent="scrollToSection('events-catering')">
                        <span class="en">Events & Catering</span>
                        <span class="ar">مناسبات وولائم</span>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="head-extras desk-extras">
            <button @click="toggleSearch()" class="header-action-btn" title="Search" aria-label="Toggle search">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
            </button>
            <template x-if="!currentUser">
                <button @click="toggleAuthDropdown()" class="header-action-btn" title="Login">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </button>
            </template>
            <template x-if="currentUser">
                <button @click="toggleAccountDropdown()" class="header-action-btn" title="My Account">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </button>
            </template>
            <button @click="toggleWishlistDropdown()" class="header-action-btn wishlist-btn" title="Wishlist">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                </svg>
                <span x-show="wishlistCount > 0" class="wishlist-badge" x-text="wishlistCount"></span>
            </button>
            <button @click="toggleCart()" class="header-action-btn" title="Shopping Cart">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
                <span x-show="cartItems.length > 0" class="cart-count-badge" x-text="cartItemCount"></span>
            </button>
            <div class="curr-sel">
                <select x-model="curr" title="Currency">
                    <template x-for="code in Object.keys(settings.xchgRates)" :key="code">
                        <option :value="code" :disabled="!settings.xchgRates[code].is_active" x-text="code + ' (' + (settings.xchgRates[code].symbol || code) + ')'">
                        </option>
                    </template>
                </select>
            </div>
        </div>

        <div class="head-extras mob-extras">
            <button @click="toggleSearch()" class="header-action-btn" title="Search" aria-label="Toggle search">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
            </button>
            <template x-if="!currentUser">
                <button @click="toggleAuthDropdown()" class="header-action-btn" title="Login">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </button>
            </template>
            <template x-if="currentUser">
                <button @click="toggleAccountDropdown()" class="header-action-btn" title="My Account">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </button>
            </template>
            <button @click="toggleWishlistDropdown()" class="header-action-btn wishlist-btn" title="Wishlist">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                </svg>
                <span x-show="wishlistCount > 0" class="wishlist-badge" x-text="wishlistCount"></span>
            </button>
            <button @click="toggleCart()" class="header-action-btn" title="Shopping Cart">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/>
                    <circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                </svg>
                <span x-show="cartItems.length > 0" class="cart-count-badge" x-text="cartItemCount"></span>
            </button>
            <div class="curr-sel">
                <select x-model="curr" title="Currency">
                    <template x-for="code in Object.keys(settings.xchgRates)" :key="code">
                        <option :value="code" :disabled="!settings.xchgRates[code].is_active" x-text="code + ' (' + (settings.xchgRates[code].symbol || code) + ')'">
                        </option>
                    </template>
                </select>
            </div>
            <button class="menu-btn" @click="isMobNavOpen = !isMobNavOpen" title="Menu">☰</button>
        </div>
    </div>

</header>

<!-- Search Dropdown -->
<div class="search-dropdown" x-show="showSearch" x-transition @click.outside="closeAllDropdowns()">
    <div class="c">
        <div class="search-dropdown-content">
            <input 
                type="text" 
                id="searchBar"
                class="search-input-header" 
                x-model="searchQuery"
                @input="filterProducts()"
                :placeholder="currLang === 'en' ? 'Search products...' : 'ابحث عن المنتجات...'"
                x-ref="searchInput"
                @keydown.escape="showSearch = false"
            >
            <div class="search-results" x-show="searchQuery.length > 1">
                <template x-for="category in Object.keys(filteredProducts)" :key="category">
                    <template x-if="filteredProducts[category] && filteredProducts[category].length > 0">
                        <div class="search-category">
                            <h4 class="bil-inline">
                                <span class="en" x-text="getCategoryDisplayName(category).en"></span>
                                <span class="ar" x-text="getCategoryDisplayName(category).ar"></span>
                            </h4>
                            <template x-for="product in filteredProducts[category]" :key="product.itemKey">
                                <div class="search-result-item" @click="navigateToOrScroll(category); showSearch = false; searchQuery = ''">
                                    <div class="bil-spread">
                                        <span class="en" x-text="product.nameENSpec"></span>
                                        <span class="ar" x-text="product.nameARSpec"></span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </template>
                </template>
                <div x-show="Object.keys(filteredProducts).length === 0 && searchQuery.length > 1" class="empty-state tc">
                    <p class="bil-row">
                        <span class="en">No products found</span>
                        <span class="ar">لم يتم العثور على منتجات</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- WhatsApp Dropdown -->
<div class="whatsapp-dropdown" x-show="showWhatsAppChat" x-transition @click.outside="closeAllDropdowns()">
    <div class="c">
        <div class="whatsapp-dropdown-content">
            <div class="whatsapp-header">
                <div class="whatsapp-info">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="#25D366">
                        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                    </svg>
                    <div>
                        <h3 class="bil-row">
                            <span class="en">WhatsApp Chat</span>
                            <span class="ar">دردشة واتساب</span>
                        </h3>
                        <p class="whatsapp-status">
                            <span class="status-dot"></span>
                            <span class="bil-inline">
                                <span class="en">Available</span>
                                <span class="ar">متاح</span>
                            </span>
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="whatsapp-messages">
                <div class="welcome-message">
                    <p class="bil-row">
                        <span class="en">Hello! How can we help you today?</span>
                        <span class="ar">مرحباً! كيف يمكننا مساعدتك اليوم؟</span>
                    </p>
                </div>
                <template x-for="msg in chatMessages" :key="msg.id">
                    <div class="chat-message sent">
                        <p x-text="msg.text"></p>
                        <span class="msg-time" x-text="msg.time"></span>
                    </div>
                </template>
            </div>
            
            <div class="whatsapp-quick-actions">
                <button @click="sendQuickWhatsAppMessage('I need help with my order')" class="quick-action-btn">
                    <span class="bil-inline">
                        <span class="en">Order Help</span>
                        <span class="ar">مساعدة الطلب</span>
                    </span>
                </button>
                <button @click="sendQuickWhatsAppMessage('What are your available products?')" class="quick-action-btn">
                    <span class="bil-inline">
                        <span class="en">Product Info</span>
                        <span class="ar">معلومات المنتج</span>
                    </span>
                </button>
                <button @click="sendQuickWhatsAppMessage('I want to check delivery options')" class="quick-action-btn">
                    <span class="bil-inline">
                        <span class="en">Delivery</span>
                        <span class="ar">التوصيل</span>
                    </span>
                </button>
            </div>
            
            <form @submit.prevent="sendWhatsAppMessage()" class="whatsapp-input-form">
                <input 
                    type="text" 
                    x-model="chatMessage" 
                    class="whatsapp-input" 
                    :placeholder="currLang === 'en' ? 'Type a message...' : 'اكتب رسالة...'"
                    x-ref="whatsappInput"
                >
                <button type="submit" class="whatsapp-send-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                    </svg>
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Account Dropdown -->
<div class="account-dropdown" x-show="showAccountDropdown" x-transition @click.outside="closeAllDropdowns()">
    <div class="c">
        <div class="account-dropdown-content">
            <div class="account-info">
                <div class="account-header">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="account-avatar">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    <div class="account-details">
                        <h3 class="account-name" x-text="currentUser?.name || 'Welcome'"></h3>
                        <p class="account-email" x-text="currentUser?.email"></p>
                    </div>
                </div>
                <div class="account-menu">
                    <a href="#account" @click="closeAllDropdowns(); navigateToOrScroll('account')" class="account-menu-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 11H3v10h6V11zm5 0h6v10h-6V11zM10 3h4v5h-4V3z"/>
                        </svg>
                        <span class="bil-inline">
                            <span class="en">My Orders</span>
                            <span class="ar">طلباتي</span>
                        </span>
                    </a>
                    <a href="#account" @click="closeAllDropdowns(); navigateToOrScroll('account')" class="account-menu-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                        <span class="bil-inline">
                            <span class="en">Profile Settings</span>
                            <span class="ar">إعدادات الحساب</span>
                        </span>
                    </a>
                    <template x-if="currentUser?.is_admin === true">
                        <div class="admin-section">
                            <div class="account-menu-divider"></div>
                            <h4 class="account-menu-section-title bil-inline">
                                <span class="en">Admin Tools</span>
                                <span class="ar">أدوات الإدارة</span>
                            </h4>
                            <button @click="closeAllDropdowns(); openFeasibilityModal()" class="account-menu-item admin-menu-item">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 11l3 3L22 4"/>
                                    <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
                                </svg>
                                <span class="bil-inline">
                                    <span class="en">Feasibility Calculator</span>
                                    <span class="ar">حاسبة الجدوى</span>
                                </span>
                            </button>
                            <button @click="closeAllDropdowns(); openFarmModal()" class="account-menu-item admin-menu-item">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                                    <polyline points="9 22 9 12 15 12 15 22"/>
                                </svg>
                                <span class="bil-inline">
                                    <span class="en">Farm Management</span>
                                    <span class="ar">إدارة المزرعة</span>
                                </span>
                            </button>
                        </div>
                    </template>
                    <button @click="logoutUser(); closeAllDropdowns();" class="account-menu-item logout-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                            <polyline points="16 17 21 12 16 7"/>
                            <line x1="21" y1="12" x2="9" y2="12"/>
                        </svg>
                        <span class="bil-inline">
                            <span class="en">Logout</span>
                            <span class="ar">تسجيل الخروج</span>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Mobile Navigation Dropdown -->
<div class="mobile-nav-dropdown" x-show="isMobNavOpen" x-transition @click.outside="closeAllDropdowns()">
    <div class="c">
        <div class="mobile-nav-content">
            <nav>
                <ul class="nav-list-mob">
                    <li><a href="#sacrifices" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; scrollToSection('sacrifices')"><span class="en">Sacrifices</span><span class="ar">ذبائح</span></a></li>
                    <li><a href="#fresh-meat" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; scrollToSection('fresh-meat')"><span class="en">Fresh Meat</span><span class="ar">لحوم طازجة</span></a></li>
                    <li><a href="#events-catering" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; scrollToSection('events-catering')"><span class="en">Events & Catering</span><span class="ar">مناسبات وولائم</span></a></li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Auth/Login Dropdown -->
<div class="auth-dropdown" x-show="showAuthDropdown" x-transition @click.outside="closeAllDropdowns()">
    <div class="c">
        <div class="auth-dropdown-content">
            <!-- Welcome/Choice View -->
            <div x-show="auth.view === 'welcome'" class="auth-view">
                <div class="auth-header">
                    <h2 class="bil-spread">
                        <span class="en">Welcome</span>
                        <span class="ar">مرحباً</span>
                    </h2>
                    <p class="auth-subtitle bil-spread">
                        <span class="en">Sign in or create an account</span>
                        <span class="ar">تسجيل الدخول أو إنشاء حساب</span>
                    </p>
                </div>
                <div class="auth-quick-actions">
                    <button @click="auth.view = 'login'" class="auth-action-btn primary">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
                            <polyline points="10 17 15 12 10 7"/>
                            <line x1="15" y1="12" x2="3" y2="12"/>
                        </svg>
                        <span class="bil-inline">
                            <span class="en">Sign In</span>
                            <span class="ar">تسجيل الدخول</span>
                        </span>
                    </button>
                    <button @click="auth.view = 'register'" class="auth-action-btn secondary">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="8.5" cy="7" r="4"/>
                            <line x1="20" y1="8" x2="20" y2="14"/>
                            <line x1="23" y1="11" x2="17" y2="11"/>
                        </svg>
                        <span class="bil-inline">
                            <span class="en">Create Account</span>
                            <span class="ar">إنشاء حساب</span>
                        </span>
                    </button>
                </div>
                <div class="auth-divider">
                    <span class="bil-inline">
                        <span class="en">or continue as</span>
                        <span class="ar">أو تابع كـ</span>
                    </span>
                </div>
                <button @click="showAuthDropdown = false; navigateToOrScroll('checkout')" class="auth-action-btn guest">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    <span class="bil-inline">
                        <span class="en">Guest Checkout</span>
                        <span class="ar">الشراء كضيف</span>
                    </span>
                </button>
            </div>

            <!-- Login View -->
            <div x-show="auth.view === 'login'" class="auth-view">
                <div class="auth-header">
                    <button @click="auth.view = 'welcome'" class="auth-back-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15 18 9 12 15 6"/>
                        </svg>
                    </button>
                    <h2 class="bil-spread">
                        <span class="en">Sign In</span>
                        <span class="ar">تسجيل الدخول</span>
                    </h2>
                </div>
                <form @submit.prevent="loginUser()" class="auth-form">
                    <div x-show="errs.auth_login" class="err-msg" x-text="errs.auth_login ? (currLang === 'ar' ? errs.auth_login.ar : errs.auth_login.en) : ''"></div>
                    <div class="fg">
                        <label for="login_email_dropdown" class="bil-spread lbl-req">
                            <span class="en">Email *</span>
                            <span class="ar">البريد الإلكتروني *</span>
                        </label>
                        <input type="email" id="login_email_dropdown" class="input" x-model="auth.email" required>
                    </div>
                    <div class="fg">
                        <label for="login_password_dropdown" class="bil-spread lbl-req">
                            <span class="en">Password *</span>
                            <span class="ar">كلمة المرور *</span>
                        </label>
                        <input type="password" id="login_password_dropdown" class="input" x-model="auth.password" required>
                    </div>
                    <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.auth">
                        <span x-show="!load.auth">
                            <span class="en">Sign In</span>
                            <span class="ar">دخول</span>
                        </span>
                        <span x-show="load.auth">
                            <span class="en">Signing in...</span>
                            <span class="ar">جاري الدخول...</span>
                        </span>
                    </button>
                    <p class="auth-switch tc">
                        <span class="bil-inline">
                            <span class="en">Don't have an account?</span>
                            <span class="ar">ليس لديك حساب؟</span>
                        </span>
                        <button type="button" @click="auth.view = 'register'" class="link-btn bil-inline">
                            <span class="en">Create one</span>
                            <span class="ar">أنشئ حساب</span>
                        </button>
                    </p>
                </form>
            </div>

            <!-- Register View -->
            <div x-show="auth.view === 'register'" class="auth-view">
                <div class="auth-header">
                    <button @click="auth.view = 'welcome'" class="auth-back-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15 18 9 12 15 6"/>
                        </svg>
                    </button>
                    <h2 class="bil-spread">
                        <span class="en">Create Account</span>
                        <span class="ar">إنشاء حساب</span>
                    </h2>
                </div>
                <form @submit.prevent="registerUser()" class="auth-form">
                    <div x-show="errs.auth_register" class="err-msg" x-text="errs.auth_register ? (currLang === 'ar' ? errs.auth_register.ar : errs.auth_register.en) : ''"></div>
                    <div x-show="errs.auth_form_success" class="success-msg" x-text="errs.auth_form_success ? (currLang === 'ar' ? errs.auth_form_success.ar : errs.auth_form_success.en) : ''"></div>
                    <div class="fg">
                        <label for="register_name_dropdown" class="bil-spread lbl-req">
                            <span class="en">Name *</span>
                            <span class="ar">الاسم *</span>
                        </label>
                        <input type="text" id="register_name_dropdown" class="input" x-model="auth.name" required>
                    </div>
                    <div class="fg">
                        <label for="register_email_dropdown" class="bil-spread lbl-req">
                            <span class="en">Email *</span>
                            <span class="ar">البريد الإلكتروني *</span>
                        </label>
                        <input type="email" id="register_email_dropdown" class="input" x-model="auth.email" required>
                    </div>
                    <div class="fg">
                        <label for="register_password_dropdown" class="bil-spread lbl-req">
                            <span class="en">Password *</span>
                            <span class="ar">كلمة المرور *</span>
                        </label>
                        <input type="password" id="register_password_dropdown" class="input" x-model="auth.password" required>
                    </div>
                    <div class="fg">
                        <label for="register_password_confirm_dropdown" class="bil-spread lbl-req">
                            <span class="en">Confirm Password *</span>
                            <span class="ar">تأكيد كلمة المرور *</span>
                        </label>
                        <input type="password" id="register_password_confirm_dropdown" class="input" x-model="auth.passwordConfirm" required>
                    </div>
                    <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.auth">
                        <span x-show="!load.auth">
                            <span class="en">Create Account</span>
                            <span class="ar">إنشاء حساب</span>
                        </span>
                        <span x-show="load.auth">
                            <span class="en">Creating...</span>
                            <span class="ar">جاري الإنشاء...</span>
                        </span>
                    </button>
                    <p class="auth-switch tc">
                        <span class="bil-inline">
                            <span class="en">Already have an account?</span>
                            <span class="ar">لديك حساب بالفعل؟</span>
                        </span>
                        <button type="button" @click="auth.view = 'login'" class="link-btn bil-inline">
                            <span class="en">Sign In</span>
                            <span class="ar">تسجيل الدخول</span>
                        </button>
                    </p>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Cart Dropdown -->
<div class="cart-dropdown" x-show="isCartOpen" x-transition @click.outside="closeCart()">
    <div class="c">
        <div class="cart-dropdown-content">
            <div class="cart-header">
                <h2 class="bil-spread">
                    <span class="en">Your Cart</span><span class="ar">سلتك</span>
                </h2>
            </div>
            <div class="cart-items-container">
                <div x-show="cartItems.length === 0" class="cart-empty-state">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="empty-cart-icon">
                        <circle cx="9" cy="21" r="1"/>
                        <circle cx="20" cy="21" r="1"/>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                    </svg>
                    <p class="bil-spread cart-empty-text">
                        <span class="en">Your cart is empty</span>
                        <span class="ar">سلتك فارغة</span>
                    </p>
                    <button @click="closeCart(); navigateToOrScroll('udheya')" class="btn bp btn-sm bil-inline">
                        <span class="en">Start Shopping</span>
                        <span class="ar">ابدأ التسوق</span>
                    </button>
                </div>
                <div x-show="cartItems.length > 0" class="cart-items-list">
                    <template x-for="(cartItem) in cartItems.slice(0, 3)" :key="cartItem.uniqueIdInCart">
                        <div class="cart-dropdown-item">
                            <div class="cart-item-info">
                                <div class="cart-item-display">
                                    <span class="cart-item-name-en" x-text="cartItem.nameENSpec + ' (×' + cartItem.quantity + ')'"></span>
                                    <span class="cart-item-price" x-text="fmtPrice(getSubtotalForItem(cartItem))"></span>
                                    <span class="cart-item-name-ar" x-text="cartItem.nameARSpec + ' (×' + cartItem.quantity + ')'"></span>
                                </div>
                            </div>
                            <button @click="removeFromCart(cartItem.uniqueIdInCart)" class="cart-item-remove" title="Remove">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                            </button>
                        </div>
                    </template>
                    <div x-show="cartItems.length > 3" class="cart-more-items">
                        <span class="bil-inline">
                            <span class="en">+ <span x-text="cartItems.length - 3"></span> more items</span>
                            <span class="ar">+ <span x-text="cartItems.length - 3"></span> عناصر أخرى</span>
                        </span>
                    </div>
                </div>
            </div>
            <div class="cart-dropdown-footer" x-show="cartItems.length > 0">
                <div class="cart-total-row">
                    <span class="cart-total-label en">Total</span>
                    <span class="cart-total-amount" x-text="fmtPrice(calculateCartTotal())"></span>
                    <span class="cart-total-label ar">المجموع</span>
                </div>
                <div class="cart-actions">
                    <button @click="closeCart(); navigateToOrScroll('checkout')" class="btn bac btn-block bil-inline">
                        <span class="en">Checkout</span>
                        <span class="ar">الدفع</span>
                    </button>
                    <button @click="closeCart(); navigateToOrScroll('checkout', 'cart-summary')" class="btn bp-alt btn-block bil-inline">
                        <span class="en">View Full Cart</span>
                        <span class="ar">عرض السلة كاملة</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Wishlist Modal -->
<!-- Wishlist Dropdown -->
<div class="wishlist-dropdown" x-show="isWishlistOpen" x-transition @click.outside="closeWishlist()">
    <div class="c">
        <div class="wishlist-dropdown-content">
            <div class="wishlist-header">
                <h2 class="bil-spread">
                    <span class="en">My Wishlist</span><span class="ar">قائمة أمنياتي</span>
                </h2>
            </div>
            <div class="wishlist-items-container">
                <div x-show="wishlistItems.length === 0" class="wishlist-empty-state">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="empty-wishlist-icon">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                    </svg>
                    <p class="bil-spread wishlist-empty-text">
                        <span class="en">Your wishlist is empty</span>
                        <span class="ar">قائمة أمنياتك فارغة</span>
                    </p>
                    <button @click="closeWishlist(); navigateToOrScroll('udheya')" class="btn bp btn-sm bil-inline">
                        <span class="en">Start Shopping</span>
                        <span class="ar">ابدأ التسوق</span>
                    </button>
                </div>
                <div x-show="wishlistItems.length > 0" class="wishlist-items-list">
                    <template x-for="(item) in wishlistItems.slice(0, 4)" :key="item.item_key">
                        <div class="wishlist-dropdown-item">
                            <img :src="item.image" :alt="item.name_en" class="wishlist-item-image">
                            <div class="wishlist-item-info">
                                <div class="wishlist-item-display">
                                    <span class="wishlist-item-name-en" x-text="item.name_en"></span>
                                    <span class="wishlist-item-price" x-text="item.price"></span>
                                    <span class="wishlist-item-name-ar" x-text="item.name_ar"></span>
                                </div>
                            </div>
                            <div class="wishlist-item-actions">
                                <button @click="moveToCart(item)" class="wishlist-item-add" title="Add to Cart">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="9" cy="21" r="1"/>
                                        <circle cx="20" cy="21" r="1"/>
                                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                                    </svg>
                                </button>
                                <button @click="removeFromWishlist(item.item_key)" class="wishlist-item-remove" title="Remove">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18"/>
                                        <line x1="6" y1="6" x2="18" y2="18"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </template>
                    <div x-show="wishlistItems.length > 4" class="wishlist-more-items">
                        <span class="bil-inline">
                            <span class="en">+ <span x-text="wishlistItems.length - 4"></span> more items</span>
                            <span class="ar">+ <span x-text="wishlistItems.length - 4"></span> عناصر أخرى</span>
                        </span>
                    </div>
                </div>
            </div>
            <div class="wishlist-dropdown-footer" x-show="wishlistItems.length > 0">
                <div class="wishlist-count-row">
                    <span class="wishlist-count-label en">Total Items</span>
                    <span class="wishlist-count-number" x-text="wishlistItems.length"></span>
                    <span class="wishlist-count-label ar">إجمالي العناصر</span>
                </div>
                <div class="wishlist-actions">
                    <button @click="clearWishlist()" class="btn bp btn-sm bil-inline">
                        <span class="en">Clear All</span>
                        <span class="ar">مسح الكل</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<main>
    <!-- Business Stats Bar - Hidden by default -->
    <template x-if="false">
        <div class="business-stats-bar" x-data="businessStats()">
            <div class="c">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" x-text="todayOrders">0</div>
                        <div class="stat-label bil-inline"><span class="en">Orders Today</span><span class="ar">طلبات اليوم</span></div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" x-text="fmtPrice(todayRevenue)">0</div>
                        <div class="stat-label bil-inline"><span class="en">Today's Revenue</span><span class="ar">إيرادات اليوم</span></div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" x-text="activeCustomers">0</div>
                        <div class="stat-label bil-inline"><span class="en">Active Customers</span><span class="ar">عملاء نشطون</span></div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" x-text="popularItem">-</div>
                        <div class="stat-label bil-inline"><span class="en">Top Product</span><span class="ar">المنتج الأكثر مبيعاً</span></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <section class="main-page-sec" x-show="currentPage === 'home'" x-transition>
        <div class="c">
            <div class="hero">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <div class="c">
                        <h1 class="hero-title bil-spread">
                            <span class="en">Fresh Lamb & Sacrifice Services</span>
                            <span class="ar">لحوم ضأن طازجة وخدمات الذبائح</span>
                        </h1>
                        <div class="hero-subtitle bil-row">
                            <p class="en">Premium quality meat delivered to your door</p>
                            <p class="ar">لحوم عالية الجودة توصل إلى بابك</p>
                        </div>
                        <div class="hero-cta-group">
                            <button @click="scrollToSection('sacrifices')" class="hero-btn-primary bil-inline">
                                <span class="en">Sacrifices</span>
                                <span class="ar">ذبائح</span>
                            </button>
                            <button @click="scrollToSection('fresh-meat')" class="hero-btn-primary bil-inline">
                                <span class="en">Fresh Meat</span>
                                <span class="ar">لحوم طازجة</span>
                            </button>
                            <button @click="scrollToSection('events-catering')" class="hero-btn-primary bil-inline">
                                <span class="en">Events</span>
                                <span class="ar">مناسبات</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- All Products on Home Page -->
    <section class="all-products-home main-page-sec" x-show="currentPage === 'home'" x-transition>
        <div class="c">
            <!-- Sacrifices Section -->
            <div id="sacrifices" x-show="settings.enable_udheya_section && prodOpts.udheya && prodOpts.udheya.length > 0" class="home-category-section">
                <div class="section-header">
                    <h2 class="bil-spread">
                        <span class="en">Sacrifices</span>
                        <span class="ar">ذبائح</span>
                    </h2>
                </div>
                <div class="prod-grid grid3">
                    <template x-for="productType in prodOpts.udheya" :key="productType.valKey">
                        <div class="card card-compact" :class="{'card-sel': getSacrificeVariant(productType).is_premium}">
                            <div class="card-img">
                                <img :src="getProductImage(getSacrificeVariant(productType), 'udheya')" :alt="productType.nameEn" loading="lazy">
                                <div class="badge udheya-badge">PREMIUM</div>
                                <div class="sale-badge" x-show="getSacrificeVariant(productType).discount_percentage > 0">
                                    <span x-text="'-' + getSacrificeVariant(productType).discount_percentage + '%'"></span>
                                </div>
                                <button @click="toggleWishlist(getSacrificeVariant(productType))" 
                                        class="wishlist-icon" 
                                        :class="{ 'active': isInWishlist(getSacrificeVariant(productType).itemKey) }"
                                        :title="isInWishlist(getSacrificeVariant(productType).itemKey) ? 'Remove from wishlist' : 'Add to wishlist'">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" :fill="isInWishlist(getSacrificeVariant(productType).itemKey) ? 'currentColor' : 'none'"/>
                                    </svg>
                                </button>
                            </div>
                            <div class="card-b">
                                <div class="card-content">
                                    <h4 class="card-h bil-spread">
                                        <span class="en" x-text="productType.nameEn"></span>
                                        <span class="ar" x-text="productType.nameAr"></span>
                                    </h4>
                                    <p class="card-desc bil-spread">
                                        <span class="en" x-text="productType.descEn"></span>
                                        <span class="ar" x-text="productType.descAr"></span>
                                    </p>
                                </div>
                                <div class="card-foot">
                                    <div class="price-line-with-dropdown">
                                        <select class="size-dropdown-inline" 
                                                @change="updateSacrificeVariant(productType, $event.target.value)"
                                                x-init="selectedSacrificeVariants[productType.valKey] = 0">
                                            <template x-for="(variant, index) in productType.wps" :key="variant.itemKey">
                                                <option :value="index" x-text="variant.wtRangeEn || variant.nameENSpec"></option>
                                            </template>
                                        </select>
                                        <div class="price-inline">
                                            <template x-if="getSacrificeVariant(productType).discount_percentage > 0">
                                                <div class="price-with-discount">
                                                    <span class="original-price" x-text="fmtPrice(getSacrificePrice(productType))"></span>
                                                    <strong class="sale-price" x-text="fmtPrice(getSacrificePrice(productType) * (1 - getSacrificeVariant(productType).discount_percentage / 100))"></strong>
                                                </div>
                                            </template>
                                            <template x-if="!getSacrificeVariant(productType).discount_percentage || getSacrificeVariant(productType).discount_percentage === 0">
                                                <strong x-text="fmtPrice(getSacrificePrice(productType))"></strong>
                                            </template>
                                        </div>
                                    </div>
                                    <button type="button" @click="openUdheyaConfiguration(getSacrificeVariant(productType))" 
                                            class="btn bp btn-sm btn-block" 
                                            :disabled="!getSacrificeVariant(productType).isActive || getSacrificeVariant(productType).stock <= 0">
                                        <span class="bil-inline">
                                            <span class="en">Configure</span>
                                            <span class="ar">تخصيص</span>
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>


            <!-- Fresh Meat Section -->
            <div id="fresh-meat" x-show="settings.enable_meat_section && prodOpts.meat_cuts && prodOpts.meat_cuts.length > 0" class="home-category-section">
                <div class="section-header">
                    <h2 class="bil-spread">
                        <span class="en">Fresh Meat Cuts</span>
                        <span class="ar">قطعيات طازجة</span>
                    </h2>
                </div>
                <div class="prod-grid grid3">
                    <template x-for="productType in prodOpts.meat_cuts" :key="productType.valKey">
                        <template x-for="item in productType.wps" :key="productType.valKey + '_' + item.itemKey">
                            <div class="card card-compact" :class="{'card-sel': item.is_premium}">
                                <div class="card-img">
                                    <img :src="getProductImage(item, 'meat')" :alt="item.nameENSpec" loading="lazy">
                                    <div class="badge fresh-badge">FRESH</div>
                                    <div class="sale-badge" x-show="item.discount_percentage > 0">
                                        <span x-text="'-' + item.discount_percentage + '%'"></span>
                                    </div>
                                    <button @click="toggleWishlist(item)" 
                                            class="wishlist-icon" 
                                            :class="{ 'active': isInWishlist(item.itemKey) }"
                                            :title="isInWishlist(item.itemKey) ? 'Remove from wishlist' : 'Add to wishlist'">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" :fill="isInWishlist(item.itemKey) ? 'currentColor' : 'none'"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="card-b">
                                    <div class="card-content">
                                        <h4 class="card-h bil-spread">
                                            <span class="en" x-text="item.nameENSpec"></span>
                                            <span class="ar" x-text="item.nameARSpec"></span>
                                        </h4>
                                        <p class="card-desc bil-spread">
                                            <span class="en" x-text="item.descEn || productType.descEn"></span>
                                            <span class="ar" x-text="item.descAr || productType.descAr"></span>
                                        </p>
                                    </div>
                                    <div class="card-foot">
                                        <div class="price-line-with-dropdown">
                                            <select class="size-dropdown-inline" x-model="selectedMeatWeights[item.itemKey]" x-init="selectedMeatWeights[item.itemKey] = '1'">
                                                <option value="1" selected>1 kg</option>
                                                <option value="2">2 kg</option>
                                                <option value="3">3 kg</option>
                                                <option value="5">5 kg</option>
                                                <option value="10">10 kg</option>
                                            </select>
                                            <div class="price-inline">
                                                <strong x-text="fmtPrice(getMeatPrice(item))"></strong>
                                            </div>
                                        </div>
                                        <button type="button" @click="addItemToCart(getMeatItemWithWeight(item, 'meat'))" 
                                                class="btn bp btn-sm btn-block" 
                                                :disabled="!item.isActive || item.stock <= 0">
                                            <span class="bil-inline">
                                                <span class="en">Add to Cart</span>
                                                <span class="ar">أضف للسلة</span>
                                            </span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>

            <!-- Events & Catering Section -->
            <div id="events-catering" x-show="settings.enable_gatherings_section && prodOpts.gathering_package && prodOpts.gathering_package.length > 0" class="home-category-section">
                <div class="section-header">
                    <h2 class="bil-spread">
                        <span class="en">Events & Catering</span>
                        <span class="ar">مناسبات وولائم</span>
                    </h2>
                </div>
                <div class="prod-grid grid3">
                    <template x-for="productType in prodOpts.gathering_package" :key="productType.valKey">
                        <template x-for="item in productType.wps" :key="productType.valKey + '_' + item.itemKey">
                            <div class="card card-compact" :class="{'card-sel': item.is_premium}">
                                <div class="card-img">
                                    <img :src="getProductImage(item, 'gatherings')" :alt="item.nameENSpec" loading="lazy">
                                    <div class="badge event-badge">EVENT</div>
                                    <div class="sale-badge" x-show="item.discount_percentage > 0">
                                        <span x-text="'-' + item.discount_percentage + '%'"></span>
                                    </div>
                                    <button @click="toggleWishlist(item)" 
                                            class="wishlist-icon" 
                                            :class="{ 'active': isInWishlist(item.itemKey) }"
                                            :title="isInWishlist(item.itemKey) ? 'Remove from wishlist' : 'Add to wishlist'">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" :fill="isInWishlist(item.itemKey) ? 'currentColor' : 'none'"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="card-b">
                                    <div class="card-content">
                                        <h4 class="card-h bil-spread">
                                            <span class="en" x-text="item.nameENSpec"></span>
                                            <span class="ar" x-text="item.nameARSpec"></span>
                                        </h4>
                                        <p class="card-desc bil-spread">
                                            <span class="en" x-text="item.descEn || productType.descEn"></span>
                                            <span class="ar" x-text="item.descAr || productType.descAr"></span>
                                        </p>
                                    </div>
                                    <div class="card-foot">
                                        <div class="price-line">
                                            <template x-if="item.discount_percentage > 0">
                                                <div class="price-with-discount">
                                                    <span class="original-price" x-text="fmtPrice(item.priceEGP)"></span>
                                                    <strong class="sale-price" x-text="fmtPrice(item.priceEGP * (1 - item.discount_percentage / 100))"></strong>
                                                </div>
                                            </template>
                                            <template x-if="!item.discount_percentage || item.discount_percentage === 0">
                                                <strong x-text="fmtPrice(item.priceEGP)"></strong>
                                            </template>
                                            <span class="weight-info" x-show="item.wtRangeEn" x-text="item.wtRangeEn"></span>
                                        </div>
                                        <button type="button" @click="addItemToCart(item)" 
                                                class="btn bp btn-sm btn-block" 
                                                :disabled="!item.isActive || item.stock <= 0">
                                            <span class="bil-inline">
                                                <span class="en">Add to Cart</span>
                                                <span class="ar">أضف للسلة</span>
                                            </span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </section>

    <!-- Old standalone sections removed - all products now displayed on home page -->
    <!--
    Removed sections:
    - Udheya Section (now part of home page #sacrifices)
    - Other dynamic sections from productSections (now part of home page)
    - Collective Sheep Section
    - Monthly Subscription Box Section
    -->

    <section class="sec main-page-sec" x-show="currentPage === 'checkout'" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" x-ref="checkoutTitle" tabindex="-1">
                    <span class="en">Secure Checkout</span><span class="ar">إتمام الطلب الآمن</span>
                </h1>
            </div>
            <div x-show="cartItems.length === 0 && !orderConf.show" class="empty-state tc">
                <p class="bil-row"><span class="en">Your cart is empty. Please add items to proceed.</span><span class="ar">سلتك فارغة. يرجى إضافة منتجات للمتابعة.</span></p>
                <button @click="navigateToOrScroll('udheya')" class="btn bp">
                    <span class="bil-inline"><span class="en">Continue Shopping</span><span class="ar">متابعة التسوق</span></span>
                </button>
            </div>
            
            <div x-show="cartItems.length > 0 && !orderConf.show" class="checkout-layout">
                <div class="checkout-form-col">
                    <form @submit.prevent="processOrder()" novalidate>
                        <div class="card form-panel">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Contact Information</span><span class="ar">معلومات الاتصال</span></h2>
                                
                                <!-- Guest Checkout Notice -->
                                <div class="guest-checkout-notice" x-show="!currentUser">
                                    <div class="bil-row">
                                        <p class="en">👤 Checking out as guest - No account required!</p>
                                        <p class="ar">👤 الدفع كضيف - لا حاجة لحساب!</p>
                                    </div>
                                    <p class="notice-small bil-row">
                                        <span class="en">Want to track orders easily? <a href="#auth" class="link-style">Create an account</a></span>
                                        <span class="ar">تريد تتبع الطلبات بسهولة؟ <a href="#auth" class="link-style">أنشئ حساب</a></span>
                                    </p>
                                </div>
                                
                                <!-- Logged In Notice -->
                                <div class="logged-in-notice" x-show="currentUser">
                                    <p class="bil-inline">
                                        <span class="en">✅ Logged in as <strong x-text="currentUser?.name || currentUser?.email"></strong></span>
                                        <span class="ar">✅ مسجل الدخول كـ <strong x-text="currentUser?.name || currentUser?.email"></strong></span>
                                    </p>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Full Name *</span><span class="ar">الاسم الكامل *</span></label>
                                    <input type="text" class="input" x-model="checkoutForm.customer_name" @input="clrErr('customer_name')" required>
                                    <div class="err-msg" x-show="errs.customer_name" x-text="errs.customer_name ? (currLang === 'ar' ? errs.customer_name.ar : errs.customer_name.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Phone Number *</span><span class="ar">رقم الهاتف *</span></label>
                                    <input type="tel" class="input" x-model="checkoutForm.customer_phone" @input="clrErr('customer_phone')" required>
                                    <div class="err-msg" x-show="errs.customer_phone" x-text="errs.customer_phone ? (currLang === 'ar' ? errs.customer_phone.ar : errs.customer_phone.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Email Address *</span><span class="ar">البريد الإلكتروني *</span></label>
                                    <input type="email" class="input" x-model="checkoutForm.customer_email" @input="clrErr('customer_email')" required>
                                    <div class="err-msg" x-show="errs.customer_email" x-text="errs.customer_email ? (currLang === 'ar' ? errs.customer_email.ar : errs.customer_email.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread"><span class="en">Country</span><span class="ar">البلد</span></label>
                                    <select class="input" x-model="checkoutForm.customer_country">
                                        <option value="Afghanistan">Afghanistan</option>
                                        <option value="Albania">Albania</option>
                                        <option value="Algeria">Algeria / الجزائر</option>
                                        <option value="Andorra">Andorra</option>
                                        <option value="Angola">Angola</option>
                                        <option value="Antigua and Barbuda">Antigua and Barbuda</option>
                                        <option value="Argentina">Argentina</option>
                                        <option value="Armenia">Armenia</option>
                                        <option value="Australia">Australia</option>
                                        <option value="Austria">Austria</option>
                                        <option value="Azerbaijan">Azerbaijan</option>
                                        <option value="Bahamas">Bahamas</option>
                                        <option value="Bahrain">Bahrain / البحرين</option>
                                        <option value="Bangladesh">Bangladesh</option>
                                        <option value="Barbados">Barbados</option>
                                        <option value="Belarus">Belarus</option>
                                        <option value="Belgium">Belgium</option>
                                        <option value="Belize">Belize</option>
                                        <option value="Benin">Benin</option>
                                        <option value="Bhutan">Bhutan</option>
                                        <option value="Bolivia">Bolivia</option>
                                        <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
                                        <option value="Botswana">Botswana</option>
                                        <option value="Brazil">Brazil</option>
                                        <option value="Brunei">Brunei</option>
                                        <option value="Bulgaria">Bulgaria</option>
                                        <option value="Burkina Faso">Burkina Faso</option>
                                        <option value="Burundi">Burundi</option>
                                        <option value="Cambodia">Cambodia</option>
                                        <option value="Cameroon">Cameroon</option>
                                        <option value="Canada">Canada</option>
                                        <option value="Cape Verde">Cape Verde</option>
                                        <option value="Central African Republic">Central African Republic</option>
                                        <option value="Chad">Chad</option>
                                        <option value="Chile">Chile</option>
                                        <option value="China">China</option>
                                        <option value="Colombia">Colombia</option>
                                        <option value="Comoros">Comoros</option>
                                        <option value="Congo">Congo</option>
                                        <option value="Costa Rica">Costa Rica</option>
                                        <option value="Croatia">Croatia</option>
                                        <option value="Cuba">Cuba</option>
                                        <option value="Cyprus">Cyprus</option>
                                        <option value="Czech Republic">Czech Republic</option>
                                        <option value="Denmark">Denmark</option>
                                        <option value="Djibouti">Djibouti</option>
                                        <option value="Dominica">Dominica</option>
                                        <option value="Dominican Republic">Dominican Republic</option>
                                        <option value="East Timor">East Timor</option>
                                        <option value="Ecuador">Ecuador</option>
                                        <option value="Egypt">Egypt / مصر</option>
                                        <option value="El Salvador">El Salvador</option>
                                        <option value="Equatorial Guinea">Equatorial Guinea</option>
                                        <option value="Eritrea">Eritrea</option>
                                        <option value="Estonia">Estonia</option>
                                        <option value="Ethiopia">Ethiopia</option>
                                        <option value="Fiji">Fiji</option>
                                        <option value="Finland">Finland</option>
                                        <option value="France">France</option>
                                        <option value="Gabon">Gabon</option>
                                        <option value="Gambia">Gambia</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Germany">Germany</option>
                                        <option value="Ghana">Ghana</option>
                                        <option value="Greece">Greece</option>
                                        <option value="Grenada">Grenada</option>
                                        <option value="Guatemala">Guatemala</option>
                                        <option value="Guinea">Guinea</option>
                                        <option value="Guinea-Bissau">Guinea-Bissau</option>
                                        <option value="Guyana">Guyana</option>
                                        <option value="Haiti">Haiti</option>
                                        <option value="Honduras">Honduras</option>
                                        <option value="Hungary">Hungary</option>
                                        <option value="Iceland">Iceland</option>
                                        <option value="India">India</option>
                                        <option value="Indonesia">Indonesia</option>
                                        <option value="Iran">Iran</option>
                                        <option value="Iraq">Iraq / العراق</option>
                                        <option value="Ireland">Ireland</option>
                                        <option value="Italy">Italy</option>
                                        <option value="Ivory Coast">Ivory Coast</option>
                                        <option value="Jamaica">Jamaica</option>
                                        <option value="Japan">Japan</option>
                                        <option value="Jordan">Jordan / الأردن</option>
                                        <option value="Kazakhstan">Kazakhstan</option>
                                        <option value="Kenya">Kenya</option>
                                        <option value="Kiribati">Kiribati</option>
                                        <option value="Kuwait">Kuwait / الكويت</option>
                                        <option value="Kyrgyzstan">Kyrgyzstan</option>
                                        <option value="Laos">Laos</option>
                                        <option value="Latvia">Latvia</option>
                                        <option value="Lebanon">Lebanon / لبنان</option>
                                        <option value="Lesotho">Lesotho</option>
                                        <option value="Liberia">Liberia</option>
                                        <option value="Libya">Libya / ليبيا</option>
                                        <option value="Liechtenstein">Liechtenstein</option>
                                        <option value="Lithuania">Lithuania</option>
                                        <option value="Luxembourg">Luxembourg</option>
                                        <option value="Macedonia">Macedonia</option>
                                        <option value="Madagascar">Madagascar</option>
                                        <option value="Malawi">Malawi</option>
                                        <option value="Malaysia">Malaysia</option>
                                        <option value="Maldives">Maldives</option>
                                        <option value="Mali">Mali</option>
                                        <option value="Malta">Malta</option>
                                        <option value="Marshall Islands">Marshall Islands</option>
                                        <option value="Mauritania">Mauritania</option>
                                        <option value="Mauritius">Mauritius</option>
                                        <option value="Mexico">Mexico</option>
                                        <option value="Micronesia">Micronesia</option>
                                        <option value="Moldova">Moldova</option>
                                        <option value="Monaco">Monaco</option>
                                        <option value="Mongolia">Mongolia</option>
                                        <option value="Montenegro">Montenegro</option>
                                        <option value="Morocco">Morocco / المغرب</option>
                                        <option value="Mozambique">Mozambique</option>
                                        <option value="Myanmar">Myanmar</option>
                                        <option value="Namibia">Namibia</option>
                                        <option value="Nauru">Nauru</option>
                                        <option value="Nepal">Nepal</option>
                                        <option value="Netherlands">Netherlands</option>
                                        <option value="New Zealand">New Zealand</option>
                                        <option value="Nicaragua">Nicaragua</option>
                                        <option value="Niger">Niger</option>
                                        <option value="Nigeria">Nigeria</option>
                                        <option value="North Korea">North Korea</option>
                                        <option value="Norway">Norway</option>
                                        <option value="Oman">Oman / عُمان</option>
                                        <option value="Pakistan">Pakistan</option>
                                        <option value="Palau">Palau</option>
                                        <option value="Palestine">Palestine / فلسطين</option>
                                        <option value="Panama">Panama</option>
                                        <option value="Papua New Guinea">Papua New Guinea</option>
                                        <option value="Paraguay">Paraguay</option>
                                        <option value="Peru">Peru</option>
                                        <option value="Philippines">Philippines</option>
                                        <option value="Poland">Poland</option>
                                        <option value="Portugal">Portugal</option>
                                        <option value="Qatar">Qatar / قطر</option>
                                        <option value="Romania">Romania</option>
                                        <option value="Russia">Russia</option>
                                        <option value="Rwanda">Rwanda</option>
                                        <option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option>
                                        <option value="Saint Lucia">Saint Lucia</option>
                                        <option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option>
                                        <option value="Samoa">Samoa</option>
                                        <option value="San Marino">San Marino</option>
                                        <option value="Sao Tome and Principe">Sao Tome and Principe</option>
                                        <option value="Saudi Arabia">Saudi Arabia / السعودية</option>
                                        <option value="Senegal">Senegal</option>
                                        <option value="Serbia">Serbia</option>
                                        <option value="Seychelles">Seychelles</option>
                                        <option value="Sierra Leone">Sierra Leone</option>
                                        <option value="Singapore">Singapore</option>
                                        <option value="Slovakia">Slovakia</option>
                                        <option value="Slovenia">Slovenia</option>
                                        <option value="Solomon Islands">Solomon Islands</option>
                                        <option value="Somalia">Somalia</option>
                                        <option value="South Africa">South Africa</option>
                                        <option value="South Korea">South Korea</option>
                                        <option value="South Sudan">South Sudan</option>
                                        <option value="Spain">Spain</option>
                                        <option value="Sri Lanka">Sri Lanka</option>
                                        <option value="Sudan">Sudan / السودان</option>
                                        <option value="Suriname">Suriname</option>
                                        <option value="Swaziland">Swaziland</option>
                                        <option value="Sweden">Sweden</option>
                                        <option value="Switzerland">Switzerland</option>
                                        <option value="Syria">Syria / سوريا</option>
                                        <option value="Taiwan">Taiwan</option>
                                        <option value="Tajikistan">Tajikistan</option>
                                        <option value="Tanzania">Tanzania</option>
                                        <option value="Thailand">Thailand</option>
                                        <option value="Togo">Togo</option>
                                        <option value="Tonga">Tonga</option>
                                        <option value="Trinidad and Tobago">Trinidad and Tobago</option>
                                        <option value="Tunisia">Tunisia / تونس</option>
                                        <option value="Turkey">Turkey</option>
                                        <option value="Turkmenistan">Turkmenistan</option>
                                        <option value="Tuvalu">Tuvalu</option>
                                        <option value="Uganda">Uganda</option>
                                        <option value="Ukraine">Ukraine</option>
                                        <option value="UAE">UAE / الإمارات</option>
                                        <option value="United Kingdom">United Kingdom</option>
                                        <option value="United States">United States</option>
                                        <option value="Uruguay">Uruguay</option>
                                        <option value="Uzbekistan">Uzbekistan</option>
                                        <option value="Vanuatu">Vanuatu</option>
                                        <option value="Vatican City">Vatican City</option>
                                        <option value="Venezuela">Venezuela</option>
                                        <option value="Vietnam">Vietnam</option>
                                        <option value="Yemen">Yemen / اليمن</option>
                                        <option value="Zambia">Zambia</option>
                                        <option value="Zimbabwe">Zimbabwe</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card form-panel" x-show="deliveryNeededForCart()">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Delivery Information</span><span class="ar">معلومات التوصيل</span></h2>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Delivery Area *</span><span class="ar">منطقة التوصيل *</span></label>
                                    <select class="input" x-model="checkoutForm.delivery_city_id" @change="updateDeliveryFeeForCheckout(); clrErr('delivery_city_id')">
                                        <option value="">-- Select Area --</option>
                                        <template x-for="city in allCities" :key="city.id">
                                            <option :value="city.id" x-text="city.nameEn + ' / ' + city.nameAr"></option>
                                        </template>
                                    </select>
                                    <div class="err-msg" x-show="errs.delivery_city_id" x-text="errs.delivery_city_id ? (currLang === 'ar' ? errs.delivery_city_id.ar : errs.delivery_city_id.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Full Address *</span><span class="ar">العنوان الكامل *</span></label>
                                    <textarea class="input" x-model="checkoutForm.delivery_address" @input="clrErr('delivery_address')" placeholder="Building, street, landmarks..."></textarea>
                                    <div class="err-msg" x-show="errs.delivery_address" x-text="errs.delivery_address ? (currLang === 'ar' ? errs.delivery_address.ar : errs.delivery_address.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread"><span class="en">Delivery Instructions</span><span class="ar">تعليمات التوصيل</span></label>
                                    <textarea class="input" x-model="checkoutForm.delivery_instructions" placeholder="Special instructions for delivery..."></textarea>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Preferred Time *</span><span class="ar">الوقت المفضل *</span></label>
                                    <select class="input" x-model="checkoutForm.delivery_time_slot" @change="clrErr('delivery_time_slot')">
                                        <option value="">-- Select Time --</option>
                                        <template x-for="slot in deliveryTimeSlots" :key="slot.value">
                                            <option :value="slot.value" x-text="slot.label"></option>
                                        </template>
                                    </select>
                                    <div class="err-msg" x-show="errs.delivery_time_slot" x-text="errs.delivery_time_slot ? (currLang === 'ar' ? errs.delivery_time_slot.ar : errs.delivery_time_slot.en) : ''"></div>
                                </div>
                            </div>
                        </div>

                        <div class="card form-panel">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Promo Code</span><span class="ar">كود الخصم</span></h2>
                                <div class="promo-code-section">
                                    <div class="promo-input-group">
                                        <input type="text" class="input promo-input" x-model="checkoutForm.promo_code" @input="clrErr('promo_code')" placeholder="Enter promo code">
                                        <button type="button" class="btn bs btn-sm" @click="applyPromoCode()" :disabled="!checkoutForm.promo_code || checkoutForm.promo_applied">
                                            <span x-show="!checkoutForm.promo_applied" class="bil-inline"><span class="en">Apply</span><span class="ar">تطبيق</span></span>
                                            <span x-show="checkoutForm.promo_applied" class="bil-inline"><span class="en">Applied ✓</span><span class="ar">تم التطبيق ✓</span></span>
                                        </button>
                                    </div>
                                    <div class="promo-success" x-show="checkoutForm.promo_applied">
                                        <span class="bil-inline">
                                            <span class="en">Promo code applied! You saved</span>
                                            <span class="ar">تم تطبيق كود الخصم! وفرت</span>
                                        </span>
                                        <strong x-text="fmtPrice(checkoutForm.promo_discount_amount)"></strong>
                                    </div>
                                    <div class="err-msg" x-show="errs.promo_code" x-text="errs.promo_code"></div>
                                </div>
                            </div>
                        </div>

                        <div class="card form-panel">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Payment Method</span><span class="ar">طريقة الدفع</span></h2>
                                <div class="pay-meths-all">
                                    <template x-for="method in availPayMeths" :key="method.id">
                                        <div class="pm" :class="{'sel': checkoutForm.payment_method === method.id}">
                                            <input type="radio" :id="'pay_' + method.id" :value="method.id" x-model="checkoutForm.payment_method" @change="calculateFinalTotal(); clrErr('payment_method')">
                                            <label :for="'pay_' + method.id" :title="method.title">
                                                <img :src="'/images/' + method.imgSrc" :alt="method.title" class="pay-icon">
                                            </label>
                                        </div>
                                    </template>
                                </div>
                                <div class="err-msg" x-show="errs.payment_method" x-text="errs.payment_method ? (currLang === 'ar' ? errs.payment_method.ar : errs.payment_method.en) : ''"></div>
                            </div>
                        </div>
                        
                        <div class="form-act tc page-act final-submit">
                             <label class="lbl-chk bil-inline">
                                <input type="checkbox" x-model="checkoutForm.terms_agreed" @change="clrErr('terms_agreed')">
                                <span class="en">I agree to the <button type="button" class="link-style" @click.prevent="openRefundModal()">Terms & Refund Policy</button> *</span>
                                <span class="ar">أوافق على <button type="button" class="link-style" @click.prevent="openRefundModal()">الشروط وسياسة الاسترداد</button> *</span>
                            </label>
                            <div class="err-msg" x-show="errs.terms_agreed" x-text="errs.terms_agreed ? (currLang === 'ar' ? errs.terms_agreed.ar : errs.terms_agreed.en) : ''"></div>
                            <button type="submit" class="btn bac btn-lg btn-block bil-inline" :disabled="load.checkout">
                                <span x-show="!load.checkout"><span class="en">Complete Order</span><span class="ar">إتمام الطلب</span></span>
                                <span x-show="load.checkout"><span class="en">Processing...</span><span class="ar">جاري المعالجة...</span></span>
                            </button>
                        </div>
                    </form>
                </div>
                <div class="checkout-summary-col" id="cart-summary">
                    <div class="card form-panel sticky-summary">
                        <div class="card-b">
                            <h2 class="form-subh bil-spread"><span class="en">Order Summary</span><span class="ar">ملخص الطلب</span></h2>
                            <div class="rev-sum checkout-rev-sum">
                                <template x-for="item in cartItems" :key="item.uniqueIdInCart">
                                    <div class="sum-item">
                                        <span class="sum-item-name en" x-text="item.nameENSpec + ' (×' + item.quantity + ')'"></span>
                                        <span class="sum-item-price" x-text="fmtPrice(getSubtotalForItem(item))"></span>
                                        <span class="sum-item-name ar" x-text="item.nameARSpec + ' (×' + item.quantity + ')'"></span>
                                    </div>
                                </template>
                                <template x-if="checkoutForm.delivery_fee_egp > 0">
                                    <div class="sum-item">
                                        <div class="sum-item-content bil-spread">
                                            <span class="en">Delivery Fee</span><span class="ar">رسوم التوصيل</span>
                                        </div>
                                        <div class="sum-item-price" x-text="fmtPrice(checkoutForm.delivery_fee_egp)"></div>
                                    </div>
                                </template>
                                <template x-if="checkoutForm.online_payment_fee_applied_egp > 0">
                                    <div class="sum-item">
                                        <div class="sum-item-content bil-spread">
                                            <span class="en">Online Payment Fee</span><span class="ar">رسوم الدفع الإلكتروني</span>
                                        </div>
                                        <div class="sum-item-price" x-text="fmtPrice(checkoutForm.online_payment_fee_applied_egp)"></div>
                                    </div>
                                </template>
                                <template x-if="checkoutForm.promo_applied && checkoutForm.promo_discount_amount > 0">
                                    <div class="sum-item">
                                        <div class="sum-item-content bil-spread">
                                            <span class="en">Promo Discount</span><span class="ar">خصم الكود</span>
                                        </div>
                                        <div class="sum-item-price promo-discount">-<span x-text="fmtPrice(checkoutForm.promo_discount_amount)"></span></div>
                                    </div>
                                </template>
                                <hr class="sum-hr">
                                <div class="sum-total">
                                    <span class="sum-total-label en"><strong>Total:</strong></span>
                                    <div class="sum-total-amount"><strong x-text="fmtPrice(checkoutForm.final_total_egp)"></strong></div>
                                    <span class="sum-total-label ar"><strong>المجموع:</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <section class="sec conf-sect-wide" x-show="orderConf.show" x-transition>
                <div class="c tc">
                    <h2 class="bil-spread conf-h" x-ref="orderConfTitle" tabindex="-1">
                        <span class="en">Order Confirmed! JazakAllah Khairan.</span>
                        <span class="ar">تم تأكيد الطلب! جزاكم الله خيرًا.</span>
                    </h2>
                    <div class="conf-msg">
                        <div class="bil-row conf-intro">
                            <p class="en">Thank you for choosing Sheep Land Egypt. Your order is being processed with care.</p>
                            <p class="ar">نشكركم على اختيار أرض الأغنام مصر. طلبكم قيد المعالجة بعناية.</p>
                        </div>
                        <div class="card form-panel order-id-box">
                            <div class="card-b order-id-box-body">
                                <div class="bil-spread">
                                    <p class="en order-id-box-imp"><strong>Order ID:</strong></p>
                                    <p class="ar order-id-box-imp"><strong>رقم الطلب:</strong></p>
                                </div>
                                <p class="order-id-disp" x-text="orderConf.orderID"></p>
                            </div>
                        </div>
                        <div class="pay-instr">
                            <h4 class="form-subh bil-spread">
                                <span class="en">Payment Instructions</span>
                                <span class="ar">تعليمات الدفع</span>
                            </h4>
                            <div x-html="orderConf.paymentInstructions"></div>
                        </div>
                    </div>
                    <div class="form-act tc page-act">
                        <button @click="navigateToOrScroll('home')" class="btn bp btn-lg bil-inline">
                            <span class="en">Back to Homepage</span><span class="ar">العودة للرئيسية</span>
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </section>
    
    <section class="sec main-page-sec" x-show="currentPage === 'auth'" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" tabindex="-1">
                    <span class="en" x-text="auth.view === 'login' ? 'Welcome Back' : 'Join Sheep Land'"></span>
                    <span class="ar" x-text="auth.view === 'login' ? 'أهلاً بعودتك' : 'انضم لأرض الأغنام'"></span>
                </h1>
            </div>
            <div class="auth-form-container">
                <div class="card form-panel">
                    <div class="card-b">
                        <form @submit.prevent="auth.view === 'login' ? loginUser() : registerUser()" novalidate x-show="auth.view === 'login'">
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Email *</span><span class="ar">البريد الإلكتروني *</span></label>
                                <input type="email" class="input" x-model="auth.email">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Password *</span><span class="ar">كلمة المرور *</span></label>
                                <input type="password" class="input" x-model="auth.password">
                            </div>
                            <div class="card-act">
                                <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.auth">
                                    <span x-show="!load.auth"><span class="en">Login</span><span class="ar">دخول</span></span>
                                    <span x-show="load.auth"><span class="en">Logging in...</span><span class="ar">جاري الدخول...</span></span>
                                </button>
                            </div>
                            <p class="auth-toggle-link bil-row">
                                <span class="en">New to Sheep Land?</span><span class="ar">جديد في أرض الأغنام؟</span>
                                <button type="button" @click="auth.view = 'register'; clearAllErrors();" class="link-style bil-inline"><span class="en">Create account</span><span class="ar">إنشاء حساب</span></button>
                            </p>
                        </form>

                        <form @submit.prevent="registerUser()" novalidate x-show="auth.view === 'register'">
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Full Name *</span><span class="ar">الاسم الكامل *</span></label>
                                <input type="text" class="input" x-model="auth.name">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Email *</span><span class="ar">البريد الإلكتروني *</span></label>
                                <input type="email" class="input" x-model="auth.email">
                            </div>
                            <div class="fg">
                                <label class="bil-spread"><span class="en">Phone</span><span class="ar">الهاتف</span></label>
                                <input type="tel" class="input" x-model="auth.phone">
                            </div>
                            <div class="fg">
                                <label class="bil-spread"><span class="en">Country</span><span class="ar">البلد</span></label>
                                <input type="text" class="input" x-model="auth.country" placeholder="Egypt">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Password *</span><span class="ar">كلمة المرور *</span></label>
                                <input type="password" class="input" x-model="auth.password">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Confirm Password *</span><span class="ar">تأكيد كلمة المرور *</span></label>
                                <input type="password" class="input" x-model="auth.passwordConfirm">
                            </div>
                            <div class="card-act">
                                <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.auth">
                                    <span x-show="!load.auth"><span class="en">Create Account</span><span class="ar">إنشاء حساب</span></span>
                                    <span x-show="load.auth"><span class="en">Creating...</span><span class="ar">جاري الإنشاء...</span></span>
                                </button>
                            </div>
                            <p class="auth-toggle-link bil-row">
                                <span class="en">Already have an account?</span><span class="ar">لديك حساب بالفعل؟</span>
                                <button type="button" @click="auth.view = 'login'; clearAllErrors();" class="link-style bil-inline"><span class="en">Sign in</span><span class="ar">تسجيل دخول</span></button>
                            </p>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="sec main-page-sec" x-show="currentPage === 'account'" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" tabindex="-1">
                    <span class="en">My Account</span><span class="ar">حسابي</span>
                </h1>
            </div>
            <div x-show="!currentUser" class="empty-state tc">
                <p class="bil-row">
                    <span class="en">Please <a href="#auth" @click.prevent="navigateToOrScroll('auth')" class="link-style">login or register</a> to access your account.</span>
                    <span class="ar">يرجى <a href="#auth" @click.prevent="navigateToOrScroll('auth')" class="link-style">تسجيل الدخول أو إنشاء حساب</a> للوصول لحسابك.</span>
                </p>
            </div>
            <div x-show="currentUser">
                <div class="card form-panel">
                    <div class="card-b">
                        <h2 class="form-subh bil-spread"><span class="en">Account Information</span><span class="ar">معلومات الحساب</span></h2>
                        <div class="sum-item bil-row"><span class="en"><strong>Email:</strong> <span x-text="currentUser?.email || 'N/A'"></span></span><span class="ar"><strong>البريد الإلكتروني:</strong> <span x-text="currentUser?.email || 'غير متوفر'"></span></span></div>
                        <div class="sum-item bil-row"><span class="en"><strong>Name:</strong> <span x-text="currentUser?.name || 'Not set'"></span></span><span class="ar"><strong>الاسم:</strong> <span x-text="currentUser?.name || 'غير محدد'"></span></span></div>
                        <div class="sum-item bil-row"><span class="en"><strong>Phone:</strong> <span x-text="currentUser?.phone || 'Not set'"></span></span><span class="ar"><strong>الهاتف:</strong> <span x-text="currentUser?.phone || 'غير محدد'"></span></span></div>
                        <div class="sum-item bil-row"><span class="en"><strong>Country:</strong> <span x-text="currentUser?.country || 'Not set'"></span></span><span class="ar"><strong>البلد:</strong> <span x-text="currentUser?.country || 'غير محدد'"></span></span></div>
                        <button @click="logoutUser()" class="btn danger"><span class="bil-inline"><span class="en">Logout</span><span class="ar">تسجيل الخروج</span></span></button>
                    </div>
                </div>
                <div class="card form-panel">
                    <div class="card-b">
                        <h2 class="form-subh bil-spread"><span class="en">Order History</span><span class="ar">سجل الطلبات</span></h2>
                        <div x-show="load.orders" class="load-text tc">Loading orders...</div>
                        <div x-show="!load.orders && userOrders.length === 0" class="empty-state tc">
                            <p class="bil-row"><span class="en">No orders yet.</span><span class="ar">لا توجد طلبات بعد.</span></p>
                            <button @click="navigateToOrScroll('udheya')" class="btn bp">
                                <span class="bil-inline"><span class="en">Start Shopping</span><span class="ar">ابدأ التسوق</span></span>
                            </button>
                        </div>
                        <div x-show="!load.orders && userOrders.length > 0">
                            <template x-for="order in userOrders" :key="order.id">
                                <div class="card order-history-item">
                                    <div class="card-b">
                                        <div class="sum-item bil-row">
                                            <div><strong class="en">Order ID:</strong><strong class="ar">رقم الطلب:</strong></div>
                                            <div><span x-text="order.order_id_text"></span></div>
                                        </div>
                                        <div class="sum-item bil-row">
                                            <div><strong class="en">Status:</strong><strong class="ar">الحالة:</strong></div>
                                            <div><span class="stat-hl" x-text="order.order_status"></span></div>
                                        </div>
                                        <div class="sum-item">
                                             <div><strong>Total:</strong></div>
                                             <div><span x-text="fmtPrice(order.total_amount_due_egp)"></span></div>
                                        </div>
                                        <div class="sum-item bil-row">
                                             <div><strong class="en">Date:</strong><strong class="ar">التاريخ:</strong></div>
                                             <div><span x-text="new Date(order.created).toLocaleDateString()"></span></div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

</main>

<!-- Social Proof Notifications - Removed -->

<!-- Exit Intent Popup -->
<div class="exit-popup-overlay" x-show="showExitOffer" x-transition @click="showExitOffer = false">
    <div class="exit-popup" @click.stop>
        <button @click="showExitOffer = false" class="modal-close-btn">×</button>
        <h2 class="bil-spread"><span class="en">Wait! Don't leave empty-handed 🛍️</span><span class="ar">انتظر! لا تغادر خالي الوفاض 🛍️</span></h2>
        <p class="bil-row">
            <span class="en">Get 5% OFF your order right now!</span>
            <span class="ar">احصل على خصم 5% على طلبك الآن!</span>
        </p>
        <p class="bil-row">
            <span class="en">Use code SAVE5 at checkout</span>
            <span class="ar">استخدم كود SAVE5 عند الدفع</span>
        </p>
        <button @click="showExitOffer = false; isCartOpen = true" class="btn bp btn-lg btn-block">
            <span class="bil-inline"><span class="en">Continue Shopping</span><span class="ar">متابعة التسوق</span></span>
        </button>
    </div>
</div>

<!-- Sticky Cart Button - Removed (undefined variable) -->

<!-- Quick View Modal - Removed -->

<!-- Meat Calculator Modal - Removed -->

<!-- Feasibility Calculator Modal -->
<div x-show="showFeasibilityModal" class="modal-overlay" @click="closeFeasibilityModal()"></div>
<div x-show="showFeasibilityModal" class="modal modal-lg" role="dialog" aria-modal="true" aria-labelledby="feasibility-modal-title" @keydown.escape.window="closeFeasibilityModal()" x-cloak>
        <div class="modal-header">
            <h2 id="feasibility-modal-title" class="bil-spread modal-title">
                <span class="en">Feasibility Calculator</span>
                <span class="ar">حاسبة الجدوى</span>
            </h2>
            <button @click="closeFeasibilityModal()" class="modal-close-btn">×</button>
        </div>
        <div class="modal-content">
            <div class="calc-section">
                <h3 class="section-title bil-spread">
                    <span class="en">Project Parameters</span>
                    <span class="ar">معاملات المشروع</span>
                </h3>
                
                <div class="calc-grid">
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Initial Investment</span>
                            <span class="ar">الاستثمار الأولي</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Sheep Breed</span>
                                <span class="ar">سلالة الأغنام</span>
                            </label>
                            <select x-model="feasibility.selectedBreed" @change="updateBreedPrices()" class="calc-input">
                                <template x-for="(breed, key) in marketData.breeds" :key="key">
                                    <option :value="key" x-text="breed.description[currLang]"></option>
                                </template>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Number of Sheep</span>
                                <span class="ar">عدد الأغنام</span>
                            </label>
                            <input type="number" x-model.number="feasibility.numSheep" min="1" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Market Season</span>
                                <span class="ar">موسم السوق</span>
                            </label>
                            <select x-model="feasibility.selectedSeason" class="calc-input">
                                <template x-for="(season, key) in marketData.seasonalFactors" :key="key">
                                    <option :value="key" x-text="season.description[currLang]"></option>
                                </template>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Facility Costs (EGP)</span>
                                <span class="ar">تكاليف المنشآت (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.facilityCosts" min="0" class="calc-input">
                        </div>
                    </div>
                    
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Operating Costs</span>
                            <span class="ar">التكاليف التشغيلية</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Feed Cost per Month (EGP)</span>
                                <span class="ar">تكلفة العلف شهريا (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.feedCostPerMonth" min="0" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Labor Cost per Month (EGP)</span>
                                <span class="ar">تكلفة العمالة شهريا (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.laborCostPerMonth" min="0" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Veterinary Cost per Month (EGP)</span>
                                <span class="ar">تكلفة الرعاية البيطرية شهريا (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.vetCostPerMonth" min="0" class="calc-input">
                        </div>
                    </div>
                    
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Revenue Projections</span>
                            <span class="ar">توقعات الإيرادات</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Project Duration (months)</span>
                                <span class="ar">مدة المشروع (شهور)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.projectDuration" min="1" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <input type="checkbox" x-model="feasibility.includeBreeding" class="feasibility-checkbox">
                                <span class="en">Include Breeding Revenue</span>
                                <span class="ar">تضمين إيرادات التربية</span>
                            </label>
                        </div>
                        <div class="input-group" x-show="feasibility.includeBreeding">
                            <label class="bil-spread">
                                <span class="en">Expected Lamb Price (EGP)</span>
                                <span class="ar">سعر الحمل المتوقع (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.lambPrice" min="0" class="calc-input">
                        </div>
                    </div>
                    
                    <!-- Enhanced Input Fields -->
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Land & Infrastructure</span>
                            <span class="ar">الأرض والبنية التحتية</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Land Type</span>
                                <span class="ar">نوع الأرض</span>
                            </label>
                            <select x-model="feasibility.landType" class="calc-input">
                                <option value="rented">Rented / إيجار</option>
                                <option value="owned">Owned / ملك</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Land Area (m²)</span>
                                <span class="ar">مساحة الأرض (م²)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.landArea" min="100" class="calc-input">
                        </div>
                        <div class="input-group" x-show="feasibility.landType === 'owned'">
                            <label class="bil-spread">
                                <span class="en">Land Cost (EGP)</span>
                                <span class="ar">تكلفة الأرض (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.landCost" min="0" class="calc-input">
                        </div>
                        <div class="input-group" x-show="feasibility.landType === 'rented'">
                            <label class="bil-spread">
                                <span class="en">Annual Rent (EGP)</span>
                                <span class="ar">الإيجار السنوي (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.annualLandRent" min="0" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Shelter Construction (EGP)</span>
                                <span class="ar">بناء الحظائر (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.shelterCost" min="0" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Fencing Cost (EGP)</span>
                                <span class="ar">تكلفة السياج (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.fencingCost" min="0" class="calc-input">
                        </div>
                    </div>
                    
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Advanced Breeding Parameters</span>
                            <span class="ar">معاملات التربية المتقدمة</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Fertility Rate (%)</span>
                                <span class="ar">معدل الخصوبة (%)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.fertilityRate" min="50" max="100" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Births per Ewe per Year</span>
                                <span class="ar">الولادات لكل نعجة سنويا</span>
                            </label>
                            <input type="number" x-model.number="feasibility.birthsPerEwePerYear" min="1" max="2.5" step="0.1" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Offspring per Birth</span>
                                <span class="ar">المواليد في كل ولادة</span>
                            </label>
                            <input type="number" x-model.number="feasibility.avgOffspringPerBirth" min="1" max="3" step="0.1" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Mortality Rate (%)</span>
                                <span class="ar">معدل النفوق (%)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.mortalityRate" min="0" max="20" class="calc-input">
                        </div>
                    </div>
                    
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Market & Competition</span>
                            <span class="ar">السوق والمنافسة</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Number of Competitors</span>
                                <span class="ar">عدد المنافسين</span>
                            </label>
                            <input type="number" x-model.number="feasibility.competitorCount" min="0" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Competitor Avg Price/kg (EGP)</span>
                                <span class="ar">متوسط سعر المنافسين/كجم (جنيه)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.competitorAvgPrice" min="100" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Price Advantage (%)</span>
                                <span class="ar">ميزة السعر (%)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.priceAdvantage" min="-20" max="20" class="calc-input">
                        </div>
                    </div>
                    
                    <div class="calc-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Risk Factors</span>
                            <span class="ar">عوامل المخاطر</span>
                        </h4>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Feed Price Volatility (%)</span>
                                <span class="ar">تقلب أسعار الأعلاف (%)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.feedPriceVolatility" min="0" max="50" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Disease Risk Factor (%)</span>
                                <span class="ar">عامل مخاطر الأمراض (%)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.diseaseRiskFactor" min="0" max="30" class="calc-input">
                        </div>
                        <div class="input-group">
                            <label class="bil-spread">
                                <span class="en">Market Demand Variation (%)</span>
                                <span class="ar">تباين طلب السوق (%)</span>
                            </label>
                            <input type="number" x-model.number="feasibility.marketDemandVariation" min="0" max="50" class="calc-input">
                        </div>
                    </div>
                </div>
                
                <div class="calc-actions">
                    <button @click="calculateFeasibility()" class="btn bp btn-lg bil-inline">
                        <span class="en">Calculate Feasibility</span>
                        <span class="ar">احسب الجدوى</span>
                    </button>
                    <button @click="saveFeasibilityAnalysis()" x-show="feasibility.showResults" class="btn bp-alt btn-lg bil-inline">
                        <span class="en">Save Analysis</span>
                        <span class="ar">حفظ التحليل</span>
                    </button>
                </div>
            </div>
            
            <!-- Results Section -->
            <div x-show="feasibility.showResults" class="results-section" x-cloak>
                <h3 class="section-title bil-spread">
                    <span class="en">Analysis Results</span>
                    <span class="ar">نتائج التحليل</span>
                </h3>
                
                <div class="results-grid">
                    <div class="result-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Initial Investment</span>
                            <span class="ar">الاستثمار الأولي</span>
                        </h4>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Total Initial Cost</span>
                                <span class="ar">إجمالي التكلفة الأولية</span>
                            </span>
                            <span class="result-value">EGP <span x-text="feasibility.results.totalInitialCost?.toLocaleString()">0</span></span>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Operating Summary</span>
                            <span class="ar">ملخص التشغيل</span>
                        </h4>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Monthly Operating Cost</span>
                                <span class="ar">تكلفة التشغيل الشهرية</span>
                            </span>
                            <span class="result-value">EGP <span x-text="feasibility.results.monthlyOperatingCost?.toLocaleString()">0</span></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Total Operating Cost</span>
                                <span class="ar">إجمالي تكلفة التشغيل</span>
                            </span>
                            <span class="result-value">EGP <span x-text="feasibility.results.totalOperatingCost?.toLocaleString()">0</span></span>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Profitability</span>
                            <span class="ar">الربحية</span>
                        </h4>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Sheep Sales Revenue</span>
                                <span class="ar">إيرادات بيع الأغنام</span>
                            </span>
                            <span class="result-value">EGP <span x-text="feasibility.results.totalRevenue?.toLocaleString()">0</span></span>
                        </div>
                        <div class="result-item" x-show="feasibility.results.breedingRevenue > 0">
                            <span class="result-label bil-inline">
                                <span class="en">Breeding Revenue</span>
                                <span class="ar">إيرادات التربية</span>
                            </span>
                            <span class="result-value">EGP <span x-text="feasibility.results.breedingRevenue?.toLocaleString()">0</span></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Net Profit</span>
                                <span class="ar">صافي الربح</span>
                            </span>
                            <span class="result-value" :class="feasibility.results.netProfit > 0 ? 'text-success' : 'text-danger'">
                                EGP <span x-text="feasibility.results.netProfit?.toLocaleString()">0</span>
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Monthly Profit</span>
                                <span class="ar">الربح الشهري</span>
                            </span>
                            <span class="result-value" :class="feasibility.results.monthlyProfit > 0 ? 'text-success' : 'text-danger'">
                                EGP <span x-text="feasibility.results.monthlyProfit?.toLocaleString()">0</span>
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">ROI</span>
                                <span class="ar">العائد على الاستثمار</span>
                            </span>
                            <span class="result-value" :class="feasibility.results.roi > 0 ? 'text-success' : 'text-danger'">
                                <span x-text="feasibility.results.roi?.toFixed(1)">0</span>%
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Break-even Period</span>
                                <span class="ar">فترة استرداد رأس المال</span>
                            </span>
                            <span class="result-value">
                                <span x-text="feasibility.results.breakEvenMonths < 999 ? feasibility.results.breakEvenMonths : 'N/A'"></span>
                                <span x-show="feasibility.results.breakEvenMonths < 999" class="bil-inline">
                                    <span class="en">months</span>
                                    <span class="ar">شهر</span>
                                </span>
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Profit Margin</span>
                                <span class="ar">هامش الربح</span>
                            </span>
                            <span class="result-value" :class="feasibility.results.profitMargin > 0 ? 'text-success' : 'text-danger'">
                                <span x-text="feasibility.results.profitMargin?.toFixed(1)">0</span>%
                            </span>
                        </div>
                    </div>
                    
                    <!-- Enhanced Results - Financial Analysis -->
                    <div class="result-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Financial Analysis</span>
                            <span class="ar">التحليل المالي</span>
                        </h4>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Net Present Value (NPV)</span>
                                <span class="ar">صافي القيمة الحالية</span>
                            </span>
                            <span class="result-value" :class="feasibility.results.npv > 0 ? 'text-success' : 'text-danger'">
                                EGP <span x-text="Math.round(feasibility.results.npv || 0).toLocaleString()">0</span>
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Payback Period</span>
                                <span class="ar">فترة الاسترداد</span>
                            </span>
                            <span class="result-value">
                                <span x-text="feasibility.results.paybackPeriod < 999 ? feasibility.results.paybackPeriod : 'N/A'">0</span>
                                <span x-show="feasibility.results.paybackPeriod < 999" class="bil-inline">
                                    <span class="en">months</span>
                                    <span class="ar">شهر</span>
                                </span>
                            </span>
                        </div>
                    </div>
                    
                    <!-- Risk Assessment -->
                    <div class="result-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Risk Assessment</span>
                            <span class="ar">تقييم المخاطر</span>
                        </h4>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Feed Price Risk</span>
                                <span class="ar">مخاطر أسعار الأعلاف</span>
                            </span>
                            <span class="result-value" :class="{
                                'text-success': feasibility.results.riskAssessment?.feedPriceRisk === 'Low',
                                'text-warning': feasibility.results.riskAssessment?.feedPriceRisk === 'Medium',
                                'text-danger': feasibility.results.riskAssessment?.feedPriceRisk === 'High'
                            }" x-text="feasibility.results.riskAssessment?.feedPriceRisk || 'N/A'"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Disease Risk</span>
                                <span class="ar">مخاطر الأمراض</span>
                            </span>
                            <span class="result-value" :class="{
                                'text-success': feasibility.results.riskAssessment?.diseaseRisk === 'Low',
                                'text-warning': feasibility.results.riskAssessment?.diseaseRisk === 'Medium',
                                'text-danger': feasibility.results.riskAssessment?.diseaseRisk === 'High'
                            }" x-text="feasibility.results.riskAssessment?.diseaseRisk || 'N/A'"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Market Risk</span>
                                <span class="ar">مخاطر السوق</span>
                            </span>
                            <span class="result-value" :class="{
                                'text-success': feasibility.results.riskAssessment?.marketRisk === 'Low',
                                'text-warning': feasibility.results.riskAssessment?.marketRisk === 'Medium',
                                'text-danger': feasibility.results.riskAssessment?.marketRisk === 'High'
                            }" x-text="feasibility.results.riskAssessment?.marketRisk || 'N/A'"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Overall Risk</span>
                                <span class="ar">المخاطر الإجمالية</span>
                            </span>
                            <span class="result-value" :class="{
                                'text-success': feasibility.results.riskAssessment?.overallRisk === 'Low',
                                'text-warning': feasibility.results.riskAssessment?.overallRisk === 'Medium',
                                'text-danger': feasibility.results.riskAssessment?.overallRisk === 'High'
                            }" x-text="feasibility.results.riskAssessment?.overallRisk || 'N/A'"></span>
                        </div>
                    </div>
                    
                    <!-- Market Analysis -->
                    <div class="result-card">
                        <h4 class="card-title bil-spread">
                            <span class="en">Market Analysis</span>
                            <span class="ar">تحليل السوق</span>
                        </h4>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Estimated Market Share</span>
                                <span class="ar">الحصة السوقية المتوقعة</span>
                            </span>
                            <span class="result-value">
                                <span x-text="feasibility.results.marketAnalysis?.estimatedMarketShare?.toFixed(1) || '0'">0</span>%
                            </span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Price Competitiveness</span>
                                <span class="ar">تنافسية السعر</span>
                            </span>
                            <span class="result-value" x-text="feasibility.results.marketAnalysis?.priceCompetitiveness || 'N/A'"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label bil-inline">
                                <span class="en">Demand Outlook</span>
                                <span class="ar">توقعات الطلب</span>
                            </span>
                            <span class="result-value" x-text="feasibility.results.marketAnalysis?.demandOutlook || 'N/A'"></span>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Features Tabs -->
                <div class="calc-tabs">
                    <button @click="feasibility.activeTab = 'basic'" 
                            :class="feasibility.activeTab === 'basic' ? 'tab-active' : 'tab-inactive'" 
                            class="tab-button bil-inline">
                        <span class="en">Basic Analysis</span>
                        <span class="ar">التحليل الأساسي</span>
                    </button>
                    <button @click="feasibility.activeTab = 'advanced'; initAdvancedFeatures()" 
                            :class="feasibility.activeTab === 'advanced' ? 'tab-active' : 'tab-inactive'" 
                            class="tab-button bil-inline">
                        <span class="en">Advanced Features</span>
                        <span class="ar">المميزات المتقدمة</span>
                    </button>
                    <button @click="feasibility.activeTab = 'reports'" 
                            :class="feasibility.activeTab === 'reports' ? 'tab-active' : 'tab-inactive'" 
                            class="tab-button bil-inline">
                        <span class="en">Reports & Charts</span>
                        <span class="ar">التقارير والرسوم البيانية</span>
                    </button>
                </div>
                
                <!-- Advanced Features Section -->
                <div x-show="feasibility.activeTab === 'advanced'" class="advanced-features-section">
                    <div class="calc-grid">
                        <!-- Feed Optimizer -->
                        <div class="calc-card">
                            <h4 class="card-title bil-spread">
                                <span class="en">Feed Optimizer</span>
                                <span class="ar">محسن الأعلاف</span>
                            </h4>
                            <div class="input-group">
                                <label class="bil-spread">
                                    <span class="en">Target Protein %</span>
                                    <span class="ar">نسبة البروتين المستهدفة %</span>
                                </label>
                                <input type="number" x-model.number="feasibility.feedOptimizer.targetProtein" min="12" max="20" class="calc-input">
                            </div>
                            <div class="input-group">
                                <label class="bil-spread">
                                    <span class="en">Max Cost per Ton (EGP)</span>
                                    <span class="ar">أقصى تكلفة للطن (جنيه)</span>
                                </label>
                                <input type="number" x-model.number="feasibility.feedOptimizer.maxCostPerTon" min="1000" class="calc-input">
                            </div>
                            <button @click="optimizeFeedMix()" class="btn bp btn-sm">
                                <span class="bil-inline">
                                    <span class="en">Optimize Mix</span>
                                    <span class="ar">تحسين الخلطة</span>
                                </span>
                            </button>
                        </div>
                        
                        <!-- Breeding Calendar -->
                        <div class="calc-card">
                            <h4 class="card-title bil-spread">
                                <span class="en">Breeding Calendar</span>
                                <span class="ar">تقويم التربية</span>
                            </h4>
                            <div class="input-group">
                                <label class="bil-spread">
                                    <span class="en">Target Lambing Season</span>
                                    <span class="ar">موسم الولادة المستهدف</span>
                                </label>
                                <select x-model="feasibility.breedingCalendar.targetSeason" class="calc-input">
                                    <option value="spring">Spring / الربيع</option>
                                    <option value="summer">Summer / الصيف</option>
                                    <option value="fall">Fall / الخريف</option>
                                    <option value="winter">Winter / الشتاء</option>
                                </select>
                            </div>
                            <button @click="generateBreedingCalendar()" class="btn bp btn-sm">
                                <span class="bil-inline">
                                    <span class="en">Generate Calendar</span>
                                    <span class="ar">إنشاء التقويم</span>
                                </span>
                            </button>
                        </div>
                        
                        <!-- Sensitivity Analysis -->
                        <div class="calc-card">
                            <h4 class="card-title bil-spread">
                                <span class="en">Sensitivity Analysis</span>
                                <span class="ar">تحليل الحساسية</span>
                            </h4>
                            <div class="input-group">
                                <label class="bil-spread">
                                    <span class="en">Variable to Test</span>
                                    <span class="ar">المتغير للاختبار</span>
                                </label>
                                <select x-model="feasibility.sensitivity.variable" class="calc-input">
                                    <option value="feedPrice">Feed Price / سعر العلف</option>
                                    <option value="sheepPrice">Sheep Price / سعر الأغنام</option>
                                    <option value="mortalityRate">Mortality Rate / معدل النفوق</option>
                                </select>
                            </div>
                            <button @click="runSensitivityAnalysis()" class="btn bp btn-sm">
                                <span class="bil-inline">
                                    <span class="en">Run Analysis</span>
                                    <span class="ar">تشغيل التحليل</span>
                                </span>
                            </button>
                        </div>
                        
                        <!-- Multi-Year Projection -->
                        <div class="calc-card">
                            <h4 class="card-title bil-spread">
                                <span class="en">5-Year Projection</span>
                                <span class="ar">توقعات 5 سنوات</span>
                            </h4>
                            <div class="input-group">
                                <label class="bil-spread">
                                    <span class="en">Annual Growth Rate %</span>
                                    <span class="ar">معدل النمو السنوي %</span>
                                </label>
                                <input type="number" x-model.number="feasibility.multiYear.annualGrowthRate" min="0" max="50" class="calc-input">
                            </div>
                            <button @click="generateMultiYearProjection()" class="btn bp btn-sm">
                                <span class="bil-inline">
                                    <span class="en">Generate Projection</span>
                                    <span class="ar">إنشاء التوقعات</span>
                                </span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Advanced Results Display -->
                    <div class="advanced-results" x-show="feasibility.advancedResults">
                        <div class="result-card" x-show="feasibility.advancedResults && feasibility.advancedResults.feedMix">
                            <h4 class="card-title bil-spread">
                                <span class="en">Optimized Feed Mix</span>
                                <span class="ar">الخلطة المُحسنة</span>
                            </h4>
                            <div class="feed-mix-results">
                                <template x-for="(percentage, ingredient) in (feasibility.advancedResults && feasibility.advancedResults.feedMix ? feasibility.advancedResults.feedMix.ingredients : {})" :key="ingredient">
                                    <div class="result-item">
                                        <span class="result-label" x-text="ingredient"></span>
                                        <span class="result-value" x-text="percentage + '%'"></span>
                                    </div>
                                </template>
                                <div class="result-item">
                                    <span class="result-label bil-inline">
                                        <span class="en">Total Cost/Ton</span>
                                        <span class="ar">التكلفة الإجمالية/طن</span>
                                    </span>
                                    <span class="result-value">EGP <span x-text="feasibility.advancedResults && feasibility.advancedResults.feedMix ? feasibility.advancedResults.feedMix.costPerTon?.toLocaleString() : '0'">0</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Reports & Charts Section -->
                <div x-show="feasibility.activeTab === 'reports'" class="reports-section">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <h4 class="card-title bil-spread">
                                <span class="en">Cash Flow Chart</span>
                                <span class="ar">مخطط التدفق النقدي</span>
                            </h4>
                            <canvas id="cashFlowChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4 class="card-title bil-spread">
                                <span class="en">ROI Comparison</span>
                                <span class="ar">مقارنة العائد على الاستثمار</span>
                            </h4>
                            <canvas id="roiComparisonChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4 class="card-title bil-spread">
                                <span class="en">Sensitivity Analysis</span>
                                <span class="ar">تحليل الحساسية</span>
                            </h4>
                            <canvas id="sensitivityChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <h4 class="card-title bil-spread">
                                <span class="en">Break-Even Analysis</span>
                                <span class="ar">تحليل نقطة التعادل</span>
                            </h4>
                            <canvas id="breakEvenChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="report-actions">
                        <button @click="generatePDFReport()" class="btn bp">
                            <span class="bil-inline">
                                <span class="en">📄 Generate PDF Report</span>
                                <span class="ar">📄 إنشاء تقرير PDF</span>
                            </span>
                        </button>
                        <button @click="exportToExcel()" class="btn bac">
                            <span class="bil-inline">
                                <span class="en">📊 Export to Excel</span>
                                <span class="ar">📊 تصدير إلى Excel</span>
                            </span>
                        </button>
                    </div>
                </div>
                
                <div class="recommendation-box">
                    <h3 class="bil-spread">
                        <span class="en">Recommendation</span>
                        <span class="ar">التوصية</span>
                    </h3>
                    <p class="recommendation-status" :class="feasibility.results.isViable ? 'positive' : 'negative'">
                        <span x-show="feasibility.results.isViable" class="bil-inline">
                            <span class="en">✓ Project is Viable</span>
                            <span class="ar">✓ المشروع مجدي</span>
                        </span>
                        <span x-show="!feasibility.results.isViable" class="bil-inline">
                            <span class="en">✗ Project Needs Review</span>
                            <span class="ar">✗ المشروع يحتاج مراجعة</span>
                        </span>
                    </p>
                    <p class="recommendation-text bil-row">
                        <span x-show="feasibility.results.isViable" class="en">
                            Based on your inputs, this project shows positive returns with a <span x-text="feasibility.results.roi?.toFixed(1)">0</span>% ROI. 
                            The projected profit of EGP <span x-text="feasibility.results.netProfit?.toLocaleString()">0</span> indicates a viable investment opportunity.
                        </span>
                        <span x-show="feasibility.results.isViable" class="ar">
                            بناءً على المدخلات، يُظهر هذا المشروع عوائد إيجابية بنسبة <span x-text="feasibility.results.roi?.toFixed(1)">0</span>% عائد على الاستثمار.
                            الربح المتوقع البالغ <span x-text="feasibility.results.netProfit?.toLocaleString()">0</span> جنيه يشير إلى فرصة استثمارية مجدية.
                        </span>
                        <span x-show="!feasibility.results.isViable" class="en">
                            The current projections show a negative return. Consider adjusting your parameters such as reducing costs, 
                            increasing selling price, or extending the project duration to improve viability.
                        </span>
                        <span x-show="!feasibility.results.isViable" class="ar">
                            التوقعات الحالية تُظهر عائداً سلبياً. فكر في تعديل المعاملات مثل تقليل التكاليف،
                            زيادة سعر البيع، أو تمديد مدة المشروع لتحسين الجدوى.
                        </span>
                    </p>
                </div>
            </div>
        </div>
</div>

<!-- Farm Management Modal -->
<div x-show="showFarmModal" class="modal-overlay" @click="closeFarmModal()"></div>
<div x-show="showFarmModal" class="modal modal-lg" role="dialog" aria-modal="true" aria-labelledby="farm-modal-title" @keydown.escape.window="closeFarmModal()" x-cloak>
        <div class="modal-header">
            <h2 id="farm-modal-title" class="bil-spread modal-title">
                <span class="en">Farm Management System</span>
                <span class="ar">نظام إدارة المزرعة</span>
            </h2>
            <button @click="closeFarmModal()" class="modal-close-btn">×</button>
        </div>
        <div class="modal-content">
            <!-- Stats Overview -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">🐑</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Total Sheep</span>
                            <span class="ar">إجمالي الأغنام</span>
                        </h3>
                        <p class="stat-value" x-text="farmStats.totalSheep">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">💰</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Total Value</span>
                            <span class="ar">القيمة الإجمالية</span>
                        </h3>
                        <p class="stat-value">EGP <span x-text="farmStats.totalValue.toLocaleString()">0</span></p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">📈</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Ready for Market</span>
                            <span class="ar">جاهز للتسويق</span>
                        </h3>
                        <p class="stat-value" x-text="farmStats.readyForMarket">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">⚖️</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Avg Weight</span>
                            <span class="ar">متوسط الوزن</span>
                        </h3>
                        <p class="stat-value"><span x-text="farmStats.averageWeight">0</span> kg</p>
                    </div>
                </div>
            </div>
            
            <!-- Health Status Summary -->
            <div class="stats-grid stats-grid-spaced">
                <div class="stat-card">
                    <div class="stat-icon">💚</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Healthy</span>
                            <span class="ar">بصحة جيدة</span>
                        </h3>
                        <p class="stat-value" x-text="farmStats.healthy">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">🤰</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Pregnant</span>
                            <span class="ar">حامل</span>
                        </h3>
                        <p class="stat-value" x-text="farmStats.pregnant">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">⚠️</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Need Attention</span>
                            <span class="ar">تحتاج رعاية</span>
                        </h3>
                        <p class="stat-value" x-text="farmStats.needAttention">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">💸</div>
                    <div class="stat-content">
                        <h3 class="bil-inline">
                            <span class="en">Monthly Cost</span>
                            <span class="ar">التكلفة الشهرية</span>
                        </h3>
                        <p class="stat-value">EGP <span x-text="farmStats.monthlyExpenses.toLocaleString()">0</span></p>
                    </div>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-nav">
                <button @click="farmActiveTab = 'inventory'" :class="{'active': farmActiveTab === 'inventory'}" class="tab-btn bil-inline">
                    <span class="en">Inventory</span>
                    <span class="ar">المخزون</span>
                </button>
                <button @click="farmActiveTab = 'breeding'" :class="{'active': farmActiveTab === 'breeding'}" class="tab-btn bil-inline">
                    <span class="en">Breeding</span>
                    <span class="ar">التربية</span>
                </button>
                <button @click="farmActiveTab = 'health'" :class="{'active': farmActiveTab === 'health'}" class="tab-btn bil-inline">
                    <span class="en">Health</span>
                    <span class="ar">الصحة</span>
                </button>
                <button @click="farmActiveTab = 'feed'" :class="{'active': farmActiveTab === 'feed'}" class="tab-btn bil-inline">
                    <span class="en">Feed</span>
                    <span class="ar">الأعلاف</span>
                </button>
                <button @click="farmActiveTab = 'tasks'" :class="{'active': farmActiveTab === 'tasks'}" class="tab-btn bil-inline">
                    <span class="en">Tasks</span>
                    <span class="ar">المهام</span>
                </button>
                <button @click="farmActiveTab = 'reports'" :class="{'active': farmActiveTab === 'reports'}" class="tab-btn bil-inline">
                    <span class="en">Reports</span>
                    <span class="ar">التقارير</span>
                </button>
                <button @click="farmActiveTab = 'dashboard'; updateFinancialDashboard()" :class="{'active': farmActiveTab === 'dashboard'}" class="tab-btn bil-inline">
                    <span class="en">💰 Dashboard</span>
                    <span class="ar">💰 لوحة التحكم</span>
                </button>
            </div>

            <!-- Sheep List -->
            <div class="sheep-section" x-show="farmActiveTab === 'inventory'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">Sheep Inventory</span>
                        <span class="ar">قائمة الأغنام</span>
                    </h3>
                    <div class="header-actions">
                        <select x-model="farmFilterStatus" @change="filterFarmSheep()" class="filter-select">
                            <option value="">All Status</option>
                            <option value="healthy">Healthy</option>
                            <option value="sick">Sick</option>
                            <option value="pregnant">Pregnant</option>
                        </select>
                        <button @click="showAddSheepForm = true" class="btn bp bil-inline">
                            <span class="en">+ Add Sheep</span>
                            <span class="ar">+ إضافة رأس</span>
                        </button>
                    </div>
                </div>

                <div class="sheep-grid">
                    <template x-for="sheep in filteredFarmSheep" :key="sheep.id">
                        <div class="sheep-card" :class="'status-' + sheep.status">
                            <div class="sheep-header">
                                <h3 x-text="sheep.tag_id"></h3>
                                <span class="sheep-status" x-text="sheep.status"></span>
                            </div>
                            <div class="sheep-details">
                                <p class="detail-row">
                                    <span class="bil-inline">
                                        <span class="en">Breed:</span>
                                        <span class="ar">السلالة:</span>
                                    </span>
                                    <span x-text="sheep.breed"></span>
                                </p>
                                <p class="detail-row">
                                    <span class="bil-inline">
                                        <span class="en">Age:</span>
                                        <span class="ar">العمر:</span>
                                    </span>
                                    <span x-text="sheep.age_months + ' months'"></span>
                                </p>
                                <p class="detail-row">
                                    <span class="bil-inline">
                                        <span class="en">Weight:</span>
                                        <span class="ar">الوزن:</span>
                                    </span>
                                    <span x-text="sheep.weight_kg + ' kg'"></span>
                                </p>
                                <p class="detail-row" x-show="sheep.last_vaccination">
                                    <span class="bil-inline">
                                        <span class="en">Last Vaccination:</span>
                                        <span class="ar">آخر تطعيم:</span>
                                    </span>
                                    <span x-text="formatDate(sheep.last_vaccination)"></span>
                                </p>
                                <p class="detail-row vaccination-warning" x-show="needsVaccination(sheep)">
                                    <span class="bil-inline">
                                        <span class="en">⚠️ Vaccination overdue!</span>
                                        <span class="ar">⚠️ التطعيم متأخر!</span>
                                    </span>
                                </p>
                                <p class="detail-row">
                                    <span class="bil-inline">
                                        <span class="en">Market Value:</span>
                                        <span class="ar">القيمة السوقية:</span>
                                    </span>
                                    <span>EGP <span x-text="(sheep.weight_kg * (marketData.breeds[sheep.breed]?.pricePerKg || 300)).toLocaleString()"></span></span>
                                </p>
                            </div>
                            <div class="sheep-actions">
                                <button @click="editFarmSheep(sheep)" class="btn btn-sm bac bil-inline">
                                    <span class="en">Edit</span>
                                    <span class="ar">تعديل</span>
                                </button>
                                <button @click="recordSheepHealth(sheep)" class="btn btn-sm bp-alt bil-inline">
                                    <span class="en">Health</span>
                                    <span class="ar">الصحة</span>
                                </button>
                                <button @click="deleteFarmSheep(sheep.id)" class="btn btn-sm danger bil-inline">
                                    <span class="en">Delete</span>
                                    <span class="ar">حذف</span>
                                </button>
                            </div>
                        </div>
                    </template>
                </div>

                <div x-show="filteredFarmSheep.length === 0" class="empty-state">
                    <p class="bil-spread">
                        <span class="en">No sheep found</span>
                        <span class="ar">لا توجد أغنام</span>
                    </p>
                </div>
            </div>
            
            <!-- Breeding Management Tab -->
            <div class="breeding-section" x-show="farmActiveTab === 'breeding'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">Breeding Management</span>
                        <span class="ar">إدارة التربية</span>
                    </h3>
                    <button @click="showBreedingForm = true" class="btn bp bil-inline">
                        <span class="en">+ Record Breeding</span>
                        <span class="ar">+ تسجيل تزاوج</span>
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">🤰</div>
                        <div class="stat-content">
                            <h3 class="bil-inline">
                                <span class="en">Pregnant Ewes</span>
                                <span class="ar">النعاج الحوامل</span>
                            </h3>
                            <p class="stat-value" x-text="farmStats.pregnant">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">👶</div>
                        <div class="stat-content">
                            <h3 class="bil-inline">
                                <span class="en">Expected Births</span>
                                <span class="ar">الولادات المتوقعة</span>
                            </h3>
                            <p class="stat-value" x-text="farmStats.expectedBirths">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">♀️</div>
                        <div class="stat-content">
                            <h3 class="bil-inline">
                                <span class="en">Total Ewes</span>
                                <span class="ar">إجمالي النعاج</span>
                            </h3>
                            <p class="stat-value" x-text="farmStats.totalEwes">0</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">♂️</div>
                        <div class="stat-content">
                            <h3 class="bil-inline">
                                <span class="en">Total Rams</span>
                                <span class="ar">إجمالي الكباش</span>
                            </h3>
                            <p class="stat-value" x-text="farmStats.totalRams">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="breeding-records">
                    <h4 class="bil-spread">
                        <span class="en">Recent Breeding Records</span>
                        <span class="ar">سجلات التزاوج الحديثة</span>
                    </h4>
                    <div class="records-list">
                        <template x-for="record in breedingRecords.slice(0, 5)" :key="record.ewe_id + record.breeding_date">
                            <div class="record-item">
                                <span x-text="`Ewe: ${record.ewe_id} × Ram: ${record.ram_id}`"></span>
                                <span x-text="formatDate(record.breeding_date)"></span>
                                <span class="bil-inline">
                                    <span class="en">Due:</span>
                                    <span class="ar">موعد الولادة:</span>
                                </span>
                                <span x-text="formatDate(record.expected_lambing)"></span>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- Health Management Tab -->
            <div class="health-section" x-show="farmActiveTab === 'health'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">Health Management</span>
                        <span class="ar">إدارة الصحة</span>
                    </h3>
                    <button @click="showHealthCheckForm = true" class="btn bp bil-inline">
                        <span class="en">+ Health Check</span>
                        <span class="ar">+ فحص صحي</span>
                    </button>
                </div>
                
                <div class="vaccination-alert" x-show="farmStats.upcomingVaccinations > 0">
                    <p class="bil-inline">
                        <span class="en">⚠️ <span x-text="farmStats.upcomingVaccinations"></span> animals need vaccination soon</span>
                        <span class="ar">⚠️ <span x-text="farmStats.upcomingVaccinations"></span> حيوانات تحتاج للتطعيم قريباً</span>
                    </p>
                </div>
                
                <div class="health-overview">
                    <h4 class="bil-spread">
                        <span class="en">Health Status Overview</span>
                        <span class="ar">نظرة عامة على الحالة الصحية</span>
                    </h4>
                    <div class="health-stats">
                        <div class="health-stat">
                            <span class="status-icon healthy">💚</span>
                            <span x-text="`${farmStats.healthy} Healthy`"></span>
                        </div>
                        <div class="health-stat">
                            <span class="status-icon sick">🤒</span>
                            <span x-text="`${farmSheep.filter(s => s.status === 'sick').length} Sick`"></span>
                        </div>
                        <div class="health-stat">
                            <span class="status-icon attention">⚠️</span>
                            <span x-text="`${farmStats.needAttention} Need Attention`"></span>
                        </div>
                    </div>
                </div>
                
                <div class="vaccination-schedule">
                    <h4 class="bil-spread">
                        <span class="en">Vaccination Schedule</span>
                        <span class="ar">جدول التطعيمات</span>
                    </h4>
                    <div class="schedule-grid">
                        <template x-for="(vaccine, key) in vaccinationSchedule" :key="key">
                            <div class="vaccine-card">
                                <h5 x-text="vaccine.name[currLang]"></h5>
                                <p class="bil-inline">
                                    <span class="en">Every <span x-text="vaccine.frequency"></span> days</span>
                                    <span class="ar">كل <span x-text="vaccine.frequency"></span> يوم</span>
                                </p>
                                <p>EGP <span x-text="vaccine.cost"></span></p>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- Feed Management Tab -->
            <div class="feed-section" x-show="farmActiveTab === 'feed'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">Feed Inventory</span>
                        <span class="ar">مخزون الأعلاف</span>
                    </h3>
                    <button @click="showFeedRestockForm = true" class="btn bp bil-inline">
                        <span class="en">+ Restock Feed</span>
                        <span class="ar">+ إضافة علف</span>
                    </button>
                </div>
                
                <div class="feed-alert" x-show="farmStats.feedInventory < 7">
                    <p class="bil-inline">
                        <span class="en">⚠️ Low feed inventory - only <span x-text="farmStats.feedInventory"></span> days remaining</span>
                        <span class="ar">⚠️ مخزون العلف منخفض - <span x-text="farmStats.feedInventory"></span> أيام متبقية فقط</span>
                    </p>
                </div>
                
                <div class="feed-inventory-grid">
                    <div class="feed-type-card">
                        <h4 class="bil-inline">
                            <span class="en">Alfalfa</span>
                            <span class="ar">البرسيم</span>
                        </h4>
                        <p class="feed-quantity"><span x-text="feedInventory.alfalfa"></span> kg</p>
                        <button @click="updateFeedInventory('alfalfa', 100, 'consume')" class="btn btn-sm">
                            <span class="bil-inline">
                                <span class="en">Use 100kg</span>
                                <span class="ar">استخدم 100 كجم</span>
                            </span>
                        </button>
                    </div>
                    <div class="feed-type-card">
                        <h4 class="bil-inline">
                            <span class="en">Concentrate</span>
                            <span class="ar">العلف المركز</span>
                        </h4>
                        <p class="feed-quantity"><span x-text="feedInventory.concentrate"></span> kg</p>
                        <button @click="updateFeedInventory('concentrate', 100, 'consume')" class="btn btn-sm">
                            <span class="bil-inline">
                                <span class="en">Use 100kg</span>
                                <span class="ar">استخدم 100 كجم</span>
                            </span>
                        </button>
                    </div>
                    <div class="feed-type-card">
                        <h4 class="bil-inline">
                            <span class="en">Grains</span>
                            <span class="ar">الحبوب</span>
                        </h4>
                        <p class="feed-quantity"><span x-text="feedInventory.grains"></span> kg</p>
                        <button @click="updateFeedInventory('grains', 100, 'consume')" class="btn btn-sm">
                            <span class="bil-inline">
                                <span class="en">Use 100kg</span>
                                <span class="ar">استخدم 100 كجم</span>
                            </span>
                        </button>
                    </div>
                </div>
                
                <div class="feed-consumption">
                    <h4 class="bil-spread">
                        <span class="en">Daily Feed Requirements</span>
                        <span class="ar">متطلبات العلف اليومية</span>
                    </h4>
                    <p class="bil-inline">
                        <span class="en">Total daily requirement: <span x-text="(farmStats.totalSheep * 2.5).toFixed(1)"></span> kg</span>
                        <span class="ar">الاحتياج اليومي الإجمالي: <span x-text="(farmStats.totalSheep * 2.5).toFixed(1)"></span> كجم</span>
                    </p>
                </div>
            </div>
            
            <!-- Tasks Management Tab -->
            <div class="tasks-section" x-show="farmActiveTab === 'tasks'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">Farm Tasks</span>
                        <span class="ar">مهام المزرعة</span>
                    </h3>
                    <button @click="showTaskForm = true" class="btn bp bil-inline">
                        <span class="en">+ Add Task</span>
                        <span class="ar">+ إضافة مهمة</span>
                    </button>
                </div>
                
                <div class="tasks-overview">
                    <div class="overdue-tasks" x-show="getOverdueTasks().length > 0">
                        <h4 class="bil-spread">
                            <span class="en">⚠️ Overdue Tasks</span>
                            <span class="ar">⚠️ مهام متأخرة</span>
                        </h4>
                        <template x-for="task in getOverdueTasks()" :key="task.id">
                            <div class="task-item overdue">
                                <h5 x-text="task.title"></h5>
                                <p x-text="task.description"></p>
                                <span class="task-date" x-text="`Due: ${formatDate(task.dueDate)}`"></span>
                                <button @click="completeTask(task.id)" class="btn btn-sm bp">
                                    <span class="bil-inline">
                                        <span class="en">Complete</span>
                                        <span class="ar">إنجاز</span>
                                    </span>
                                </button>
                            </div>
                        </template>
                    </div>
                    
                    <div class="upcoming-tasks">
                        <h4 class="bil-spread">
                            <span class="en">Upcoming Tasks</span>
                            <span class="ar">المهام القادمة</span>
                        </h4>
                        <template x-for="task in getUpcomingTasks()" :key="task.id">
                            <div class="task-item" :class="`priority-${task.priority}`">
                                <h5 x-text="task.title"></h5>
                                <p x-text="task.description"></p>
                                <span class="task-date" x-text="`Due: ${formatDate(task.dueDate)}`"></span>
                                <span class="task-priority" x-text="task.priority"></span>
                                <button @click="completeTask(task.id)" class="btn btn-sm bp">
                                    <span class="bil-inline">
                                        <span class="en">Complete</span>
                                        <span class="ar">إنجاز</span>
                                    </span>
                                </button>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
            
            <!-- Reports Tab -->
            <div class="reports-section" x-show="farmActiveTab === 'reports'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">Farm Reports</span>
                        <span class="ar">تقارير المزرعة</span>
                    </h3>
                    <button @click="exportFarmData()" class="btn bp bil-inline">
                        <span class="en">📥 Export Data</span>
                        <span class="ar">📥 تصدير البيانات</span>
                    </button>
                </div>
                
                <div class="report-actions">
                    <button @click="generateHealthReport()" class="btn bac bil-inline">
                        <span class="en">Health Report</span>
                        <span class="ar">تقرير صحي</span>
                    </button>
                    <button @click="generateFinancialReport()" class="btn bac bil-inline">
                        <span class="en">Financial Report</span>
                        <span class="ar">تقرير مالي</span>
                    </button>
                    <button @click="generateInventoryReport()" class="btn bac bil-inline">
                        <span class="en">Inventory Report</span>
                        <span class="ar">تقرير المخزون</span>
                    </button>
                </div>
                
                <div class="quick-stats">
                    <h4 class="bil-spread">
                        <span class="en">Quick Statistics</span>
                        <span class="ar">إحصائيات سريعة</span>
                    </h4>
                    <div class="stats-summary">
                        <div class="stat-row">
                            <span class="bil-inline">
                                <span class="en">Mortality Rate:</span>
                                <span class="ar">معدل النفوق:</span>
                            </span>
                            <span x-text="`${farmStats.mortalityRate}%`"></span>
                        </div>
                        <div class="stat-row">
                            <span class="bil-inline">
                                <span class="en">Average Weight:</span>
                                <span class="ar">متوسط الوزن:</span>
                            </span>
                            <span x-text="`${farmStats.averageWeight} kg`"></span>
                        </div>
                        <div class="stat-row">
                            <span class="bil-inline">
                                <span class="en">Monthly Expenses:</span>
                                <span class="ar">المصروفات الشهرية:</span>
                            </span>
                            <span>EGP <span x-text="farmStats.monthlyExpenses.toLocaleString()"></span></span>
                        </div>
                        <div class="stat-row">
                            <span class="bil-inline">
                                <span class="en">Total Farm Value:</span>
                                <span class="ar">قيمة المزرعة الإجمالية:</span>
                            </span>
                            <span>EGP <span x-text="farmStats.totalValue.toLocaleString()"></span></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Financial Dashboard Tab -->
            <div class="dashboard-section" x-show="farmActiveTab === 'dashboard'">
                <div class="section-header">
                    <h3 class="bil-spread">
                        <span class="en">💰 Financial Dashboard</span>
                        <span class="ar">💰 لوحة المعلومات المالية</span>
                    </h3>
                    <button @click="updateFinancialDashboard()" class="btn bp bil-inline">
                        <span class="en">🔄 Refresh</span>
                        <span class="ar">🔄 تحديث</span>
                    </button>
                </div>
                
                <!-- Revenue Overview -->
                <div class="dashboard-card">
                    <h4 class="bil-spread">
                        <span class="en">📈 Revenue Overview</span>
                        <span class="ar">📈 نظرة عامة على الإيرادات</span>
                    </h4>
                    <div class="metrics-grid">
                        <div class="metric-card success">
                            <div class="metric-label bil-inline">
                                <span class="en">Total Revenue</span>
                                <span class="ar">إجمالي الإيرادات</span>
                            </div>
                            <div class="metric-value">EGP <span x-text="financialDashboard.revenue.total.toLocaleString()"></span></div>
                            <div class="metric-subtext bil-inline">
                                <span class="en">From <span x-text="financialDashboard.revenue.orderCount"></span> orders</span>
                                <span class="ar">من <span x-text="financialDashboard.revenue.orderCount"></span> طلبات</span>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label bil-inline">
                                <span class="en">By Category</span>
                                <span class="ar">حسب الفئة</span>
                            </div>
                            <template x-for="(amount, category) in financialDashboard.revenue.byCategory" :key="category">
                                <div class="category-breakdown">
                                    <span x-text="category"></span>: EGP <span x-text="amount.toLocaleString()"></span>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
                
                <!-- Expenses Breakdown -->
                <div class="dashboard-card">
                    <h4 class="bil-spread">
                        <span class="en">💸 Expenses Breakdown</span>
                        <span class="ar">💸 تفصيل المصروفات</span>
                    </h4>
                    <div class="metrics-grid">
                        <div class="metric-card warning">
                            <div class="metric-label bil-inline">
                                <span class="en">Total Expenses</span>
                                <span class="ar">إجمالي المصروفات</span>
                            </div>
                            <div class="metric-value">EGP <span x-text="financialDashboard.expenses.total.toLocaleString()"></span></div>
                        </div>
                        <div class="expense-breakdown">
                            <div class="expense-item">
                                <span class="bil-inline">
                                    <span class="en">Feed Costs:</span>
                                    <span class="ar">تكاليف العلف:</span>
                                </span>
                                <span>EGP <span x-text="financialDashboard.expenses.feed.toLocaleString()"></span></span>
                            </div>
                            <div class="expense-item">
                                <span class="bil-inline">
                                    <span class="en">Healthcare:</span>
                                    <span class="ar">الرعاية الصحية:</span>
                                </span>
                                <span>EGP <span x-text="financialDashboard.expenses.healthcare.toLocaleString()"></span></span>
                            </div>
                            <div class="expense-item">
                                <span class="bil-inline">
                                    <span class="en">Other Costs:</span>
                                    <span class="ar">تكاليف أخرى:</span>
                                </span>
                                <span>EGP <span x-text="financialDashboard.expenses.other.toLocaleString()"></span></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Profitability Analysis -->
                <div class="dashboard-card">
                    <h4 class="bil-spread">
                        <span class="en">💰 Profitability Analysis</span>
                        <span class="ar">💰 تحليل الربحية</span>
                    </h4>
                    <div class="metrics-grid">
                        <div class="metric-card" :class="financialDashboard.profitability.netProfit >= 0 ? 'success' : 'danger'">
                            <div class="metric-label bil-inline">
                                <span class="en">Net Profit</span>
                                <span class="ar">صافي الربح</span>
                            </div>
                            <div class="metric-value">
                                EGP <span x-text="Math.abs(financialDashboard.profitability.netProfit).toLocaleString()"></span>
                                <span x-show="financialDashboard.profitability.netProfit < 0">(Loss)</span>
                            </div>
                            <div class="metric-subtext">
                                <span x-text="financialDashboard.profitability.margin.toFixed(1)"></span>% margin
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label bil-inline">
                                <span class="en">ROI</span>
                                <span class="ar">العائد على الاستثمار</span>
                            </div>
                            <div class="metric-value"><span x-text="financialDashboard.profitability.roi.toFixed(1)"></span>%</div>
                        </div>
                    </div>
                </div>
                
                <!-- Inventory Value -->
                <div class="dashboard-card">
                    <h4 class="bil-spread">
                        <span class="en">📦 Inventory Value</span>
                        <span class="ar">📦 قيمة المخزون</span>
                    </h4>
                    <div class="metrics-grid">
                        <div class="metric-card info">
                            <div class="metric-label bil-inline">
                                <span class="en">Livestock Value</span>
                                <span class="ar">قيمة الماشية</span>
                            </div>
                            <div class="metric-value">EGP <span x-text="financialDashboard.inventory.livestock.toLocaleString()"></span></div>
                            <div class="metric-subtext bil-inline">
                                <span class="en"><span x-text="financialDashboard.inventory.sheepCount"></span> sheep</span>
                                <span class="ar"><span x-text="financialDashboard.inventory.sheepCount"></span> رأس</span>
                            </div>
                        </div>
                        <div class="metric-card info">
                            <div class="metric-label bil-inline">
                                <span class="en">Feed Inventory</span>
                                <span class="ar">مخزون العلف</span>
                            </div>
                            <div class="metric-value">EGP <span x-text="financialDashboard.inventory.feed.toLocaleString()"></span></div>
                        </div>
                    </div>
                </div>
                
                <!-- Projections vs Actuals -->
                <div class="dashboard-card">
                    <h4 class="bil-spread">
                        <span class="en">📊 Projections vs Actuals</span>
                        <span class="ar">📊 التوقعات مقابل الفعلي</span>
                    </h4>
                    <div class="projections-comparison">
                        <div class="comparison-row">
                            <span class="bil-inline">
                                <span class="en">Projected Revenue:</span>
                                <span class="ar">الإيرادات المتوقعة:</span>
                            </span>
                            <span>EGP <span x-text="financialDashboard.projections.projectedRevenue.toLocaleString()"></span></span>
                        </div>
                        <div class="comparison-row">
                            <span class="bil-inline">
                                <span class="en">Actual Revenue:</span>
                                <span class="ar">الإيرادات الفعلية:</span>
                            </span>
                            <span>EGP <span x-text="financialDashboard.revenue.total.toLocaleString()"></span></span>
                        </div>
                        <div class="comparison-row">
                            <span class="bil-inline">
                                <span class="en">Variance:</span>
                                <span class="ar">الفرق:</span>
                            </span>
                            <span :class="financialDashboard.projections.revenueVariance >= 0 ? 'text-success' : 'text-danger'">
                                <span x-text="financialDashboard.projections.revenueVariance >= 0 ? '+' : ''"></span>
                                <span x-text="financialDashboard.projections.revenueVariance.toFixed(1)"></span>%
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Real-Time Sync Status -->
                <div class="sync-status-card">
                    <div class="sync-header bil-spread">
                        <span class="en">🔄 Real-Time Sync Status</span>
                        <span class="ar">🔄 حالة المزامنة الفورية</span>
                    </div>
                    <div class="sync-info">
                        <span class="bil-inline">
                            <span class="en">Last sync:</span>
                            <span class="ar">آخر مزامنة:</span>
                        </span>
                        <span x-text="lastSyncTime ? new Date(lastSyncTime).toLocaleTimeString() : 'Never'"></span>
                    </div>
                    <div class="sync-info" x-show="syncInterval">
                        <span class="bil-inline">
                            <span class="en">Status: ✅ Active (syncing every 5 minutes)</span>
                            <span class="ar">الحالة: ✅ نشط (مزامنة كل 5 دقائق)</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
</div>

<!-- Add/Edit Sheep Form Modal -->
<div x-show="showAddSheepForm" class="modal-overlay" @click="showAddSheepForm = false"></div>
<div x-show="showAddSheepForm" class="modal" role="dialog" aria-modal="true" aria-labelledby="add-sheep-modal-title" @keydown.escape.window="showAddSheepForm = false" x-cloak>
        <div class="modal-header">
            <h2 id="add-sheep-modal-title" class="bil-spread modal-title">
                <span class="en" x-text="editingSheepId ? 'Edit Sheep' : 'Add New Sheep'"></span>
                <span class="ar" x-text="editingSheepId ? 'تعديل البيانات' : 'إضافة رأس جديد'"></span>
            </h2>
            <button @click="showAddSheepForm = false" class="modal-close-btn">×</button>
        </div>
        <form @submit.prevent="saveFarmSheep()" class="modal-content">
            <div class="form-group">
                <label class="bil-spread">
                    <span class="en">Tag ID</span>
                    <span class="ar">رقم العلامة</span>
                </label>
                <input type="text" x-model="sheepForm.tagId" required class="form-input">
            </div>
            
            <div class="form-group">
                <label class="bil-spread">
                    <span class="en">Breed</span>
                    <span class="ar">السلالة</span>
                </label>
                <select x-model="sheepForm.breed" required class="form-input">
                    <option value="">Select Breed</option>
                    <option value="Barki">Barki / برقي</option>
                    <option value="Rahmani">Rahmani / رحماني</option>
                    <option value="Ossimi">Ossimi / أوسيمي</option>
                    <option value="Saidi">Saidi / صعيدي</option>
                </select>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label class="bil-spread">
                        <span class="en">Age (months)</span>
                        <span class="ar">العمر (شهور)</span>
                    </label>
                    <input type="number" x-model="sheepForm.age" min="0" required class="form-input">
                </div>
                
                <div class="form-group">
                    <label class="bil-spread">
                        <span class="en">Weight (kg)</span>
                        <span class="ar">الوزن (كجم)</span>
                    </label>
                    <input type="number" x-model="sheepForm.weight" min="0" step="0.1" required class="form-input">
                </div>
            </div>
            
            <div class="form-group">
                <label class="bil-spread">
                    <span class="en">Status</span>
                    <span class="ar">الحالة</span>
                </label>
                <select x-model="sheepForm.status" required class="form-input">
                    <option value="healthy">Healthy / بصحة جيدة</option>
                    <option value="sick">Sick / مريض</option>
                    <option value="pregnant">Pregnant / حامل</option>
                    <option value="nursing">Nursing / مرضع</option>
                </select>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label class="bil-spread">
                        <span class="en">Gender</span>
                        <span class="ar">الجنس</span>
                    </label>
                    <select x-model="sheepForm.gender" required class="form-input">
                        <option value="female">Female / أنثى</option>
                        <option value="male">Male / ذكر</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="bil-spread">
                        <span class="en">Location</span>
                        <span class="ar">الموقع</span>
                    </label>
                    <select x-model="sheepForm.location" class="form-input">
                        <option value="barn1">Barn 1 / الحظيرة 1</option>
                        <option value="barn2">Barn 2 / الحظيرة 2</option>
                        <option value="field">Field / الحقل</option>
                        <option value="quarantine">Quarantine / الحجر الصحي</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group">
                <label class="bil-spread">
                    <span class="en">Last Vaccination Date</span>
                    <span class="ar">تاريخ آخر تطعيم</span>
                </label>
                <input type="date" x-model="sheepForm.lastVaccination" class="form-input">
            </div>
            
            <div class="form-group">
                <label class="bil-spread">
                    <span class="en">Notes</span>
                    <span class="ar">ملاحظات</span>
                </label>
                <textarea x-model="sheepForm.notes" rows="3" class="form-input"></textarea>
            </div>
            
            <div class="form-actions">
                <button type="button" @click="showAddSheepForm = false" class="btn bp-alt bil-inline">
                    <span class="en">Cancel</span>
                    <span class="ar">إلغاء</span>
                </button>
                <button type="submit" class="btn bp bil-inline">
                    <span class="en" x-text="editingSheepId ? 'Update' : 'Add'"></span>
                    <span class="ar" x-text="editingSheepId ? 'تحديث' : 'إضافة'"></span>
                </button>
            </div>
        </form>
</div>

<footer class="foot main-page-sec">
    <div class="c">
        <div class="foot-grid">
            <div class="bil-row foot-brand-desc">
                <p class="en">Premium lamb specialists. Live sheep, fresh lamb cuts, and sacrifice services in Egypt. Farm-to-table quality.</p>
                <p class="ar">متخصصون في لحوم الضأن الفاخرة. أغنام حية وقطعيات لحم ضأن وخدمات ذبائح في مصر. جودة من المزرعة للمائدة.</p>
            </div>
        </div>
        <div class="foot-payments">
            <p class="foot-payments-title bil-inline">
                <span class="en">We Accept</span>
                <span class="ar">نقبل</span>
            </p>
            <div class="foot-payment-logos">
                <template x-for="method in availPayMeths" :key="method.id">
                    <div class="foot-pay-logo-wrapper">
                        <img :src="'/images/' + method.imgSrc" :alt="method.title" class="foot-pay-icon">
                    </div>
                </template>
            </div>
        </div>
        <hr class="foot-div">
        <p class="foot-copy">© <span x-text="new Date().getFullYear()"></span> Sheep Land أرض الأغنام | <button @click.prevent="openRefundModal()" class="footer-link-btn bil-inline"><span class="en">Refund Policy</span><span class="ar">سياسة الاسترداد</span></button>
        </p>
    </div>
</footer>

<!-- Preload critical resources -->
<link rel="preload" href="vendor/alpine.min.js" as="script">
<link rel="preload" href="app.js" as="script">

<!-- Load scripts with proper defer/async -->
<script src="vendor/pocketbase.umd.js" defer></script>
<script src="app.js" defer></script>
<script src="wishlist.js" defer></script>
<script src="feedback-safe.js" defer></script>
<script src="vendor/alpine-collapse.min.js" defer></script>
<script src="vendor/alpine.min.js" defer></script>

<!-- Service Worker for PWA -->
<script>
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(() => {});
    });
}
</script>

</body>
</html>
