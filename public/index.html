<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Egypt's premier destination for premium sheep, livesheep, fresh meat, and Sharia-compliant Udheya services. Serving Egypt and international customers with quality guaranteed.">
    <title x-text="pageTitle()">Sheep Land</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Kufi+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.min.css">
    <style>[x-cloak]{display:none!important}</style>
</head>
<body x-data="sheepLand" x-init="initApp()" x-cloak>

<div x-show="load.init && !apiErr" class="load-ind" aria-live="polite">Loading Sheep Land...</div>
<div x-show="apiErr" class="err-ind" x-text="usrApiErr || 'Service temporarily unavailable. Please try again.'" role="alert" aria-live="assertive" tabindex="-1"></div>

<div x-show="isCartOpen" class="cart-sidebar-overlay" @click="closeCart()" x-transition:enter="transition-opacity ease-linear duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition-opacity ease-linear duration-300" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
<aside x-show="isCartOpen" class="cart-sidebar" x-transition:enter="transition ease-in-out duration-300 transform" x-transition:enter-start="translate-x-full" x-transition:enter-end="translate-x-0" x-transition:leave="transition ease-in-out duration-300 transform" x-transition:leave-start="translate-x-0" x-transition:leave-end="translate-x-full" role="dialog" aria-modal="true" aria-labelledby="cart-sidebar-title" @keydown.escape.window="closeCart()">
    <div class="cart-sidebar-header">
        <h2 id="cart-sidebar-title" class="bil-spread modal-title">
            <span class="en">Your Cart</span><span class="ar">سلتك</span>
        </h2>
        <button @click="closeCart()" class="modal-close-btn" aria-label="Close cart">×</button>
    </div>
    <div class="cart-sidebar-content">
        <div x-show="cartItems.length === 0" class="tc cart-empty-msg">
            <p class="bil-row"><span class="en">Your cart is currently empty.</span><span class="ar">سلتك فارغة حاليًا.</span></p>
            <button @click="closeCart(); navigateToOrScroll('udheya')" class="btn bp btn-sm bil-inline">
                <span class="en">Start Shopping</span><span class="ar">ابدأ التسوق</span>
            </button>
        </div>
        <div x-show="cartItems.length > 0">
            <template x-for="(cartItem) in cartItems" :key="cartItem.uniqueIdInCart">
                <div class="cart-item">
                    <div class="cart-item-details">
                        <div class="cart-item-name bil-spread">
                            <span class="en" x-text="cartItem.nameENSpec"></span>
                            <span class="ar" x-text="cartItem.nameARSpec"></span>
                        </div>
                        <template x-if="cartItem.product_category === 'udheya' && cartItem.udheya_details">
                            <div class="udheya-detail bil-spread">
                                <span class="en"><small>Service: <span x-text="cartItem.udheya_details.serviceOption === 'standard_service' ? 'Standard' : 'Live Animal'"></span></small></span>
                                <span class="ar"><small>الخدمة: <span x-text="cartItem.udheya_details.serviceOption === 'standard_service' ? 'عادية' : 'حيوان حي'"></span></small></span>
                            </div>
                        </template>
                        <div class="cart-item-price">
                            <span x-text="fmtPrice(cartItem.priceEGP) + ' each'"></span>
                        </div>
                    </div>
                    
                    <div class="cart-item-controls">
                        <div class="cart-item-quantity">
                            <button type="button" @click="cartItem.quantity === 1 ? removeFromCart(cartItem.uniqueIdInCart) : updateCartQuantity(cartItem.uniqueIdInCart, cartItem.quantity - 1)" class="btn btn-sm qty-btn">-</button>
                            <span class="cart-qty-display" x-text="cartItem.quantity"></span>
                            <button type="button" @click="updateCartQuantity(cartItem.uniqueIdInCart, cartItem.quantity + 1)" class="btn btn-sm qty-btn" :disabled="cartItem.quantity >= cartItem.stock || (cartItem.product_category === 'udheya' && cartItem.quantity >=1 )">+</button>
                        </div>
                        <div class="cart-item-subtotal" x-text="fmtPrice(getSubtotalForItem(cartItem))"></div>
                    </div>
                </div>
            </template>
        </div>
    </div>
    <div class="cart-sidebar-footer" x-show="cartItems.length > 0">
        <div class="cart-total">
            <span><strong>Total:</strong> <span x-text="fmtPrice(calculateCartTotal())"></span></span>
        </div>
        <button type="button" @click="closeCart(); navigateToOrScroll('checkout')" class="btn bac btn-lg btn-block bil-inline">
            <span class="en">Proceed to Checkout</span><span class="ar">المتابعة للدفع</span>
        </button>
    </div>
</aside>

<div x-show="isRefundModalOpen" class="modal-overlay" @click="closeRefundModal()"></div>
<div x-show="isRefundModalOpen" class="modal" role="dialog" aria-modal="true" aria-labelledby="refund-modal-title" @keydown.escape.window="closeRefundModal()">
    <div class="modal-header">
        <h2 id="refund-modal-title" class="bil-spread modal-title">
            <span class="en">Refund & Cancellation Policy</span><span class="ar" dir="rtl">سياسة الاسترداد والإلغاء</span>
        </h2>
        <button @click="closeRefundModal()" class="modal-close-btn">×</button>
    </div>
    <div class="modal-content policy-container">
         <div x-html="settings.refundPolicyHTMLContent || '<p>Loading refund policy...</p>'"></div>
    </div>
    <div class="modal-footer">
        <button @click="closeRefundModal()" class="btn bp">Close</button>
    </div>
</div>

<div x-show="isOrderStatusModalOpen" class="modal-overlay" @click="closeOrderStatusModal()"></div>
<div x-show="isOrderStatusModalOpen" class="modal" role="dialog" aria-modal="true" aria-labelledby="order-status-modal-title" @keydown.escape.window="closeOrderStatusModal()">
    <div class="modal-header">
        <h2 id="order-status-modal-title" class="bil-spread modal-title">
            <span class="en">Check Order Status</span><span class="ar">تحقق من حالة الطلب</span>
        </h2>
        <button @click="closeOrderStatusModal()" class="modal-close-btn">×</button>
    </div>
    <div class="modal-content">
        <form @submit.prevent="submitStatValid()" novalidate>
            <div class="fg">
                <label for="order_id_lookup_modal" class="bil-spread lbl-req"><span class="en">Enter Order ID *</span><span class="ar">أدخل رقم الطلب *</span></label>
                <input type="text" id="order_id_lookup_modal" class="input" x-model="lookupOrderID" placeholder="e.g., A1B2C3D4E5" x-ref="lookupOrderIdInputModal" @input="clrErr('lookupOrderID')">
                <div class="err-msg" x-show="errs.lookupOrderID" x-text="errs.lookupOrderID ? (currLang === 'ar' ? errs.lookupOrderID.ar : errs.lookupOrderID.en) : ''"></div>
            </div>
            <div class="card-act">
                <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.status">
                    <span x-show="!load.status"><span class="en">Check Status</span><span class="ar">تحقق من الحالة</span></span>
                    <span x-show="load.status"><span class="en">Checking...</span><span class="ar">جاري...</span></span>
                </button>
            </div>
        </form>
        <div class="order-stat-res" x-show="load.status || statRes || statNotFound">
            <div x-show="load.status && !statRes && !statNotFound" class="load-text tc">Checking...</div>
            <div x-show="statRes && !load.status">
                <h4 class="form-subh bil-spread"><span class="en">Order Details</span><span class="ar">تفاصيل الطلب</span></h4>
                <div class="sum-item bil-row"><div class="en"><strong>ID:</strong> <span x-text="statRes?.orderIdTxt || ''"></span></div><div class="ar"><strong>رقم الطلب:</strong> <span x-text="statRes?.orderIdTxt || ''"></span></div></div>
                <div class="sum-item bil-row"><div class="en"><strong>Status:</strong> <span class="stat-hl" x-text="statRes?.order_status || ''"></span></div><div class="ar"><strong>حالة الطلب:</strong> <span class="stat-hl" x-text="statRes?.order_status || ''"></span></div></div>
                <div class="sum-item"><div><strong>Total:</strong> <span x-text="fmtPrice(statRes?.total_amount_due_egp)"></span></div></div>
            </div>
            <div class="stat-no-res bil-row tc" x-show="statNotFound && !statRes && !load.status"><p class="en">No order found. Check ID or contact support.</p><p class="ar">لم يتم العثور على طلب. تحقق من رقم الطلب أو اتصل بالدعم.</p></div>
        </div>
    </div>
    <div class="modal-footer">
        <button @click="closeOrderStatusModal()" class="btn bp">Close</button>
    </div>
</div>

<div x-show="isUdheyaConfigModalOpen" class="modal-overlay" @click="closeUdheyaConfiguration()"></div>
<div x-show="isUdheyaConfigModalOpen" class="modal udheya-config-modal" role="dialog" aria-modal="true" @keydown.escape.window="closeUdheyaConfiguration()">
    <div class="modal-header">
        <h2 class="bil-spread modal-title">
            <span class="en">Configure Your Udheya</span><span class="ar" dir="rtl">تخصيص الأضحية</span>
        </h2>
        <button @click="closeUdheyaConfiguration()" class="modal-close-btn">×</button>
    </div>
    <div class="modal-content">
        <div x-show="configuringUdheyaItem">
            <h3 class="bil-spread modal-section-title"><span x-text="configuringUdheyaItem?.nameENSpec"></span><span x-text="configuringUdheyaItem?.nameARSpec"></span></h3>
            <div class="fg">
                <label class="bil-spread lbl-req"><span class="en">Service Option *</span><span class="ar">خيار الخدمة *</span></label>
                <div class="rgrp">
                    <label><input type="radio" name="service_option_udh_conf" value="standard_service" x-model="tempUdheyaConfig.serviceOption" @change="clrErr('udheya_service_config')"><span>Standard Service - <strong x-text="fmtPrice(settings.servFeeEGP)"></strong></span></label>
                    <label class="bil-spread"><input type="radio" name="service_option_udh_conf" value="live_animal_delivery" x-model="tempUdheyaConfig.serviceOption" @change="clrErr('udheya_service_config')"><span class="en">Live Animal Delivery</span><span class="ar">توصيل حيوان حي</span></label>
                </div>
                <div class="err-msg" x-show="errs.udheya_service_config" x-text="getUdheyaConfigErrorText()"></div>
            </div>
            <div class="fg" x-show="tempUdheyaConfig.serviceOption === 'standard_service'">
                <label class="bil-spread lbl-req"><span class="en">Sacrifice Day *</span><span class="ar">يوم الذبح *</span></label>
                <select class="input" x-model="tempUdheyaConfig.sacrificeDay" @change="clrErr('udheya_sacrifice_day_config')">
                    <option value="">-- Select Day --</option>
                    <template x-for="(dayInfo, dayValue) in sacrificeDayMapInternal" :key="dayValue">
                        <option :value="dayValue"><span x-text="dayInfo.en + ' / ' + dayInfo.ar"></span></option>
                    </template>
                </select>
            </div>
            <div class="fg">
                <label class="bil-spread lbl-req"><span class="en">Distribution Choice *</span><span class="ar">خيار التوزيع *</span></label>
                <div class="rgrp">
                    <template x-for="opt in distrOpts()" :key="opt.val">
                        <label class="bil-spread"><input type="radio" name="distribution_choice_udh_conf" :value="opt.val" x-model="tempUdheyaConfig.distribution.choice" @change="clrErr('udheya_distribution_choice_config')"><span x-text="opt.txtEn"></span><span x-text="opt.txtAr"></span></label>
                    </template>
                </div>
                <div x-show="tempUdheyaConfig.distribution.choice === 'split'">
                    <template x-for="opt in splitOptsList()" :key="opt.val">
                         <label class="bil-spread"><input type="radio" name="split_option_udh_conf" :value="opt.val" x-model="tempUdheyaConfig.distribution.splitOption"><span x-text="opt.txtEn"></span><span x-text="opt.txtAr"></span></label>
                    </template>
                    <textarea x-show="tempUdheyaConfig.distribution.splitOption === 'custom'" class="input" rows="2" x-model="tempUdheyaConfig.distribution.customSplitText" placeholder="Specify custom distribution"></textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" @click="closeUdheyaConfiguration()" class="btn bp-alt"><span class="en">Cancel</span><span class="ar">إلغاء</span></button>
        <button type="button" @click="confirmUdheyaConfigurationAndProceed()" class="btn bac">
            <span x-text="tempUdheyaConfig.isBuyNowIntent ? 'Confirm & Buy Now' : 'Confirm & Add to Cart'"></span>
        </button>
    </div>
</div>

<header class="site-head">
    <div class="c nav-cont">
        <a href="#home" class="logo bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('home')">
            <span class="en" x-text="settings.site_title_en || 'Sheep Land Egypt'"></span>
            <span class="ar" x-text="settings.site_title_ar || 'أرض الأغنام مصر'"></span>
        </a>

        <nav class="nav-main nav-desk">
            <ul class="nav-list">
                <template x-if="settings.enable_udheya_section">
                    <li><a href="#udheya" class="nav-link nav-bil-inline" :class="{'active-nav': currentPage === 'udheya'}" @click.prevent="navigateToOrScroll('udheya')"><span class="en">Udheya</span><span class="ar">الأضحية</span></a></li>
                </template>
                <template x-if="settings.enable_livesheep_section">
                    <li><a href="#livesheep" class="nav-link nav-bil-inline" :class="{'active-nav': currentPage === 'livesheep'}" @click.prevent="navigateToOrScroll('livesheep')"><span class="en">Live Sheep</span><span class="ar">الأغنام الحية</span></a></li>
                </template>
                <template x-if="settings.enable_meat_section">
                    <li><a href="#meat" class="nav-link nav-bil-inline" :class="{'active-nav': currentPage === 'meat'}" @click.prevent="navigateToOrScroll('meat')"><span class="en">Fresh Meat</span><span class="ar">اللحوم الطازجة</span></a></li>
                </template>
                <template x-if="settings.enable_gatherings_section">
                    <li><a href="#gatherings" class="nav-link nav-bil-inline" :class="{'active-nav': currentPage === 'gatherings'}" @click.prevent="navigateToOrScroll('gatherings')"><span class="en">Gatherings</span><span class="ar">الولائم</span></a></li>
                </template>
                <template x-if="currentUser">
                    <li><a href="#account" class="nav-link nav-bil-inline" :class="{'active-nav': currentPage === 'account'}" @click.prevent="navigateToOrScroll('account')"><span class="en">My Account</span><span class="ar">حسابي</span></a></li>
                    <li><button @click="logoutUser()" class="nav-link nav-bil-inline as-button"><span class="en">Logout</span><span class="ar">خروج</span></button></li>
                </template>
            </ul>
        </nav>

        <div class="head-extras desk-extras">
            <div class="curr-sel">
                <select x-model="curr" title="Currency">
                    <template x-for="code in Object.keys(settings.xchgRates)" :key="code">
                        <option :value="code" :disabled="!settings.xchgRates[code].is_active" x-text="code + ' (' + (settings.xchgRates[code].symbol || code) + ')'">
                        </option>
                    </template>
                </select>
            </div>
            <button @click="toggleSearch()" class="header-action-btn" title="Search">🔍</button>
            <button @click="openOrderStatusModal()" class="header-action-btn" title="Order Status">📋</button>
            <template x-if="!currentUser">
                <button @click="navigateToOrScroll('auth')" class="header-action-btn" title="Login">👤</button>
            </template>
            <template x-if="currentUser">
                <button @click="navigateToOrScroll('account')" class="header-action-btn" title="My Account">👤</button>
            </template>
            <button @click="openCart()" class="header-action-btn" title="Shopping Cart">
                🛒<span x-show="cartItems.length > 0" class="cart-count-badge" x-text="cartItemCount"></span>
            </button>
            <div class="wa-contact">
                <a :href="'https://wa.me/' + settings.waNumRaw" target="_blank" rel="noopener noreferrer" title="WhatsApp Contact">
                    📱 <span x-text="settings.waNumDisp"></span>
                </a>
            </div>
        </div>

        <div class="head-extras mob-extras">
            <button @click="toggleSearch()" class="header-action-btn" title="Search">🔍</button>
            <button @click="openOrderStatusModal()" class="header-action-btn" title="Order Status">📋</button>
            <template x-if="!currentUser">
                <button @click="navigateToOrScroll('auth')" class="header-action-btn" title="Login">👤</button>
            </template>
            <template x-if="currentUser">
                <button @click="navigateToOrScroll('account')" class="header-action-btn" title="My Account">👤</button>
            </template>
            <button @click="openCart()" class="header-action-btn" title="Shopping Cart">
                🛒<span x-show="cartItems.length > 0" class="cart-count-badge" x-text="cartItemCount"></span>
            </button>
            <button class="menu-btn" @click="isMobNavOpen = !isMobNavOpen" title="Menu">☰</button>
        </div>
    </div>

    <div class="mob-nav" x-show="isMobNavOpen" x-transition @click.outside="isMobNavOpen = false">
        <nav>
            <ul class="nav-list-mob">
                <template x-if="settings.enable_udheya_section">
                    <li><a href="#udheya" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('udheya')"><span class="en">Udheya</span><span class="ar">الأضحية</span></a></li>
                </template>
                <template x-if="settings.enable_livesheep_section">
                    <li><a href="#livesheep" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('livesheep')"><span class="en">Live Sheep</span><span class="ar">الأغنام الحية</span></a></li>
                </template>
                <template x-if="settings.enable_meat_section">
                    <li><a href="#meat" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('meat')"><span class="en">Fresh Meat</span><span class="ar">اللحوم الطازجة</span></a></li>
                </template>
                <template x-if="settings.enable_gatherings_section">
                    <li><a href="#gatherings" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('gatherings')"><span class="en">Gatherings</span><span class="ar">الولائم</span></a></li>
                </template>
                <template x-if="currentUser">
                    <li><a href="#account" class="nav-link-mob nav-bil-inline" @click.prevent="isMobNavOpen = false; navigateToOrScroll('account')"><span class="en">My Account</span><span class="ar">حسابي</span></a></li>
                    <li><button @click="logoutUser(); isMobNavOpen = false;" class="nav-link-mob nav-bil-inline as-button"><span class="en">Logout</span><span class="ar">خروج</span></button></li>
                </template>
            </ul>
            
            
            <div class="wa-contact-mob">
                <a :href="'https://wa.me/' + settings.waNumRaw" target="_blank" rel="noopener noreferrer">
                    📱 <span x-text="settings.waNumDisp"></span>
                </a>
            </div>
        </nav>
    </div>
</header>

<!-- Search Dropdown -->
<div class="search-dropdown" x-show="showSearch" x-transition @click.outside="showSearch = false">
    <div class="c">
        <div class="search-dropdown-content">
            <input 
                type="text" 
                id="searchBar"
                class="search-input-header" 
                x-model="searchQuery"
                @input="filterProducts()"
                :placeholder="currLang === 'en' ? 'Search products...' : 'ابحث عن المنتجات...'"
                x-ref="searchInput"
                @keydown.escape="showSearch = false"
            >
            <div class="search-results" x-show="searchQuery.length > 1">
                <template x-for="category in Object.keys(filteredProducts)" :key="category">
                    <template x-if="filteredProducts[category] && filteredProducts[category].length > 0">
                        <div class="search-category">
                            <h4 class="bil-inline">
                                <span class="en" x-text="getCategoryDisplayName(category).en"></span>
                                <span class="ar" x-text="getCategoryDisplayName(category).ar"></span>
                            </h4>
                            <template x-for="product in filteredProducts[category]" :key="product.itemKey">
                                <div class="search-result-item" @click="navigateToOrScroll(category); showSearch = false; searchQuery = ''">
                                    <div class="bil-spread">
                                        <span class="en" x-text="product.nameENSpec"></span>
                                        <span class="ar" x-text="product.nameARSpec"></span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </template>
                </template>
                <div x-show="Object.keys(filteredProducts).length === 0 && searchQuery.length > 1" class="empty-state tc">
                    <p class="bil-row">
                        <span class="en">No products found</span>
                        <span class="ar">لم يتم العثور على منتجات</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<main>
    <!-- Business Stats Bar - Hidden by default -->
    <template x-if="false">
        <div class="business-stats-bar" x-data="businessStats()">
            <div class="c">
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" x-text="todayOrders">0</div>
                        <div class="stat-label bil-inline"><span class="en">Orders Today</span><span class="ar">طلبات اليوم</span></div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" x-text="fmtPrice(todayRevenue)">0</div>
                        <div class="stat-label bil-inline"><span class="en">Today's Revenue</span><span class="ar">إيرادات اليوم</span></div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" x-text="activeCustomers">0</div>
                        <div class="stat-label bil-inline"><span class="en">Active Customers</span><span class="ar">عملاء نشطون</span></div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" x-text="popularItem">-</div>
                        <div class="stat-label bil-inline"><span class="en">Top Product</span><span class="ar">المنتج الأكثر مبيعاً</span></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <section class="hero main-page-sec" x-show="currentPage === 'home'" x-transition>
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="c">
                <h1 class="hero-title bil-spread">
                    <span class="en">Premium Halal Meat & Live Sheep</span>
                    <span class="ar">لحوم حلال وأغنام فاخرة</span>
                </h1>
                <div class="hero-subtitle bil-row">
                    <p class="en">From farm-fresh cuts to live animals, Udheya services, and event catering - we deliver authentic quality for your family's needs</p>
                    <p class="ar">من القطعيات الطازجة إلى الحيوانات الحية وخدمات الأضاحي وتجهيز المناسبات - نقدم الجودة الأصيلة لاحتياجات عائلتك</p>
                </div>
                <div class="hero-collections">
                    <h2 class="hero-collections-title bil-spread">
                        <span class="en">Our Premium Collections</span>
                        <span class="ar">مجموعاتنا المميزة</span>
                    </h2>
                    <div class="hero-collections-grid">
                        <div class="hero-collection-card" @click="navigateToOrScroll('udheya')">
                            <div class="collection-icon">🐑</div>
                            <h3 class="bil-inline">
                                <span class="en">Udheya & Qurbani</span>
                                <span class="ar">الأضحية والقرباني</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Complete religious sacrifice with certified halal processing</span>
                                <span class="ar">أضحية كاملة مع ذبح حلال معتمد</span>
                            </p>
                        </div>
                        <div class="hero-collection-card" @click="navigateToOrScroll('meat')">
                            <div class="collection-icon">🥩</div>
                            <h3 class="bil-inline">
                                <span class="en">Fresh Meat & Cuts</span>
                                <span class="ar">اللحوم والقطعيات</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Premium quality cuts delivered fresh daily to your door</span>
                                <span class="ar">قطعيات فاخرة توصل طازجة يومياً لبابك</span>
                            </p>
                        </div>
                        <div class="hero-collection-card" @click="navigateToOrScroll('livesheep')">
                            <div class="collection-icon">🐏</div>
                            <h3 class="bil-inline">
                                <span class="en">Live Sheep & Rams</span>
                                <span class="ar">الأغنام والكباش</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Healthy animals for breeding, fattening or home slaughter</span>
                                <span class="ar">حيوانات صحية للتربية أو التسمين أو الذبح المنزلي</span>
                            </p>
                        </div>
                        <div class="hero-collection-card" @click="navigateToOrScroll('gatherings')">
                            <div class="collection-icon">🎉</div>
                            <h3 class="bil-inline">
                                <span class="en">Events & Gatherings</span>
                                <span class="ar">المناسبات والولائم</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Complete catering solutions for weddings and celebrations</span>
                                <span class="ar">حلول متكاملة للولائم والأفراح والمناسبات</span>
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Promotional Banner -->
                <template x-if="settings.promoActive && !cd.ended">
                    <div class="hero-promo-banner">
                        <div class="promo-content">
                            <h3 class="promo-title bil-row">
                                <span class="en" x-html="`🎉 Limited Time: <strong>${settings.promoDiscPc}% OFF</strong> All Udheya!`"></span>
                                <span class="ar" x-html="`🎉 عرض محدود: <strong>خصم ${settings.promoDiscPc}%</strong> على جميع الأضاحي!`"></span>
                            </h3>
                            <div class="promo-countdown">
                                <div class="countdown-item">
                                    <span class="countdown-value" x-text="cd.days"></span>
                                    <span class="countdown-label bil-inline">
                                        <span class="en">Days</span>
                                        <span class="ar">يوم</span>
                                    </span>
                                </div>
                                <div class="countdown-item">
                                    <span class="countdown-value" x-text="cd.hours"></span>
                                    <span class="countdown-label bil-inline">
                                        <span class="en">Hours</span>
                                        <span class="ar">ساعة</span>
                                    </span>
                                </div>
                                <div class="countdown-item">
                                    <span class="countdown-value" x-text="cd.mins"></span>
                                    <span class="countdown-label bil-inline">
                                        <span class="en">Minutes</span>
                                        <span class="ar">دقيقة</span>
                                    </span>
                                </div>
                                <div class="countdown-item">
                                    <span class="countdown-value" x-text="cd.secs"></span>
                                    <span class="countdown-label bil-inline">
                                        <span class="en">Seconds</span>
                                        <span class="ar">ثانية</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </section>

    <!-- Trust Indicators Section -->
    <section class="trust-section main-page-sec" x-show="currentPage === 'home'" x-transition>
        <div class="c">
            <div class="trust-badges-modern">
                <div class="trust-badge-modern">
                    <div class="badge-icon-modern">🏅</div>
                    <div class="badge-content">
                        <h4 class="bil-inline">
                            <span class="en">Certified Quality</span>
                            <span class="ar">جودة معتمدة</span>
                        </h4>
                        <p class="bil-inline">
                            <span class="en">Government approved facilities</span>
                            <span class="ar">منشآت معتمدة حكومياً</span>
                        </p>
                    </div>
                </div>
                <div class="trust-badge-modern">
                    <div class="badge-icon-modern">🚚</div>
                    <div class="badge-content">
                        <h4 class="bil-inline">
                            <span class="en">Fast Delivery</span>
                            <span class="ar">توصيل سريع</span>
                        </h4>
                        <p class="bil-inline">
                            <span class="en">Same day across Cairo & Giza</span>
                            <span class="ar">نفس اليوم في القاهرة والجيزة</span>
                        </p>
                    </div>
                </div>
                <div class="trust-badge-modern">
                    <div class="badge-icon-modern">🔒</div>
                    <div class="badge-content">
                        <h4 class="bil-inline">
                            <span class="en">Secure Payment</span>
                            <span class="ar">دفع آمن</span>
                        </h4>
                        <p class="bil-inline">
                            <span class="en">Multiple trusted methods</span>
                            <span class="ar">طرق متعددة موثوقة</span>
                        </p>
                    </div>
                </div>
                <div class="trust-badge-modern">
                    <div class="badge-icon-modern">📞</div>
                    <div class="badge-content">
                        <h4 class="bil-inline">
                            <span class="en">24/7 Support</span>
                            <span class="ar">دعم 24/7</span>
                        </h4>
                        <p class="bil-inline">
                            <span class="en">Always here to help</span>
                            <span class="ar">دائماً هنا للمساعدة</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Why Choose Section -->
    <section class="why-choose-section main-page-sec" x-show="currentPage === 'home'" x-transition>
        <div class="why-choose-bg">
            <div class="c">
                <div class="section-header centered">
                    <h2 class="bil-spread">
                        <span class="en">Why Egypt Trusts Sheep.Land</span>
                        <span class="ar">لماذا تثق مصر في أرض الأغنام</span>
                    </h2>
                    <p class="bil-row section-subtitle">
                        <span class="en">Join thousands of satisfied customers who choose quality, trust, and tradition</span>
                        <span class="ar">انضم لآلاف العملاء الراضين الذين يختارون الجودة والثقة والتقاليد</span>
                    </p>
                </div>
                <div class="why-choose-grid">
                    <div class="why-choose-card featured">
                        <div class="card-icon-wrapper">
                            <div class="card-icon">🕌</div>
                        </div>
                        <div class="card-content">
                            <h3 class="bil-spread">
                                <span class="en">100% Sharia Compliant</span>
                                <span class="ar">متوافق مع الشريعة 100%</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Certified halal processes following strict Islamic guidelines with religious supervision</span>
                                <span class="ar">عمليات حلال معتمدة تتبع الإرشادات الإسلامية الصارمة تحت إشراف ديني</span>
                            </p>
                            <div class="card-feature">
                                <span class="bil-inline">
                                    <span class="en">✓ Religious supervision</span>
                                    <span class="ar">✓ إشراف ديني</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="why-choose-card">
                        <div class="card-icon-wrapper">
                            <div class="card-icon">🏆</div>
                        </div>
                        <div class="card-content">
                            <h3 class="bil-spread">
                                <span class="en">Premium Quality</span>
                                <span class="ar">جودة فائقة</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Hand-selected animals from trusted Egyptian farms with health guarantees</span>
                                <span class="ar">حيوانات مختارة بعناية من مزارع مصرية موثوقة مع ضمانات صحية</span>
                            </p>
                            <div class="card-feature">
                                <span class="bil-inline">
                                    <span class="en">✓ Health certified</span>
                                    <span class="ar">✓ معتمد صحياً</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="why-choose-card">
                        <div class="card-icon-wrapper">
                            <div class="card-icon">⚡</div>
                        </div>
                        <div class="card-content">
                            <h3 class="bil-spread">
                                <span class="en">Same Day Service</span>
                                <span class="ar">خدمة نفس اليوم</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Fast delivery across Cairo and Giza with temperature-controlled transport</span>
                                <span class="ar">توصيل سريع في القاهرة والجيزة مع نقل محكم الحرارة</span>
                            </p>
                            <div class="card-feature">
                                <span class="bil-inline">
                                    <span class="en">✓ Cold chain delivery</span>
                                    <span class="ar">✓ توصيل بالسلسلة الباردة</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="why-choose-card">
                        <div class="card-icon-wrapper">
                            <div class="card-icon">🛡️</div>
                        </div>
                        <div class="card-content">
                            <h3 class="bil-spread">
                                <span class="en">Trusted & Secure</span>
                                <span class="ar">موثوق وآمن</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Secure payments, money-back guarantee, and 24/7 customer support</span>
                                <span class="ar">مدفوعات آمنة وضمان استرداد الأموال ودعم عملاء 24/7</span>
                            </p>
                            <div class="card-feature">
                                <span class="bil-inline">
                                    <span class="en">✓ Money back guarantee</span>
                                    <span class="ar">✓ ضمان استرداد الأموال</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="why-choose-card">
                        <div class="card-icon-wrapper">
                            <div class="card-icon">🌱</div>
                        </div>
                        <div class="card-content">
                            <h3 class="bil-spread">
                                <span class="en">Farm to Table</span>
                                <span class="ar">من المزرعة للمائدة</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Direct from Egyptian farms with complete traceability and freshness</span>
                                <span class="ar">مباشرة من المزارع المصرية مع إمكانية تتبع كاملة وطزاجة</span>
                            </p>
                            <div class="card-feature">
                                <span class="bil-inline">
                                    <span class="en">✓ Full traceability</span>
                                    <span class="ar">✓ تتبع كامل</span>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="why-choose-card">
                        <div class="card-icon-wrapper">
                            <div class="card-icon">💰</div>
                        </div>
                        <div class="card-content">
                            <h3 class="bil-spread">
                                <span class="en">Best Value</span>
                                <span class="ar">أفضل قيمة</span>
                            </h3>
                            <p class="bil-row">
                                <span class="en">Competitive prices with flexible payment options including installments</span>
                                <span class="ar">أسعار تنافسية مع خيارات دفع مرنة بما في ذلك التقسيط</span>
                            </p>
                            <div class="card-feature">
                                <span class="bil-inline">
                                    <span class="en">✓ Flexible payments</span>
                                    <span class="ar">✓ مدفوعات مرنة</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Customer Testimonials -->
    <section class="testimonials-section main-page-sec" x-show="currentPage === 'home'" x-transition>
        <div class="c">
            <div class="section-header centered">
                <h2 class="bil-spread">
                    <span class="en">What Our Customers Say</span>
                    <span class="ar">ما يقوله عملاؤنا</span>
                </h2>
                <p class="bil-row section-subtitle">
                    <span class="en">Real stories from families across Egypt</span>
                    <span class="ar">قصص حقيقية من عائلات في جميع أنحاء مصر</span>
                </p>
            </div>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <p class="bil-row">
                            <span class="en">"Excellent service for our Eid celebration. The meat quality was outstanding and delivery was on time."</span>
                            <span class="ar">"خدمة ممتازة لاحتفال العيد. جودة اللحم كانت رائعة والتوصيل كان في الموعد."</span>
                        </p>
                        <div class="testimonial-author">
                            <div class="author-info">
                                <h4 class="bil-inline">
                                    <span class="en">Ahmed Hassan</span>
                                    <span class="ar">أحمد حسن</span>
                                </h4>
                                <p class="bil-inline">
                                    <span class="en">Cairo Customer</span>
                                    <span class="ar">عميل من القاهرة</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <p class="bil-row">
                            <span class="en">"Best Udheya service in Egypt. Professional, reliable, and follows all religious requirements perfectly."</span>
                            <span class="ar">"أفضل خدمة أضحية في مصر. محترفة وموثوقة وتتبع جميع المتطلبات الدينية بشكل مثالي."</span>
                        </p>
                        <div class="testimonial-author">
                            <div class="author-info">
                                <h4 class="bil-inline">
                                    <span class="en">Fatima Al-Masry</span>
                                    <span class="ar">فاطمة المصري</span>
                                </h4>
                                <p class="bil-inline">
                                    <span class="en">Alexandria Customer</span>
                                    <span class="ar">عميلة من الإسكندرية</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <p class="bil-row">
                            <span class="en">"Amazing quality and service. The live sheep we bought for breeding has been excellent. Highly recommended!"</span>
                            <span class="ar">"جودة وخدمة مذهلة. الغنم الحي الذي اشتريناه للتربية كان ممتازاً. أنصح به بشدة!"</span>
                        </p>
                        <div class="testimonial-author">
                            <div class="author-info">
                                <h4 class="bil-inline">
                                    <span class="en">Mohamed Abdel Rahman</span>
                                    <span class="ar">محمد عبد الرحمن</span>
                                </h4>
                                <p class="bil-inline">
                                    <span class="en">Giza Customer</span>
                                    <span class="ar">عميل من الجيزة</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    </section>

    <!-- Udheya Section -->
    <section id="udheya" class="main-page-sec sec" x-show="currentPage === 'udheya' && settings.enable_udheya_section" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" tabindex="-1">
                    <span class="en">Premium Udheya Collection</span>
                    <span class="ar">مجموعة الأضاحي الفاخرة</span>
                </h1>
            </div>
            <div x-show="prodOpts.udheya && prodOpts.udheya.length > 0" class="prod-grid grid2">
                <template x-for="productType in prodOpts.udheya" :key="productType.valKey">
                    <template x-for="item in productType.wps" :key="item.itemKey">
                        <div class="card card-live" :class="{'card-sel': item.is_premium}">
                            <div class="card-img">
                                <img src="https://placehold.co/400x300/E8D4B8/8B4513?text=Sheep" :alt="item.nameENSpec" loading="lazy">
                                <div class="badge udheya-badge">UDHEYA</div>
                            </div>
                            <div class="card-b">
                                <div class="card-content">
                                    <h3 class="card-h bil-spread">
                                        <span class="en" x-text="item.nameENSpec"></span>
                                        <span class="ar" x-text="item.nameARSpec"></span>
                                    </h3>
                                    <div class="bil-row card-p-row">
                                        <p class="en card-p" x-text="item.descEn || productType.descEn"></p>
                                        <p class="ar card-p" x-text="item.descAr || productType.descAr"></p>
                                    </div>
                                </div>
                                <div class="card-foot">
                                    <div class="price-line">
                                        <strong x-text="fmtPrice(item.priceEGP)"></strong>
                                        <span class="weight-info" x-show="item.wtRangeEn" x-text="item.wtRangeEn"></span>
                                    </div>
                                    <button type="button" @click="openUdheyaConfiguration(item)" 
                                            class="btn bp btn-lg btn-block" 
                                            :disabled="!item.isActive || item.stock <= 0">
                                        <span class="bil-inline">
                                            <span class="en">Configure & Order</span>
                                            <span class="ar">تكوين وطلب</span>
                                        </span>
                                    </button>
                                    <span class="stock-display" :class="{'out-of-stock': !item.isActive || item.stock <= 0, 'low-stock': item.stock > 0 && item.stock <= 5}">
                                        <span class="bil-inline">
                                            <span class="en" x-text="getStockDisplayInfo(item.stock, item.isActive, 'en')"></span>
                                            <span class="ar" x-text="getStockDisplayInfo(item.stock, item.isActive, 'ar')"></span>
                                        </span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </template>
                </template>
            </div>
            <div x-show="!prodOpts.udheya || prodOpts.udheya.length === 0" class="empty-state">
                <p class="bil-row">
                    <span class="en">No Udheya products available at the moment.</span>
                    <span class="ar">لا توجد منتجات أضحية متاحة حالياً.</span>
                </p>
            </div>
        </div>
    </section>

    <!-- Other Sections -->
    <template x-for="section in [
        {key: 'livesheep', name: {en: 'Live Sheep', ar: 'الأغنام الحية'}, products: prodOpts.livesheep_general, badge: 'LIVE'},
        {key: 'meat', name: {en: 'Fresh Meat & Cuts', ar: 'اللحوم الطازجة والقطعيات'}, products: prodOpts.meat_cuts, badge: 'FRESH'},
        {key: 'gatherings', name: {en: 'Event & Gathering Packages', ar: 'باقات المناسبات والولائم'}, products: prodOpts.gathering_package, badge: 'EVENT'}
    ]" :key="section.key">
        <section class="main-page-sec sec" x-show="currentPage === section.key && settings['enable_' + section.key + '_section']" x-transition>
            <div class="c">
                <div class="sec-head">
                    <h1 class="bil-spread" tabindex="-1">
                        <span class="en" x-text="section.name.en"></span><span class="ar" x-text="section.name.ar"></span>
                    </h1>
                </div>
                <div x-show="section.products && section.products.length > 0" class="prod-grid grid2">
                    <template x-for="productType in section.products" :key="productType.valKey">
                        <template x-for="item in productType.wps" :key="item.itemKey">
                            <div class="card card-live" :class="{'card-sel': item.is_premium}">
                                <div class="card-img">
                                    <img src="https://placehold.co/400x300/E8D4B8/8B4513?text=Product" :alt="item.nameENSpec" loading="lazy">
                                    <div class="badge" :class="{'udheya-badge': section.key === 'udheya', 'premium-badge': item.is_premium}" x-text="item.is_premium ? 'PREMIUM' : section.badge"></div>
                                </div>
                                <div class="card-b">
                                    <div class="card-content">
                                        <h3 class="card-h bil-spread">
                                            <span class="en" x-text="item.nameENSpec"></span>
                                            <span class="ar" x-text="item.nameARSpec"></span>
                                        </h3>
                                        <div class="bil-row card-p-row">
                                            <p class="en card-p" x-text="item.descEn || productType.descEn"></p>
                                            <p class="ar card-p" x-text="item.descAr || productType.descAr"></p>
                                        </div>
                                    </div>
                                    <div class="card-foot">
                                        <template x-if="section.key === 'meat'">
                                            <div>
                                                <div class="price-line-with-dropdown">
                                                    <select class="size-dropdown-inline" x-model="selectedMeatWeights[item.itemKey]" x-init="selectedMeatWeights[item.itemKey] = '1'">
                                                        <option value="1" selected>1 kg</option>
                                                        <option value="2">2 kg</option>
                                                        <option value="3">3 kg</option>
                                                        <option value="5">5 kg</option>
                                                        <option value="10">10 kg</option>
                                                    </select>
                                                    <div class="price-inline">
                                                        <strong x-text="fmtPrice(getMeatPrice(item))"></strong>
                                                    </div>
                                                </div>
                                                <button type="button" @click="addItemToCart(getMeatItemWithWeight(item, section.key))" class="btn bp btn-lg btn-block" :disabled="!item.isActive || item.stock <= 0">
                                                    <span class="bil-inline"><span class="en">Add to Cart</span><span class="ar">أضف للسلة</span></span>
                                                </button>
                                            </div>
                                        </template>
                                        <template x-if="section.key !== 'meat' && section.key !== 'udheya'">
                                            <div>
                                                <div class="price-line">
                                                    <strong x-text="fmtPrice(item.priceEGP)"></strong>
                                                    <span class="weight-info" x-show="item.wtRangeEn" x-text="item.wtRangeEn"></span>
                                                </div>
                                                <button type="button" @click="addItemToCart(item)" class="btn bp btn-lg btn-block" :disabled="!item.isActive || item.stock <= 0">
                                                    <span class="bil-inline"><span class="en">Add to Cart</span><span class="ar">أضف للسلة</span></span>
                                                </button>
                                            </div>
                                        </template>
                                        <span class="stock-display" :class="{'out-of-stock': !item.isActive || item.stock <= 0, 'low-stock': item.stock > 0 && item.stock <= 5}">
                                            <span class="bil-inline">
                                                <span class="en" x-text="getStockDisplayInfo(item.stock, item.isActive, 'en')"></span>
                                                <span class="ar" x-text="getStockDisplayInfo(item.stock, item.isActive, 'ar')"></span>
                                            </span>
                                        </span>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
                <div class="empty-state tc" x-show="(!section.products || section.products.length === 0) && !load.init">
                    <p class="bil-row">
                        <span class="en">Products are being updated. Please check back soon!</span>
                        <span class="ar">يتم تحديث المنتجات. يرجى المراجعة قريبًا!</span>
                    </p>
                    <button @click="navigateToOrScroll('home')" class="btn bp btn-sm bil-inline">
                        <span class="en">Back to Home</span><span class="ar">العودة للرئيسية</span>
                    </button>
                </div>
                <p class="succ-msg bil-row tc" x-show="addedToCartMsg.text && addedToCartMsg.pageContext === section.key && !addedToCartMsg.isError">
                    <span class="en" x-text="addedToCartMsg.text ? (addedToCartMsg.text.en || addedToCartMsg.text) : ''"></span>
                    <span class="ar" x-text="addedToCartMsg.text ? (addedToCartMsg.text.ar || addedToCartMsg.text) : ''"></span>
                </p>
                <p class="err-msg bil-row tc" x-show="addedToCartMsg.text && addedToCartMsg.pageContext === section.key && addedToCartMsg.isError">
                    <span class="en" x-text="addedToCartMsg.text ? (addedToCartMsg.text.en || addedToCartMsg.text) : ''"></span>
                    <span class="ar" x-text="addedToCartMsg.text ? (addedToCartMsg.text.ar || addedToCartMsg.text) : ''"></span>
                </p>
            </div>
        </section>
    </template>

    <section class="sec main-page-sec" x-show="currentPage === 'checkout'" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" x-ref="checkoutTitle" tabindex="-1">
                    <span class="en">Secure Checkout</span><span class="ar">إتمام الطلب الآمن</span>
                </h1>
            </div>
            <div x-show="cartItems.length === 0 && !orderConf.show" class="empty-state tc">
                <p class="bil-row"><span class="en">Your cart is empty. Please add items to proceed.</span><span class="ar">سلتك فارغة. يرجى إضافة منتجات للمتابعة.</span></p>
                <button @click="navigateToOrScroll('udheya')" class="btn bp">
                    <span class="bil-inline"><span class="en">Continue Shopping</span><span class="ar">متابعة التسوق</span></span>
                </button>
            </div>
            
            <div x-show="cartItems.length > 0 && !orderConf.show" class="checkout-layout">
                <div class="checkout-form-col">
                    <form @submit.prevent="processOrder()" novalidate>
                        <div class="card form-panel">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Contact Information</span><span class="ar">معلومات الاتصال</span></h2>
                                
                                <!-- Guest Checkout Notice -->
                                <div class="guest-checkout-notice" x-show="!currentUser">
                                    <div class="bil-row">
                                        <p class="en">👤 Checking out as guest - No account required!</p>
                                        <p class="ar">👤 الدفع كضيف - لا حاجة لحساب!</p>
                                    </div>
                                    <p class="notice-small bil-row">
                                        <span class="en">Want to track orders easily? <a href="#auth" class="link-style">Create an account</a></span>
                                        <span class="ar">تريد تتبع الطلبات بسهولة؟ <a href="#auth" class="link-style">أنشئ حساب</a></span>
                                    </p>
                                </div>
                                
                                <!-- Logged In Notice -->
                                <div class="logged-in-notice" x-show="currentUser">
                                    <p class="bil-inline">
                                        <span class="en">✅ Logged in as <strong x-text="currentUser?.name || currentUser?.email"></strong></span>
                                        <span class="ar">✅ مسجل الدخول كـ <strong x-text="currentUser?.name || currentUser?.email"></strong></span>
                                    </p>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Full Name *</span><span class="ar">الاسم الكامل *</span></label>
                                    <input type="text" class="input" x-model="checkoutForm.customer_name" @input="clrErr('customer_name')">
                                    <div class="err-msg" x-show="errs.customer_name" x-text="errs.customer_name ? (currLang === 'ar' ? errs.customer_name.ar : errs.customer_name.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Phone Number *</span><span class="ar">رقم الهاتف *</span></label>
                                    <input type="tel" class="input" x-model="checkoutForm.customer_phone" @input="clrErr('customer_phone')">
                                    <div class="err-msg" x-show="errs.customer_phone" x-text="errs.customer_phone ? (currLang === 'ar' ? errs.customer_phone.ar : errs.customer_phone.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Email Address *</span><span class="ar">البريد الإلكتروني *</span></label>
                                    <input type="email" class="input" x-model="checkoutForm.customer_email" @input="clrErr('customer_email')">
                                    <div class="err-msg" x-show="errs.customer_email" x-text="errs.customer_email ? (currLang === 'ar' ? errs.customer_email.ar : errs.customer_email.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread"><span class="en">Country</span><span class="ar">البلد</span></label>
                                    <input type="text" class="input" x-model="checkoutForm.customer_country" placeholder="Egypt">
                                </div>
                            </div>
                        </div>

                        <div class="card form-panel" x-show="deliveryNeededForCart()">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Delivery Information</span><span class="ar">معلومات التوصيل</span></h2>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Delivery Area *</span><span class="ar">منطقة التوصيل *</span></label>
                                    <select class="input" x-model="checkoutForm.delivery_city_id" @change="updateDeliveryFeeForCheckout(); clrErr('delivery_city_id')">
                                        <option value="">-- Select Area --</option>
                                        <template x-for="city in allCities" :key="city.id">
                                            <option :value="city.id" x-text="city.nameEn + ' / ' + city.nameAr"></option>
                                        </template>
                                    </select>
                                    <div class="err-msg" x-show="errs.delivery_city_id" x-text="errs.delivery_city_id ? (currLang === 'ar' ? errs.delivery_city_id.ar : errs.delivery_city_id.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Full Address *</span><span class="ar">العنوان الكامل *</span></label>
                                    <textarea class="input" x-model="checkoutForm.delivery_address" @input="clrErr('delivery_address')" placeholder="Building, street, landmarks..."></textarea>
                                    <div class="err-msg" x-show="errs.delivery_address" x-text="errs.delivery_address ? (currLang === 'ar' ? errs.delivery_address.ar : errs.delivery_address.en) : ''"></div>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread"><span class="en">Delivery Instructions</span><span class="ar">تعليمات التوصيل</span></label>
                                    <textarea class="input" x-model="checkoutForm.delivery_instructions" placeholder="Special instructions for delivery..."></textarea>
                                </div>
                                <div class="fg">
                                    <label class="bil-spread lbl-req"><span class="en">Preferred Time *</span><span class="ar">الوقت المفضل *</span></label>
                                    <select class="input" x-model="checkoutForm.delivery_time_slot" @change="clrErr('delivery_time_slot')">
                                        <option value="">-- Select Time --</option>
                                        <template x-for="slot in deliveryTimeSlots" :key="slot.value">
                                            <option :value="slot.value" x-text="slot.label"></option>
                                        </template>
                                    </select>
                                    <div class="err-msg" x-show="errs.delivery_time_slot" x-text="errs.delivery_time_slot ? (currLang === 'ar' ? errs.delivery_time_slot.ar : errs.delivery_time_slot.en) : ''"></div>
                                </div>
                            </div>
                        </div>

                        <div class="card form-panel">
                            <div class="card-b">
                                <h2 class="form-subh bil-spread"><span class="en">Payment Method</span><span class="ar">طريقة الدفع</span></h2>
                                <div class="pay-meths">
                                    <template x-for="method in availPayMeths" :key="method.id">
                                        <div class="pm" :class="{'sel': checkoutForm.payment_method === method.id}">
                                            <input type="radio" :id="'pay_' + method.id" :value="method.id" x-model="checkoutForm.payment_method" @change="calculateFinalTotal(); clrErr('payment_method')">
                                            <label :for="'pay_' + method.id" :title="method.title">
                                                <img :src="'https://placehold.co/60x40/E8E8E8/666666?text=' + method.id.toUpperCase()" :alt="method.title" class="pay-icon">
                                            </label>
                                        </div>
                                    </template>
                                </div>
                                <div class="err-msg" x-show="errs.payment_method" x-text="errs.payment_method ? (currLang === 'ar' ? errs.payment_method.ar : errs.payment_method.en) : ''"></div>
                            </div>
                        </div>
                        
                        <div class="form-act tc page-act final-submit">
                             <label class="lbl-chk bil-inline">
                                <input type="checkbox" x-model="checkoutForm.terms_agreed" @change="clrErr('terms_agreed')">
                                <span class="en">I agree to the <button type="button" class="link-style" @click.prevent="openRefundModal()">Terms & Refund Policy</button> *</span>
                                <span class="ar">أوافق على <button type="button" class="link-style" @click.prevent="openRefundModal()">الشروط وسياسة الاسترداد</button> *</span>
                            </label>
                            <div class="err-msg" x-show="errs.terms_agreed" x-text="errs.terms_agreed ? (currLang === 'ar' ? errs.terms_agreed.ar : errs.terms_agreed.en) : ''"></div>
                            <button type="submit" class="btn bac btn-lg btn-block bil-inline" :disabled="load.checkout">
                                <span x-show="!load.checkout"><span class="en">Complete Order</span><span class="ar">إتمام الطلب</span></span>
                                <span x-show="load.checkout"><span class="en">Processing...</span><span class="ar">جاري المعالجة...</span></span>
                            </button>
                        </div>
                    </form>
                </div>
                <div class="checkout-summary-col">
                    <div class="card form-panel sticky-summary">
                        <div class="card-b">
                            <h2 class="form-subh bil-spread"><span class="en">Order Summary</span><span class="ar">ملخص الطلب</span></h2>
                            <div class="rev-sum checkout-rev-sum">
                                <template x-for="item in cartItems" :key="item.uniqueIdInCart">
                                    <div class="sum-item">
                                        <div class="sum-item-content bil-spread">
                                            <span class="en" x-text="item.nameENSpec + ' (×' + item.quantity + ')'"></span>
                                            <span class="ar" x-text="item.nameARSpec + ' (×' + item.quantity + ')'"></span>
                                        </div>
                                        <div class="sum-item-price" x-text="fmtPrice(getSubtotalForItem(item))"></div>
                                    </div>
                                </template>
                                <template x-if="checkoutForm.delivery_fee_egp > 0">
                                    <div class="sum-item">
                                        <div class="sum-item-content bil-spread">
                                            <span class="en">Delivery Fee</span><span class="ar">رسوم التوصيل</span>
                                        </div>
                                        <div class="sum-item-price" x-text="fmtPrice(checkoutForm.delivery_fee_egp)"></div>
                                    </div>
                                </template>
                                <template x-if="checkoutForm.online_payment_fee_applied_egp > 0">
                                    <div class="sum-item">
                                        <div class="sum-item-content bil-spread">
                                            <span class="en">Online Payment Fee</span><span class="ar">رسوم الدفع الإلكتروني</span>
                                        </div>
                                        <div class="sum-item-price" x-text="fmtPrice(checkoutForm.online_payment_fee_applied_egp)"></div>
                                    </div>
                                </template>
                                <hr class="sum-hr">
                                <div class="sum-total">
                                    <div class="bil-spread">
                                        <span class="en"><strong>Total:</strong></span>
                                        <span class="ar"><strong>المجموع:</strong></span>
                                    </div>
                                    <div><strong x-text="fmtPrice(checkoutForm.final_total_egp)"></strong></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <section class="sec conf-sect-wide" x-show="orderConf.show" x-transition>
                <div class="c tc">
                    <h2 class="bil-spread conf-h" x-ref="orderConfTitle" tabindex="-1">
                        <span class="en">Order Confirmed! JazakAllah Khairan.</span>
                        <span class="ar">تم تأكيد الطلب! جزاكم الله خيرًا.</span>
                    </h2>
                    <div class="conf-msg">
                        <div class="bil-row conf-intro">
                            <p class="en">Thank you for choosing Sheep Land Egypt. Your order is being processed with care.</p>
                            <p class="ar">نشكركم على اختيار أرض الأغنام مصر. طلبكم قيد المعالجة بعناية.</p>
                        </div>
                        <div class="card form-panel order-id-box">
                            <div class="card-b order-id-box-body">
                                <div class="bil-spread">
                                    <p class="en order-id-box-imp"><strong>Order ID:</strong></p>
                                    <p class="ar order-id-box-imp"><strong>رقم الطلب:</strong></p>
                                </div>
                                <p class="order-id-disp" x-text="orderConf.orderID"></p>
                            </div>
                        </div>
                        <div class="pay-instr">
                            <h4 class="form-subh bil-spread">
                                <span class="en">Payment Instructions</span>
                                <span class="ar">تعليمات الدفع</span>
                            </h4>
                            <div x-html="orderConf.paymentInstructions"></div>
                        </div>
                    </div>
                    <div class="form-act tc page-act">
                        <button @click="navigateToOrScroll('home')" class="btn bp btn-lg bil-inline">
                            <span class="en">Back to Homepage</span><span class="ar">العودة للرئيسية</span>
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </section>
    
    <section class="sec main-page-sec" x-show="currentPage === 'auth'" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" tabindex="-1">
                    <span class="en" x-text="auth.view === 'login' ? 'Welcome Back' : 'Join Sheep Land'"></span>
                    <span class="ar" x-text="auth.view === 'login' ? 'أهلاً بعودتك' : 'انضم لأرض الأغنام'"></span>
                </h1>
            </div>
            <div class="auth-form-container">
                <div class="card form-panel">
                    <div class="card-b">
                        <form @submit.prevent="auth.view === 'login' ? loginUser() : registerUser()" novalidate x-show="auth.view === 'login'">
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Email *</span><span class="ar">البريد الإلكتروني *</span></label>
                                <input type="email" class="input" x-model="auth.email">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Password *</span><span class="ar">كلمة المرور *</span></label>
                                <input type="password" class="input" x-model="auth.password">
                            </div>
                            <div class="card-act">
                                <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.auth">
                                    <span x-show="!load.auth"><span class="en">Login</span><span class="ar">دخول</span></span>
                                    <span x-show="load.auth"><span class="en">Logging in...</span><span class="ar">جاري الدخول...</span></span>
                                </button>
                            </div>
                            <p class="auth-toggle-link bil-row">
                                <span class="en">New to Sheep Land?</span><span class="ar">جديد في أرض الأغنام؟</span>
                                <button type="button" @click="auth.view = 'register'; clrAllErrs();" class="link-style bil-inline"><span class="en">Create account</span><span class="ar">إنشاء حساب</span></button>
                            </p>
                        </form>

                        <form @submit.prevent="registerUser()" novalidate x-show="auth.view === 'register'">
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Full Name *</span><span class="ar">الاسم الكامل *</span></label>
                                <input type="text" class="input" x-model="auth.name">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Email *</span><span class="ar">البريد الإلكتروني *</span></label>
                                <input type="email" class="input" x-model="auth.email">
                            </div>
                            <div class="fg">
                                <label class="bil-spread"><span class="en">Phone</span><span class="ar">الهاتف</span></label>
                                <input type="tel" class="input" x-model="auth.phone">
                            </div>
                            <div class="fg">
                                <label class="bil-spread"><span class="en">Country</span><span class="ar">البلد</span></label>
                                <input type="text" class="input" x-model="auth.country" placeholder="Egypt">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Password *</span><span class="ar">كلمة المرور *</span></label>
                                <input type="password" class="input" x-model="auth.password">
                            </div>
                            <div class="fg">
                                <label class="bil-spread lbl-req"><span class="en">Confirm Password *</span><span class="ar">تأكيد كلمة المرور *</span></label>
                                <input type="password" class="input" x-model="auth.passwordConfirm">
                            </div>
                            <div class="card-act">
                                <button type="submit" class="btn bp btn-block bil-inline" :disabled="load.auth">
                                    <span x-show="!load.auth"><span class="en">Create Account</span><span class="ar">إنشاء حساب</span></span>
                                    <span x-show="load.auth"><span class="en">Creating...</span><span class="ar">جاري الإنشاء...</span></span>
                                </button>
                            </div>
                            <p class="auth-toggle-link bil-row">
                                <span class="en">Already have an account?</span><span class="ar">لديك حساب بالفعل؟</span>
                                <button type="button" @click="auth.view = 'login'; clrAllErrs();" class="link-style bil-inline"><span class="en">Sign in</span><span class="ar">تسجيل دخول</span></button>
                            </p>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="sec main-page-sec" x-show="currentPage === 'account'" x-transition>
        <div class="c">
            <div class="sec-head">
                <h1 class="bil-spread" tabindex="-1">
                    <span class="en">My Account</span><span class="ar">حسابي</span>
                </h1>
            </div>
            <div x-show="!currentUser" class="empty-state tc">
                <p class="bil-row">
                    <span class="en">Please <a href="#auth" @click.prevent="navigateToOrScroll('auth')" class="link-style">login or register</a> to access your account.</span>
                    <span class="ar">يرجى <a href="#auth" @click.prevent="navigateToOrScroll('auth')" class="link-style">تسجيل الدخول أو إنشاء حساب</a> للوصول لحسابك.</span>
                </p>
            </div>
            <div x-show="currentUser">
                <div class="card form-panel">
                    <div class="card-b">
                        <h2 class="form-subh bil-spread"><span class="en">Account Information</span><span class="ar">معلومات الحساب</span></h2>
                        <div class="sum-item bil-row"><span class="en"><strong>Email:</strong> <span x-text="currentUser?.email || 'N/A'"></span></span><span class="ar"><strong>البريد الإلكتروني:</strong> <span x-text="currentUser?.email || 'غير متوفر'"></span></span></div>
                        <div class="sum-item bil-row"><span class="en"><strong>Name:</strong> <span x-text="currentUser?.name || 'Not set'"></span></span><span class="ar"><strong>الاسم:</strong> <span x-text="currentUser?.name || 'غير محدد'"></span></span></div>
                        <div class="sum-item bil-row"><span class="en"><strong>Phone:</strong> <span x-text="currentUser?.phone || 'Not set'"></span></span><span class="ar"><strong>الهاتف:</strong> <span x-text="currentUser?.phone || 'غير محدد'"></span></span></div>
                        <div class="sum-item bil-row"><span class="en"><strong>Country:</strong> <span x-text="currentUser?.country || 'Not set'"></span></span><span class="ar"><strong>البلد:</strong> <span x-text="currentUser?.country || 'غير محدد'"></span></span></div>
                        <button @click="logoutUser()" class="btn danger"><span class="bil-inline"><span class="en">Logout</span><span class="ar">تسجيل الخروج</span></span></button>
                    </div>
                </div>
                <div class="card form-panel">
                    <div class="card-b">
                        <h2 class="form-subh bil-spread"><span class="en">Order History</span><span class="ar">سجل الطلبات</span></h2>
                        <div x-show="load.orders" class="load-text tc">Loading orders...</div>
                        <div x-show="!load.orders && userOrders.length === 0" class="empty-state tc">
                            <p class="bil-row"><span class="en">No orders yet.</span><span class="ar">لا توجد طلبات بعد.</span></p>
                            <button @click="navigateToOrScroll('udheya')" class="btn bp">
                                <span class="bil-inline"><span class="en">Start Shopping</span><span class="ar">ابدأ التسوق</span></span>
                            </button>
                        </div>
                        <div x-show="!load.orders && userOrders.length > 0">
                            <template x-for="order in userOrders" :key="order.id">
                                <div class="card order-history-item">
                                    <div class="card-b">
                                        <div class="sum-item bil-row">
                                            <div><strong class="en">Order ID:</strong><strong class="ar">رقم الطلب:</strong></div>
                                            <div><span x-text="order.order_id_text"></span></div>
                                        </div>
                                        <div class="sum-item bil-row">
                                            <div><strong class="en">Status:</strong><strong class="ar">الحالة:</strong></div>
                                            <div><span class="stat-hl" x-text="order.order_status"></span></div>
                                        </div>
                                        <div class="sum-item">
                                             <div><strong>Total:</strong></div>
                                             <div><span x-text="fmtPrice(order.total_amount_due_egp)"></span></div>
                                        </div>
                                        <div class="sum-item bil-row">
                                             <div><strong class="en">Date:</strong><strong class="ar">التاريخ:</strong></div>
                                             <div><span x-text="new Date(order.created).toLocaleDateString()"></span></div>
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Social Proof Notifications - Removed -->

<!-- Exit Intent Popup -->
<div class="exit-popup-overlay" x-show="showExitOffer" x-transition @click="showExitOffer = false">
    <div class="exit-popup" @click.stop>
        <button @click="showExitOffer = false" class="modal-close-btn">×</button>
        <h2 class="bil-spread"><span class="en">Wait! Don't leave empty-handed 🛍️</span><span class="ar">انتظر! لا تغادر خالي الوفاض 🛍️</span></h2>
        <p class="bil-row">
            <span class="en">Complete your order now and get 5% OFF!</span>
            <span class="ar">أكمل طلبك الآن واحصل على خصم 5%!</span>
        </p>
        <div class="exit-popup-code">
            <div class="bil-spread"><span class="en">Use code:</span><span class="ar">استخدم الكود:</span></div>
            <div class="promo-code">SAVE5</div>
        </div>
        <button @click="showExitOffer = false; isCartOpen = true" class="btn bp btn-lg btn-block">
            <span class="bil-inline"><span class="en">Continue Shopping</span><span class="ar">متابعة التسوق</span></span>
        </button>
    </div>
</div>

<!-- Sticky Cart Button - Removed (undefined variable) -->

<!-- Quick View Modal - Removed -->

<!-- Meat Calculator Modal - Removed -->

<footer class="foot main-page-sec">
    <div class="c">
        <div class="foot-grid">
            <div class="bil-row foot-brand-desc">
                <p class="en">Egypt's trusted partner for premium, Sharia-compliant sheep, livesheep, fresh meat, and Udheya services. Serving Egypt and international customers with guaranteed quality and authentic farm-to-table experience.</p>
                <p class="ar">الشريك الموثوق في مصر للأغنام الحية واللحوم الطازجة وخدمات الأضاحي المتوافقة مع الشريعة. نخدم مصر والعملاء الدوليين مع ضمان الجودة وتجربة أصيلة من المزرعة للمائدة.</p>
            </div>
        </div>
        <hr class="foot-div">
        <p class="foot-copy">© <span x-text="new Date().getFullYear()"></span> Sheep Land Egypt.
            <span class="bil-copy">
                <span class="en">All rights reserved.</span><span class="ar">جميع الحقوق محفوظة.</span>
            </span>
             | <button @click.prevent="openRefundModal()" class="footer-link-btn bil-inline"><span class="en">Refund Policy</span><span class="ar">سياسة الاسترداد</span></button>
        </p>
    </div>
</footer>

<script src="vendor/pocketbase.umd.js"></script>
<script src="app.js"></script>
<script defer src="vendor/alpine-collapse.min.js"></script>
<script defer src="vendor/alpine.min.js"></script>

</body>
</html>
