<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PB Setup: Sheep Land</title>
    <script src="vendor/pocketbase.umd.js"></script>
    <style>
        body{font-family:system-ui,-apple-system,sans-serif;font-size:11px;line-height:1.2;padding:4px;background:#f0f1f3;color:#333;margin:0;min-height:100vh}
        .c{max-width:1200px;margin:0 auto;background:white;padding:8px;border-radius:4px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}
        h1{color:#2C5F41;border-bottom:1px solid #D2B48C;padding-bottom:2px;margin:0 0 6px 0;font-size:1.1em;text-align:center}
        p{font-size:.75rem;margin:0 0 4px 0;line-height:1.2} 
        label{display:block;margin-bottom:2px;font-weight:bold;font-size:10px}
        input,textarea{width:100%;padding:3px 4px;border:1px solid #ddd;border-radius:2px;font-size:10px;font-family:inherit}
        textarea{font-family:monospace;resize:vertical}
        .warn{color:#dc3545;font-weight:bold;background:#fee;padding:6px;border-radius:3px;border-left:2px solid #dc3545;font-size:10px}
        button{padding:4px 8px;background:#2C5F41;color:white;border:0;border-radius:3px;cursor:pointer;font-size:10px;margin:2px;font-weight:600;white-space:nowrap}
        button:disabled{background:#ccc;cursor:not-allowed} 
        button:hover:not(:disabled){background:#1A3B2B;box-shadow:0 1px 3px rgba(0,0,0,0.2)}
        #out{margin-top:4px;padding:4px;background:#1a1a1a;color:#e0e0e0;border-radius:3px;font-family:monospace;font-size:8px;line-height:1.15;max-height:40vh;overflow-y:auto;border:1px solid #333}
        .ls{color:#4ade80} .le{color:#f87171} .li{color:#60a5fa} .lw{color:#fbbf24} .ld{color:#9ca3af}
        #out p{margin:1px 0;padding:0}
        #out pre{margin:1px 0;padding:2px;background:#2d2d2d;border-radius:2px;font-size:7px;line-height:1.1;overflow-x:auto}
        .setup-info{background:#e8f4fd;padding:6px;border-radius:3px;border-left:2px solid #2196f3;margin-bottom:6px;font-size:10px}
        .setup-info p{margin:2px 0}
        .validation-success{color:#22c55e;font-weight:600;font-size:9px}
        .validation-error{color:#ef4444;font-weight:600;font-size:9px}
        .validation-warning{color:#f59e0b;font-weight:600;font-size:9px}
        .validation-info{color:#3b82f6;font-weight:normal;font-size:9px}
        .textarea-valid{border-color:#22c55e!important;box-shadow:0 0 0 1px rgba(34,197,94,0.2)}
        .textarea-invalid{border-color:#ef4444!important;box-shadow:0 0 0 1px rgba(239,68,68,0.2)}
        .grid{display:grid;gap:6px}
        .grid-3{grid-template-columns:repeat(3,1fr)}
        .grid-2{grid-template-columns:repeat(2,1fr)}
        .btn-group{text-align:center;margin:6px 0}
        .field-group{margin-bottom:4px}
    </style>
</head>
<body>
    <div class="c">
        <h1>Sheep Land - PocketBase Setup</h1>
        
        <div class="grid grid-3 field-group">
            <div>
                <label>PocketBase URL:</label>
                <input type="text" id="pbUrlInput" value="/">
            </div>
            <div>
                <label>Admin Email:</label>
                <input type="email" id="adminEmail" value="admin@example.com">
            </div>
            <div>
                <label>Admin Password:</label>
                <input type="password" id="adminPassword" value="unifiedpassword">
            </div>
        </div>
        
        <div class="grid grid-2 field-group">
            <div>
                <label>Collections JSON:</label>
                <textarea id="collectionsData" style="height:80px"></textarea>
                <div id="collectionsValidation" style="margin-top:2px;min-height:12px"></div>
            </div>
            <div>
                <label>Seed Data JSON:</label>
                <textarea id="seedData" style="height:80px"></textarea>
                <div id="seedValidation" style="margin-top:2px;min-height:12px"></div>
            </div>
        </div>
        
        <div class="btn-group">
            <button id="runFullSetup">üöÄ Complete Setup</button>
            <button id="runSchemaOnly">üìã Schema Only</button>
            <button id="runSeedOnly" disabled>üå± Seed Only</button>
            <button id="showHelp" style="background:#2196f3">üìö Help & Docs</button>
        </div>
        <div id="out"></div>
    </div>
    
    <!-- Help Modal -->
    <div id="helpModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000">
        <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:90%;max-width:800px;max-height:90vh;background:white;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,0.15);overflow:hidden;display:flex;flex-direction:column">
            <div style="padding:12px 16px;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center;background:#f8f9fa">
                <h2 style="margin:0;font-size:16px;color:#2C5F41">üìö PocketBase Setup Documentation</h2>
                <button onclick="document.getElementById('helpModal').style.display='none'" style="background:none;border:none;font-size:20px;cursor:pointer;color:#666;padding:0;width:24px;height:24px">&times;</button>
            </div>
            <div style="padding:16px;overflow-y:auto;flex:1">
                <div style="background:#e8f4fd;padding:10px;border-radius:4px;margin-bottom:16px;border-left:3px solid #2196f3">
                    <h3 style="margin:0 0 8px 0;font-size:14px;color:#1976d2">üéØ Collection Structure (MANDATORY FORMAT)</h3>
                    <pre style="background:#f5f5f5;padding:8px;border-radius:4px;overflow-x:auto;font-size:11px;line-height:1.4;margin:0">{
  "name": "collection_name",        // REQUIRED: string, alphanumeric + underscore only
  "type": "base",                   // REQUIRED: "base" | "auth" | "view"
  "listRule": "",                   // REQUIRED: string | null (see API Rules section)
  "viewRule": "",                   // REQUIRED: string | null
  "createRule": "",                 // REQUIRED: string | null
  "updateRule": "",                 // REQUIRED: string | null
  "deleteRule": "",                 // REQUIRED: string | null
  "fields": [                       // REQUIRED: array of field objects
    {
      "name": "field_name",         // REQUIRED: string, valid field name
      "type": "text",               // REQUIRED: valid field type (see Field Types)
      "required": true,             // REQUIRED: boolean
      "presentable": true,          // REQUIRED: boolean
      // Additional properties based on field type
    }
  ]
}</pre>
                </div>

                <h3 style="font-size:14px;margin:16px 0 8px 0;color:#2C5F41">üîß Field Types Reference</h3>
                
                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üìù Text Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "title",
  "type": "text",
  "required": true,
  "presentable": true,
  "max": 200,                // optional: max length
  "min": 1,                  // optional: min length
  "pattern": "^[a-zA-Z0-9_\\-\\s]+$"  // optional: regex pattern
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üî¢ Number Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "price",
  "type": "number",
  "required": true,
  "presentable": true,
  "min": 0,                  // optional: minimum value
  "max": 999999,             // optional: maximum value
  "noDecimal": false         // optional: integers only if true
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">‚úÖ Boolean Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "is_active",
  "type": "bool",
  "required": false,
  "presentable": true
  // No additional properties for boolean fields
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üìß Email Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "email",
  "type": "email",
  "required": true,
  "presentable": true,
  "exceptDomains": ["tempmail.com"],     // optional: blocked domains
  "onlyDomains": ["company.com"]         // optional: allowed domains only
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üåê URL Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "website",
  "type": "url",
  "required": false,
  "presentable": true
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üìÖ Date Fields</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">// Simple date
{
  "name": "birth_date",
  "type": "date",
  "required": false,
  "presentable": true
}

// Date with time
{
  "name": "event_time",
  "type": "datetime",
  "required": true,
  "presentable": true
}

// Auto-date (created/updated timestamps)
{
  "name": "created_at",
  "type": "autodate",
  "required": false,
  "presentable": false,
  "onCreate": true,        // Set on record creation
  "onUpdate": false        // Don't update on record update
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üìã Select Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">// Single select
{
  "name": "status",
  "type": "select",
  "required": true,
  "presentable": true,
  "maxSelect": 1,                    // REQUIRED: 1 for single select
  "values": ["active", "inactive"]   // REQUIRED: array of options
}

// Multiple select
{
  "name": "tags",
  "type": "select",
  "required": false,
  "presentable": true,
  "maxSelect": 5,                    // REQUIRED: max selections
  "values": ["urgent", "feature", "bug", "enhancement"]
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üìÅ File Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">// Single file
{
  "name": "avatar",
  "type": "file",
  "required": false,
  "presentable": true,
  "maxSelect": 1,                    // REQUIRED: max files
  "maxSize": 5242880,                // optional: bytes (5MB)
  "mimeTypes": [                     // optional: allowed MIME types
    "image/jpeg",
    "image/png",
    "image/gif",
    "image/webp"
  ]
}

// Multiple files
{
  "name": "attachments",
  "type": "file",
  "required": false,
  "presentable": true,
  "maxSelect": 10,
  "maxSize": 10485760,               // 10MB per file
  "mimeTypes": [
    "image/jpeg",
    "image/png",
    "application/pdf"
  ]
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üîó Relation Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">// One-to-One relation
{
  "name": "user_id",
  "type": "relation",
  "required": true,
  "presentable": true,
  "collectionId": "actual_collection_uuid",    // REQUIRED: target collection ID
  "cascadeDelete": false,                      // REQUIRED: boolean
  "minSelect": 1,                             // REQUIRED: number | null
  "maxSelect": 1,                             // REQUIRED: number | null
  "displayFields": ["email", "name"]          // REQUIRED: array of field names
}

// Many-to-Many
{
  "name": "tags",
  "type": "relation",
  "required": false,
  "presentable": true,
  "collectionId": "tags_collection_uuid",
  "cascadeDelete": false,
  "minSelect": null,                          // null = optional
  "maxSelect": null,                          // null = unlimited
  "displayFields": ["name", "color"]
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üóÉÔ∏è JSON Field</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "metadata",
  "type": "json",
  "required": false,
  "presentable": true
  // Stores any valid JSON data structure
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">üìù Editor Field (Rich Text)</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "name": "content",
  "type": "editor",
  "required": false,
  "presentable": true
  // Rich text editor with HTML support
}</pre>
                </details>

                <h3 style="font-size:14px;margin:16px 0 8px 0;color:#2C5F41">üîê API Rules Reference</h3>
                
                <div style="background:#f5f5f5;padding:10px;border-radius:4px;margin-bottom:12px">
                    <h4 style="margin:0 0 8px 0;font-size:12px">Rule Values:</h4>
                    <code style="display:block;margin:2px 0">""</code> - Empty string = PUBLIC ACCESS (anyone can perform action)<br>
                    <code style="display:block;margin:2px 0">null</code> - null = ADMIN ONLY (only admin users can perform action)<br>
                    <code style="display:block;margin:2px 0">"rule"</code> - String = CUSTOM RULE (filter expression)
                </div>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">Public Access Rules</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "listRule": "",      // Anyone can list/read records
  "viewRule": "",      // Anyone can view individual records
  "createRule": "",    // Anyone can create records
  "updateRule": "",    // Anyone can update records
  "deleteRule": ""     // Anyone can delete records
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">Admin Only Rules</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "listRule": null,    // Only admins can list records
  "viewRule": null,    // Only admins can view records
  "createRule": null,  // Only admins can create records
  "updateRule": null,  // Only admins can update records
  "deleteRule": null   // Only admins can delete records
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">Authenticated User Rules</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">{
  "listRule": "@request.auth.id != ''",      // Only logged-in users
  "viewRule": "@request.auth.id != ''",      
  "createRule": "@request.auth.id != ''",    
  "updateRule": "@request.auth.id != ''",    
  "deleteRule": "@request.auth.id != ''"     
}</pre>
                </details>

                <details style="margin-bottom:8px">
                    <summary style="cursor:pointer;padding:8px;background:#f5f5f5;border-radius:4px;font-weight:bold">Owner-Only Rules</summary>
                    <pre style="background:#f9f9f9;padding:8px;margin:4px 0;border-radius:4px;font-size:11px">// Assuming records have a "user" field pointing to the owner
{
  "listRule": "user = @request.auth.id",     // List own records only
  "viewRule": "user = @request.auth.id",     // View own records only
  "createRule": "@request.auth.id != ''",    // Any auth user can create
  "updateRule": "user = @request.auth.id",   // Update own records only
  "deleteRule": "user = @request.auth.id"    // Delete own records only
}</pre>
                </details>

                <h3 style="font-size:14px;margin:16px 0 8px 0;color:#dc3545">‚ùå Common Errors to Avoid</h3>
                
                <div style="background:#fee;padding:10px;border-radius:4px;margin-bottom:12px;border-left:3px solid #dc3545">
                    <h4 style="margin:0 0 8px 0;font-size:12px;color:#dc3545">üö´ NEVER Use These Patterns:</h4>
                    <pre style="background:#fff5f5;padding:8px;border-radius:4px;font-size:11px;margin:4px 0">// ‚ùå WRONG: Nested options structure
{
  "name": "title",
  "type": "text",
  "required": true,
  "options": {              // ‚ùå DON'T USE "options" wrapper
    "max": 100,
    "min": 1
  }
}

// ‚ùå WRONG: Schema key instead of fields
{
  "name": "posts",
  "schema": [...]           // ‚ùå DON'T USE "schema" key
}

// ‚ùå WRONG: Invalid field names
{
  "name": "field name",     // ‚ùå No spaces
  "name": "field-name",     // ‚ùå No hyphens
  "name": "123field",       // ‚ùå Can't start with number
}</pre>
                </div>

                <div style="background:#d4edda;padding:10px;border-radius:4px;margin-bottom:12px;border-left:3px solid #28a745">
                    <h4 style="margin:0 0 8px 0;font-size:12px;color:#155724">‚úÖ CORRECT Patterns:</h4>
                    <pre style="background:#f1f8f4;padding:8px;border-radius:4px;font-size:11px;margin:4px 0">// ‚úÖ CORRECT: Direct properties
{
  "name": "title",
  "type": "text",
  "required": true,
  "presentable": true,
  "max": 100,               // ‚úÖ Direct property
  "min": 1                  // ‚úÖ Direct property
}

// ‚úÖ CORRECT: Valid field names
{
  "name": "field_name",     // ‚úÖ Underscores OK
  "name": "fieldName",      // ‚úÖ camelCase OK
  "name": "field123",       // ‚úÖ Numbers at end OK
}</pre>
                </div>
            </div>
        </div>
    </div>
<script>
    let pbUrl = '/';
    const outputDiv = document.getElementById('out');
    const runFullSetupButton = document.getElementById('runFullSetup');
    const runSchemaOnlyButton = document.getElementById('runSchemaOnly');
    const runSeedOnlyButton = document.getElementById('runSeedOnly');
    const pbUrlInput = document.getElementById('pbUrlInput');
    const adminEmailInput = document.getElementById('adminEmail');
    const adminPasswordInput = document.getElementById('adminPassword');
    const collectionsTextarea = document.getElementById('collectionsData');
    const seedTextarea = document.getElementById('seedData');
    const collectionsValidationDiv = document.getElementById('collectionsValidation');
    const seedValidationDiv = document.getElementById('seedValidation');
    
    // Note: textareas will be populated after data definitions

    const log = (message, type = 'i', data = null) => {
        const time = new Date().toTimeString().slice(0,8);
        const p = document.createElement('p');
        p.className = `l${type[0].toLowerCase()}`;
        let logMessage = `<span style="color:#666">${time}</span> ${message}`;
        if (data && typeof data === 'object') {
            const pre = document.createElement('pre');
            pre.textContent = JSON.stringify(data, null, 1);
            logMessage += pre.outerHTML; 
        }
        p.innerHTML = logMessage; 
        outputDiv.appendChild(p);
        outputDiv.scrollTop = outputDiv.scrollHeight;
    };

    async function authenticateAdmin(pb) {
        try {
            const email = adminEmailInput.value;
            const password = adminPasswordInput.value;
            await pb.admins.authWithPassword(email, password);
            log('üîë Admin authentication successful', 's');
            return true;
        } catch (error) {
            log(`‚ùå Admin authentication failed: ${error.message}`, 'e');
            return false;
        }
    }
    
    const defaultRefundPolicyHTML = `
        <div class="bil-row">
            <p class="en">Welcome to Sheep Land. We are committed to providing premium quality sheep, livesheep, and meat products with full Sharia compliance. Please read our comprehensive policy.</p>
            <p class="ar" dir="rtl">ÿ£ŸáŸÑÿßŸã ÿ®ŸÉŸÖ ŸÅŸä ÿ£ÿ±ÿ∂ ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ. ŸÜÿ≠ŸÜ ŸÖŸÑÿ™ÿ≤ŸÖŸàŸÜ ÿ®ÿ™ŸÇÿØŸäŸÖ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ ÿßŸÑÿ≠Ÿäÿ© ŸàÿßŸÑŸÑÿ≠ŸàŸÖ ÿπÿßŸÑŸäÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸÖÿπ ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ÿßŸÑŸÉÿßŸÖŸÑ ŸÑŸÑÿ¥ÿ±Ÿäÿπÿ© ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖŸäÿ©.</p>
        </div>
        <h3 class="bil-spread modal-section-title">
            <span class="en">Udheya Orders</span><span class="ar" dir="rtl">ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿ£ÿ∂ÿßÿ≠Ÿä</span>
        </h3>
        <div class="bil-row">
            <p class="en">Due to the religious nature and specific timing of Udheya, our policies are designed to ensure proper fulfillment while accommodating genuine needs:</p>
            <p class="ar" dir="rtl">ŸÜÿ∏ÿ±ÿßŸã ŸÑŸÑÿ∑ÿ®Ÿäÿπÿ© ÿßŸÑÿØŸäŸÜŸäÿ© ŸàÿßŸÑÿ™ŸàŸÇŸäÿ™ ÿßŸÑŸÖÿ≠ÿØÿØ ŸÑŸÑÿ£ÿ∂ÿßÿ≠Ÿäÿå ÿ™ŸÖ ÿ™ÿµŸÖŸäŸÖ ÿ≥Ÿäÿßÿ≥ÿßÿ™ŸÜÿß ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿ≥ŸÑŸäŸÖ ŸÖÿπ ŸÖÿ±ÿßÿπÿßÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ©:</p>
        </div>
        <h4 class="bil-spread"><span class="en">Cancellation Policy</span><span class="ar" dir="rtl">ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿ•ŸÑÿ∫ÿßÿ°</span></h4>
        <div class="bil-row">
            <p class="en"><strong>Before Animal Selection (5+ days before Eid):</strong> Full refund minus 3% processing fee</p>
            <p class="ar" dir="rtl"><strong>ŸÇÿ®ŸÑ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ≠ŸäŸàÿßŸÜ (5+ ÿ£ŸäÿßŸÖ ŸÇÿ®ŸÑ ÿßŸÑÿπŸäÿØ):</strong> ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ŸÉÿßŸÖŸÑ ŸÜÿßŸÇÿµ 3% ÿ±ÿ≥ŸàŸÖ ŸÖÿπÿßŸÑÿ¨ÿ©</p>
        </div>
        <div class="bil-row">
            <p class="en"><strong>After Animal Selection (2-4 days before):</strong> 50% refund if suitable replacement buyer found</p>
            <p class="ar" dir="rtl"><strong>ÿ®ÿπÿØ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ≠ŸäŸàÿßŸÜ (2-4 ÿ£ŸäÿßŸÖ ŸÇÿ®ŸÑ):</strong> ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ 50% ÿ•ÿ∞ÿß ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÖÿ¥ÿ™ÿ±Ÿç ÿ®ÿØŸäŸÑ ŸÖŸÜÿßÿ≥ÿ®</p>
        </div>
        <div class="bil-row">
            <p class="en"><strong>Day of Eid:</strong> No refunds (animal prepared for slaughter)</p>
            <p class="ar" dir="rtl"><strong>ŸäŸàŸÖ ÿßŸÑÿπŸäÿØ:</strong> ŸÑÿß ŸäŸàÿ¨ÿØ ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ (ÿßŸÑÿ≠ŸäŸàÿßŸÜ ŸÖÿ≠ÿ∂ÿ± ŸÑŸÑÿ∞ÿ®ÿ≠)</p>
        </div>

        <h3 class="bil-spread modal-section-title"><span class="en">Live Sheep</span><span class="ar" dir="rtl">ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ ÿßŸÑÿ≠Ÿäÿ©</span></h3>
        <div class="bil-row">
            <p class="en">Live animals require 48-72 hours advance notice for cancellation. Health-guaranteed animals cannot be returned unless veterinary defects are proven within 24 hours of delivery.</p>
            <p class="ar" dir="rtl">ÿßŸÑÿ≠ŸäŸàÿßŸÜÿßÿ™ ÿßŸÑÿ≠Ÿäÿ© ÿ™ÿ™ÿ∑ŸÑÿ® ÿ•ÿ¥ÿπÿßÿ± ŸÖÿ≥ÿ®ŸÇ 48-72 ÿ≥ÿßÿπÿ© ŸÑŸÑÿ•ŸÑÿ∫ÿßÿ°. ÿßŸÑÿ≠ŸäŸàÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ∂ŸÖŸàŸÜÿ© ÿµÿ≠ŸäÿßŸã ŸÑÿß ŸäŸÖŸÉŸÜ ÿ•ÿ±ÿ¨ÿßÿπŸáÿß ÿ•ŸÑÿß ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ•ÿ´ÿ®ÿßÿ™ ÿπŸäŸàÿ® ÿ®Ÿäÿ∑ÿ±Ÿäÿ© ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ© ŸÖŸÜ ÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ.</p>
        </div>

        <h3 class="bil-spread modal-section-title"><span class="en">Fresh Meat & Cuts</span><span class="ar" dir="rtl">ÿßŸÑŸÑÿ≠ŸàŸÖ ÿßŸÑÿ∑ÿßÿ≤ÿ¨ÿ© ŸàÿßŸÑŸÇÿ∑ÿπŸäÿßÿ™</span></h3>
        <div class="bil-row">
            <p class="en">Fresh meat orders can be cancelled up to 24 hours before preparation. Quality issues must be reported within 4 hours of delivery with photographic evidence.</p>
            <p class="ar" dir="rtl">ŸäŸÖŸÉŸÜ ÿ•ŸÑÿ∫ÿßÿ° ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÑÿ≠ŸàŸÖ ÿßŸÑÿ∑ÿßÿ≤ÿ¨ÿ© ÿ≠ÿ™Ÿâ 24 ÿ≥ÿßÿπÿ© ŸÇÿ®ŸÑ ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±. Ÿäÿ¨ÿ® ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿπŸÜ ŸÖÿ¥ÿßŸÉŸÑ ÿßŸÑÿ¨ŸàÿØÿ© ÿÆŸÑÿßŸÑ 4 ÿ≥ÿßÿπÿßÿ™ ŸÖŸÜ ÿßŸÑÿ™ŸàÿµŸäŸÑ ŸÖÿπ ÿØŸÑŸäŸÑ ŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸä.</p>
        </div>

        <h3 class="bil-spread modal-section-title"><span class="en">Gathering Packages & Events</span><span class="ar" dir="rtl">ÿ®ÿßŸÇÿßÿ™ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿßÿ™ ŸàÿßŸÑŸàŸÑÿßÿ¶ŸÖ</span></h3>
        <div class="bil-row">
            <p class="en">Event packages require 7 days notice for full refund, 3 days for 50% refund. Same-day cancellations incur full charges due to preparation costs.</p>
            <p class="ar" dir="rtl">ÿ®ÿßŸÇÿßÿ™ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿßÿ™ ÿ™ÿ™ÿ∑ŸÑÿ® ÿ•ÿ¥ÿπÿßÿ± 7 ÿ£ŸäÿßŸÖ ŸÑŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ÿßŸÑŸÉÿßŸÖŸÑÿå 3 ÿ£ŸäÿßŸÖ ŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ 50%. ÿ•ŸÑÿ∫ÿßÿ° ŸÜŸÅÿ≥ ÿßŸÑŸäŸàŸÖ Ÿäÿ™ÿ≠ŸÖŸÑ ÿßŸÑÿ±ÿ≥ŸàŸÖ ŸÉÿßŸÖŸÑÿ© ÿ®ÿ≥ÿ®ÿ® ÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±.</p>
        </div>

        <h3 class="bil-spread modal-section-title"><span class="en">International Orders</span><span class="ar" dir="rtl">ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿØŸàŸÑŸäÿ©</span></h3>
        <div class="bil-row">
            <p class="en">International customers enjoy the same quality guarantees. Shipping costs are non-refundable unless we fail to fulfill confirmed orders.</p>
            <p class="ar" dir="rtl">ÿßŸÑÿπŸÖŸÑÿßÿ° ÿßŸÑÿØŸàŸÑŸäŸàŸÜ Ÿäÿ™ŸÖÿ™ÿπŸàŸÜ ÿ®ŸÜŸÅÿ≥ ÿ∂ŸÖÿßŸÜÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ©. ÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿ¥ÿ≠ŸÜ ÿ∫Ÿäÿ± ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ÿ•ŸÑÿß ÿ•ÿ∞ÿß ŸÅÿ¥ŸÑŸÜÿß ŸÅŸä ÿ™ŸÑÿ®Ÿäÿ© ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÖÿ§ŸÉÿØÿ©.</p>
        </div>
    `;

    const collectionsDefinition = [
        {
                "name": "settings",
                "type": "base",
                "system": false,
                "listRule": "",
                "viewRule": "",
                "createRule": null,
                "updateRule": "@request.auth.id != '' && @request.auth.verified = true",
                "deleteRule": null,
                "fields": [
                        {
                                "name": "xchgRates",
                                "type": "json",
                                "required": true,
                                "presentable": true
                        },
                        {
                                "name": "defCurr",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 5,
                                "min": 3
                        },
                        {
                                "name": "waNumRaw",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 20
                        },
                        {
                                "name": "waNumDisp",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 30
                        },
                        {
                                "name": "promoEndISO",
                                "type": "date",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "promoDiscPc",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0,
                                "max": 100
                        },
                        {
                                "name": "promoActive",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "servFeeEGP",
                                "type": "number",
                                "required": true,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "delAreas",
                                "type": "json",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "payDetails",
                                "type": "json",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "enable_udheya_section",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "enable_livesheep_section",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "enable_meat_section",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "enable_gatherings_section",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "slaughter_location_gmaps_url",
                                "type": "url",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "online_payment_fee_egp",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "refund_policy_html",
                                "type": "editor",
                                "required": false,
                                "presentable": false
                        },
                        {
                                "name": "app_email_sender_address",
                                "type": "email",
                                "required": false,
                                "presentable": false
                        },
                        {
                                "name": "app_email_sender_name",
                                "type": "text",
                                "required": false,
                                "presentable": false,
                                "max": 100
                        },
                        {
                                "name": "site_title_en",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 100
                        },
                        {
                                "name": "site_title_ar",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 100
                        },
                        {
                                "name": "site_desc_en",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 300
                        },
                        {
                                "name": "site_desc_ar",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 300
                        }
                ]
        },
        {
                "name": "products",
                "type": "base",
                "system": false,
                "listRule": "",
                "viewRule": "",
                "createRule": "@request.auth.id != '' && @request.auth.verified = true",
                "updateRule": "@request.auth.id != '' && @request.auth.verified = true",
                "deleteRule": "@request.auth.id != '' && @request.auth.verified = true",
                "fields": [
                        {
                                "name": "item_key",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "unique": true,
                                "max": 100,
                                "min": 1,
                                "pattern": "^[a-z0-9_]+$"
                        },
                        {
                                "name": "product_category",
                                "type": "select",
                                "required": true,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "udheya",
                                        "livesheep_general",
                                        "meat_cuts",
                                        "gathering_package",
                                        "breeding_stock",
                                        "feed_supplies",
                                        "aqiqah",
                                        "charity",
                                        "vow",
                                        "expiation",
                                        "ready_to_eat",
                                        "live_sheep",
                                        "slaughtered"
                                ]
                        },
                        {
                                "name": "type_key",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 50,
                                "min": 1,
                                "pattern": "^[a-z0-9_]+$"
                        },
                        {
                                "name": "type_name_en",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 100,
                                "min": 1
                        },
                        {
                                "name": "type_name_ar",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 100,
                                "min": 1
                        },
                        {
                                "name": "type_description_en",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 500
                        },
                        {
                                "name": "type_description_ar",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 500
                        },
                        {
                                "name": "price_per_kg_egp",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "variant_name_en",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 150,
                                "min": 1
                        },
                        {
                                "name": "variant_name_ar",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 150,
                                "min": 1
                        },
                        {
                                "name": "weight_range_text_en",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "weight_range_text_ar",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "avg_weight_kg",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "base_price_egp",
                                "type": "number",
                                "required": true,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "stock_available_pb",
                                "type": "number",
                                "required": true,
                                "presentable": true,
                                "min": 0,
                                "noDecimal": true
                        },
                        {
                                "name": "is_active",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "is_premium",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "origin_farm",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 100
                        },
                        {
                                "name": "breed_info_en",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 200
                        },
                        {
                                "name": "breed_info_ar",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 200
                        },
                        {
                                "name": "sort_order_type",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0,
                                "noDecimal": true
                        },
                        {
                                "name": "sort_order_variant",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0,
                                "noDecimal": true
                        }
                ],
                "indexes": [
                        "CREATE UNIQUE INDEX `idx_products_item_key` ON `products` (`item_key`)",
                        "CREATE INDEX `idx_products_category` ON `products` (`product_category`)"
                ]
        },
        {
                "name": "users",
                "type": "auth",
                "system": false,
                "listRule": "@request.auth.id = id || @request.auth.is_admin = true",
                "viewRule": "@request.auth.id = id || @request.auth.is_admin = true",
                "createRule": "",
                "updateRule": "@request.auth.id = id || @request.auth.is_admin = true",
                "deleteRule": "@request.auth.id = id || @request.auth.is_admin = true",
                "options": {
                        "emailVisibility": true,
                        "requireEmailVerification": false,
                        "allowOAuth2Auth": false,
                        "allowUsernameAuth": false,
                        "allowPasswordAuth": true,
                        "onlyVerified": false
                },
                "fields": [
                        {
                                "name": "name",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 100
                        },
                        {
                                "name": "phone",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 20
                        },
                        {
                                "name": "country",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "preferred_currency",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 5
                        },
                        {
                                "name": "is_admin",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        }
                ]
        },
        {
                "name": "orders",
                "type": "base",
                "system": false,
                "listRule": "(@request.query.lookupOrderID != '' && order_id_text = @request.query.lookupOrderID) || @request.auth.is_admin = true",
                "viewRule": "(@request.query.lookupOrderID != '' && order_id_text = @request.query.lookupOrderID) || @request.auth.is_admin = true",
                "createRule": "",
                "updateRule": "@request.auth.id != '' && @request.auth.verified = true",
                "deleteRule": "@request.auth.id != '' && @request.auth.verified = true",
                "fields": [
                        {
                                "name": "order_id_text",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "unique": true,
                                "max": 50,
                                "min": 1
                        },
                        {
                                "name": "customer_name",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 150,
                                "min": 1
                        },
                        {
                                "name": "customer_phone",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 30,
                                "min": 7
                        },
                        {
                                "name": "customer_email",
                                "type": "email",
                                "required": true,
                                "presentable": true
                        },
                        {
                                "name": "customer_country",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "line_items",
                                "type": "json",
                                "required": true,
                                "presentable": true
                        },
                        {
                                "name": "delivery_option",
                                "type": "select",
                                "required": true,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "home_delivery",
                                        "self_pickup_or_internal_distribution",
                                        "international_shipping"
                                ]
                        },
                        {
                                "name": "delivery_city_id",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "delivery_area_name_en",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 100
                        },
                        {
                                "name": "delivery_area_name_ar",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 100
                        },
                        {
                                "name": "delivery_address",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 500
                        },
                        {
                                "name": "delivery_instructions",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 500
                        },
                        {
                                "name": "delivery_time_slot",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "payment_method",
                                "type": "text",
                                "required": true,
                                "presentable": true,
                                "max": 50,
                                "min": 1
                        },
                        {
                                "name": "payment_status",
                                "type": "select",
                                "required": true,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "pending_payment",
                                        "payment_under_review",
                                        "paid_confirmed",
                                        "cod_pending_confirmation",
                                        "cod_confirmed_pending_delivery",
                                        "failed",
                                        "refunded",
                                        "partially_refunded",
                                        "pending_gateway_redirect"
                                ]
                        },
                        {
                                "name": "order_status",
                                "type": "select",
                                "required": true,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "pending_confirmation",
                                        "confirmed_pending_payment",
                                        "payment_confirmed_processing",
                                        "ready_for_fulfillment",
                                        "out_for_delivery",
                                        "fulfilled_completed",
                                        "cancelled_by_user",
                                        "cancelled_by_admin",
                                        "on_hold",
                                        "awaiting_payment_gateway"
                                ]
                        },
                        {
                                "name": "terms_agreed",
                                "type": "bool",
                                "required": true,
                                "presentable": true
                        },
                        {
                                "name": "admin_notes",
                                "type": "editor",
                                "required": false,
                                "presentable": false
                        },
                        {
                                "name": "user_ip_address",
                                "type": "text",
                                "required": false,
                                "presentable": false,
                                "max": 50
                        },
                        {
                                "name": "user_agent_string",
                                "type": "text",
                                "required": false,
                                "presentable": false,
                                "max": 300
                        },
                        {
                                "name": "subtotal_amount_egp",
                                "type": "number",
                                "required": true,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "total_udheya_service_fee_egp",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "delivery_fee_applied_egp",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "online_payment_fee_applied_egp",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "international_shipping_fee_egp",
                                "type": "number",
                                "required": false,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "total_amount_due_egp",
                                "type": "number",
                                "required": true,
                                "presentable": true,
                                "min": 0
                        },
                        {
                                "name": "selected_display_currency",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 5
                        }
                ],
                "indexes": [
                        "CREATE UNIQUE INDEX `idx_orders_order_id_text` ON `orders` (`order_id_text`)"
                ]
        },
        {
                "name": "feedback",
                "type": "base",
                "system": false,
                "listRule": "@request.auth.id != '' && @request.auth.verified = true",
                "viewRule": "",
                "createRule": "",
                "updateRule": "@request.auth.id != '' && @request.auth.verified = true",
                "deleteRule": "@request.auth.id != '' && @request.auth.verified = true",
                "fields": [
                        {
                                "name": "name",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 150
                        },
                        {
                                "name": "email",
                                "type": "email",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "phone",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 30
                        },
                        {
                                "name": "orderNumber",
                                "type": "text",
                                "required": false,
                                "presentable": true,
                                "max": 50
                        },
                        {
                                "name": "orderType",
                                "type": "select",
                                "required": false,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "udheya",
                                        "livesheep",
                                        "meat",
                                        "gatherings",
                                        "general",
                                        "not_specified"
                                ]
                        },
                        {
                                "name": "rating",
                                "type": "number",
                                "required": true,
                                "presentable": true,
                                "min": 1,
                                "max": 5,
                                "noDecimal": true
                        },
                        {
                                "name": "category",
                                "type": "select",
                                "required": false,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "product",
                                        "delivery",
                                        "service",
                                        "website",
                                        "price",
                                        "other"
                                ]
                        },
                        {
                                "name": "message",
                                "type": "text",
                                "required": false,
                                "presentable": false,
                                "max": 2000
                        },
                        {
                                "name": "wouldRecommend",
                                "type": "select",
                                "required": false,
                                "presentable": true,
                                "maxSelect": 1,
                                "values": [
                                        "yes",
                                        "maybe",
                                        "no"
                                ]
                        },
                        {
                                "name": "allowTestimonial",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "isPublished",
                                "type": "bool",
                                "required": false,
                                "presentable": true
                        },
                        {
                                "name": "userAgent",
                                "type": "text",
                                "required": false,
                                "presentable": false,
                                "max": 500
                        },
                        {
                                "name": "pageUrl",
                                "type": "url",
                                "required": false,
                                "presentable": false
                        },
                        {
                                "name": "ipAddress",
                                "type": "text",
                                "required": false,
                                "presentable": false,
                                "max": 50
                        }
                ],
                "indexes": [
                        "CREATE INDEX `idx_feedback_rating` ON `feedback` (`rating`)",
                        "CREATE INDEX `idx_feedback_published` ON `feedback` (`isPublished`)"
                ]
        }
];

    // All product data is managed through the database
    // No hardcoded products in the application code
    // Admin can modify products via PocketBase admin panel after initial setup
    const seedData = {
        "settings": [
                {
                        "xchgRates": {
                                "EGP": {
                                        "rate_from_egp": 1,
                                        "symbol": "LE",
                                        "is_active": true
                                },
                                "USD": {
                                        "rate_from_egp": 0.02,
                                        "symbol": "$",
                                        "is_active": true
                                },
                                "SAR": {
                                        "rate_from_egp": 0.075,
                                        "symbol": "Ô∑º",
                                        "is_active": true
                                },
                                "AED": {
                                        "rate_from_egp": 0.073,
                                        "symbol": "ÿØ.ÿ•",
                                        "is_active": true
                                },
                                "GBP": {
                                        "rate_from_egp": 0.016,
                                        "symbol": "¬£",
                                        "is_active": true
                                },
                                "EUR": {
                                        "rate_from_egp": 0.018,
                                        "symbol": "‚Ç¨",
                                        "is_active": true
                                },
                                "KWD": {
                                        "rate_from_egp": 0.006,
                                        "symbol": "ÿØ.ŸÉ",
                                        "is_active": true
                                },
                                "QAR": {
                                        "rate_from_egp": 0.073,
                                        "symbol": "ÿ±.ŸÇ",
                                        "is_active": true
                                }
                        },
                        "defCurr": "EGP",
                        "waNumRaw": "201001234567",
                        "waNumDisp": "+20 100 123 4567",
                        "promoEndISO": new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
                        "promoDiscPc": 15,
                        "promoActive": true,
                        "servFeeEGP": 800,
                        "delAreas": [
                                {
                                        "id": "cairo_metro",
                                        "name_en": "Cairo Metropolitan",
                                        "name_ar": "ÿßŸÑŸÇÿßŸáÿ±ÿ© ÿßŸÑŸÉÿ®ÿ±Ÿâ",
                                        "cities": [
                                                {
                                                        "id": "nasr_city",
                                                        "name_en": "Nasr City",
                                                        "name_ar": "ŸÖÿØŸäŸÜÿ© ŸÜÿµÿ±",
                                                        "delivery_fee_egp": 100
                                                },
                                                {
                                                        "id": "heliopolis",
                                                        "name_en": "Heliopolis",
                                                        "name_ar": "ŸÖÿµÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©",
                                                        "delivery_fee_egp": 120
                                                },
                                                {
                                                        "id": "maadi",
                                                        "name_en": "Maadi",
                                                        "name_ar": "ÿßŸÑŸÖÿπÿßÿØŸä",
                                                        "delivery_fee_egp": 150
                                                },
                                                {
                                                        "id": "zamalek",
                                                        "name_en": "Zamalek",
                                                        "name_ar": "ÿßŸÑÿ≤ŸÖÿßŸÑŸÉ",
                                                        "delivery_fee_egp": 180
                                                }
                                        ]
                                },
                                {
                                        "id": "giza_west",
                                        "name_en": "Giza West",
                                        "name_ar": "ÿ∫ÿ±ÿ® ÿßŸÑÿ¨Ÿäÿ≤ÿ©",
                                        "cities": [
                                                {
                                                        "id": "october",
                                                        "name_en": "6th of October City",
                                                        "name_ar": "ŸÖÿØŸäŸÜÿ© 6 ÿ£ŸÉÿ™Ÿàÿ®ÿ±",
                                                        "delivery_fee_egp": 200
                                                },
                                                {
                                                        "id": "zayed",
                                                        "name_en": "Sheikh Zayed",
                                                        "name_ar": "ÿßŸÑÿ¥ŸäÿÆ ÿ≤ÿßŸäÿØ",
                                                        "delivery_fee_egp": 220
                                                },
                                                {
                                                        "id": "hadayek_october",
                                                        "name_en": "Hadayek October",
                                                        "name_ar": "ÿ≠ÿØÿßÿ¶ŸÇ ÿ£ŸÉÿ™Ÿàÿ®ÿ±",
                                                        "delivery_fee_egp": 180
                                                }
                                        ]
                                },
                                {
                                        "id": "new_cairo",
                                        "name_en": "New Cairo & East",
                                        "name_ar": "ÿßŸÑŸÇÿßŸáÿ±ÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ© ŸàÿßŸÑÿ¥ÿ±ŸÇ",
                                        "cities": [
                                                {
                                                        "id": "tagamoa",
                                                        "name_en": "New Cairo (Tagamoa)",
                                                        "name_ar": "ÿßŸÑÿ™ÿ¨ŸÖÿπ (ÿßŸÑŸÇÿßŸáÿ±ÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©)",
                                                        "delivery_fee_egp": 250
                                                },
                                                {
                                                        "id": "madinaty",
                                                        "name_en": "Madinaty",
                                                        "name_ar": "ŸÖÿØŸäŸÜÿ™Ÿä",
                                                        "delivery_fee_egp": 280
                                                },
                                                {
                                                        "id": "shorouk",
                                                        "name_en": "El Shorouk",
                                                        "name_ar": "ÿßŸÑÿ¥ÿ±ŸàŸÇ",
                                                        "delivery_fee_egp": 300
                                                },
                                                {
                                                        "id": "rehab",
                                                        "name_en": "Rehab City",
                                                        "name_ar": "ŸÖÿØŸäŸÜÿ© ÿßŸÑÿ±ÿ≠ÿßÿ®",
                                                        "delivery_fee_egp": 260
                                                }
                                        ]
                                },
                                {
                                        "id": "alex_metro",
                                        "name_en": "Alexandria Metropolitan",
                                        "name_ar": "ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ© ÿßŸÑŸÉÿ®ÿ±Ÿâ",
                                        "cities": [
                                                {
                                                        "id": "alex_center",
                                                        "name_en": "Alexandria Center",
                                                        "name_ar": "Ÿàÿ≥ÿ∑ ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©",
                                                        "delivery_fee_egp": 400
                                                },
                                                {
                                                        "id": "alex_east",
                                                        "name_en": "Alexandria East",
                                                        "name_ar": "ÿ¥ÿ±ŸÇ ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©",
                                                        "delivery_fee_egp": 450
                                                },
                                                {
                                                        "id": "alex_west",
                                                        "name_en": "Alexandria West",
                                                        "name_ar": "ÿ∫ÿ±ÿ® ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©",
                                                        "delivery_fee_egp": 420
                                                }
                                        ]
                                }
                        ],
                        "payDetails": {
                                "vodafone_cash": "01012345678",
                                "instapay_ipn": "sheepland@instapay",
                                "revolut_details": "@SheepLandEgypt",
                                "monzo_details": "monzo.me/sheeplandegypt",
                                "paypal_email": "payments@sheep.land",
                                "bank_name": "Commercial International Bank Egypt",
                                "bank_account_name": "Sheep Land Trading",
                                "bank_account_number": "1234567890123456",
                                "bank_iban": "EG38CIBE12345678901234567890",
                                "bank_swift": "CIBEEGCX",
                                "western_union_details": "Sheep Land - Cairo Branch",
                                "moneygram_details": "Available at all Egypt Post offices"
                        },
                        "enable_udheya_section": true,
                        "enable_livesheep_section": true,
                        "enable_meat_section": true,
                        "enable_gatherings_section": true,
                        "slaughter_location_gmaps_url": "https://maps.app.goo.gl/SheepLandEgyptFarm123",
                        "online_payment_fee_egp": 50,
                        "refund_policy_html": "\n        <div class=\"bil-row\">\n            <p class=\"en\">Welcome to Sheep Land. We are committed to providing premium quality sheep, livesheep, and meat products with full Sharia compliance. Please read our comprehensive policy.</p>\n            <p class=\"ar\" dir=\"rtl\">ÿ£ŸáŸÑÿßŸã ÿ®ŸÉŸÖ ŸÅŸä ÿ£ÿ±ÿ∂ ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ. ŸÜÿ≠ŸÜ ŸÖŸÑÿ™ÿ≤ŸÖŸàŸÜ ÿ®ÿ™ŸÇÿØŸäŸÖ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ ÿßŸÑÿ≠Ÿäÿ© ŸàÿßŸÑŸÑÿ≠ŸàŸÖ ÿπÿßŸÑŸäÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸÖÿπ ÿßŸÑÿßŸÖÿ™ÿ´ÿßŸÑ ÿßŸÑŸÉÿßŸÖŸÑ ŸÑŸÑÿ¥ÿ±Ÿäÿπÿ© ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖŸäÿ©.</p>\n        </div>\n        <h3 class=\"bil-spread modal-section-title\">\n            <span class=\"en\">Udheya Orders</span><span class=\"ar\" dir=\"rtl\">ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿ£ÿ∂ÿßÿ≠Ÿä</span>\n        </h3>\n        <div class=\"bil-row\">\n            <p class=\"en\">Due to the religious nature and specific timing of Udheya, our policies are designed to ensure proper fulfillment while accommodating genuine needs:</p>\n            <p class=\"ar\" dir=\"rtl\">ŸÜÿ∏ÿ±ÿßŸã ŸÑŸÑÿ∑ÿ®Ÿäÿπÿ© ÿßŸÑÿØŸäŸÜŸäÿ© ŸàÿßŸÑÿ™ŸàŸÇŸäÿ™ ÿßŸÑŸÖÿ≠ÿØÿØ ŸÑŸÑÿ£ÿ∂ÿßÿ≠Ÿäÿå ÿ™ŸÖ ÿ™ÿµŸÖŸäŸÖ ÿ≥Ÿäÿßÿ≥ÿßÿ™ŸÜÿß ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑÿ™ŸÜŸÅŸäÿ∞ ÿßŸÑÿ≥ŸÑŸäŸÖ ŸÖÿπ ŸÖÿ±ÿßÿπÿßÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ¨ÿßÿ™ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ©:</p>\n        </div>\n        <h4 class=\"bil-spread\"><span class=\"en\">Cancellation Policy</span><span class=\"ar\" dir=\"rtl\">ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿ•ŸÑÿ∫ÿßÿ°</span></h4>\n        <div class=\"bil-row\">\n            <p class=\"en\"><strong>Before Animal Selection (5+ days before Eid):</strong> Full refund minus 3% processing fee</p>\n            <p class=\"ar\" dir=\"rtl\"><strong>ŸÇÿ®ŸÑ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ≠ŸäŸàÿßŸÜ (5+ ÿ£ŸäÿßŸÖ ŸÇÿ®ŸÑ ÿßŸÑÿπŸäÿØ):</strong> ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ŸÉÿßŸÖŸÑ ŸÜÿßŸÇÿµ 3% ÿ±ÿ≥ŸàŸÖ ŸÖÿπÿßŸÑÿ¨ÿ©</p>\n        </div>\n        <div class=\"bil-row\">\n            <p class=\"en\"><strong>After Animal Selection (2-4 days before):</strong> 50% refund if suitable replacement buyer found</p>\n            <p class=\"ar\" dir=\"rtl\"><strong>ÿ®ÿπÿØ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ≠ŸäŸàÿßŸÜ (2-4 ÿ£ŸäÿßŸÖ ŸÇÿ®ŸÑ):</strong> ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ 50% ÿ•ÿ∞ÿß ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÖÿ¥ÿ™ÿ±Ÿç ÿ®ÿØŸäŸÑ ŸÖŸÜÿßÿ≥ÿ®</p>\n        </div>\n        <div class=\"bil-row\">\n            <p class=\"en\"><strong>Day of Eid:</strong> No refunds (animal prepared for slaughter)</p>\n            <p class=\"ar\" dir=\"rtl\"><strong>ŸäŸàŸÖ ÿßŸÑÿπŸäÿØ:</strong> ŸÑÿß ŸäŸàÿ¨ÿØ ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ (ÿßŸÑÿ≠ŸäŸàÿßŸÜ ŸÖÿ≠ÿ∂ÿ± ŸÑŸÑÿ∞ÿ®ÿ≠)</p>\n        </div>\n\n        <h3 class=\"bil-spread modal-section-title\"><span class=\"en\">Live Sheep</span><span class=\"ar\" dir=\"rtl\">ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ ÿßŸÑÿ≠Ÿäÿ©</span></h3>\n        <div class=\"bil-row\">\n            <p class=\"en\">Live animals require 48-72 hours advance notice for cancellation. Health-guaranteed animals cannot be returned unless veterinary defects are proven within 24 hours of delivery.</p>\n            <p class=\"ar\" dir=\"rtl\">ÿßŸÑÿ≠ŸäŸàÿßŸÜÿßÿ™ ÿßŸÑÿ≠Ÿäÿ© ÿ™ÿ™ÿ∑ŸÑÿ® ÿ•ÿ¥ÿπÿßÿ± ŸÖÿ≥ÿ®ŸÇ 48-72 ÿ≥ÿßÿπÿ© ŸÑŸÑÿ•ŸÑÿ∫ÿßÿ°. ÿßŸÑÿ≠ŸäŸàÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ∂ŸÖŸàŸÜÿ© ÿµÿ≠ŸäÿßŸã ŸÑÿß ŸäŸÖŸÉŸÜ ÿ•ÿ±ÿ¨ÿßÿπŸáÿß ÿ•ŸÑÿß ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ•ÿ´ÿ®ÿßÿ™ ÿπŸäŸàÿ® ÿ®Ÿäÿ∑ÿ±Ÿäÿ© ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ© ŸÖŸÜ ÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ.</p>\n        </div>\n\n        <h3 class=\"bil-spread modal-section-title\"><span class=\"en\">Fresh Meat & Cuts</span><span class=\"ar\" dir=\"rtl\">ÿßŸÑŸÑÿ≠ŸàŸÖ ÿßŸÑÿ∑ÿßÿ≤ÿ¨ÿ© ŸàÿßŸÑŸÇÿ∑ÿπŸäÿßÿ™</span></h3>\n        <div class=\"bil-row\">\n            <p class=\"en\">Fresh meat orders can be cancelled up to 24 hours before preparation. Quality issues must be reported within 4 hours of delivery with photographic evidence.</p>\n            <p class=\"ar\" dir=\"rtl\">ŸäŸÖŸÉŸÜ ÿ•ŸÑÿ∫ÿßÿ° ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÑÿ≠ŸàŸÖ ÿßŸÑÿ∑ÿßÿ≤ÿ¨ÿ© ÿ≠ÿ™Ÿâ 24 ÿ≥ÿßÿπÿ© ŸÇÿ®ŸÑ ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±. Ÿäÿ¨ÿ® ÿßŸÑÿ•ÿ®ŸÑÿßÿ∫ ÿπŸÜ ŸÖÿ¥ÿßŸÉŸÑ ÿßŸÑÿ¨ŸàÿØÿ© ÿÆŸÑÿßŸÑ 4 ÿ≥ÿßÿπÿßÿ™ ŸÖŸÜ ÿßŸÑÿ™ŸàÿµŸäŸÑ ŸÖÿπ ÿØŸÑŸäŸÑ ŸÅŸàÿ™Ÿàÿ∫ÿ±ÿßŸÅŸä.</p>\n        </div>\n\n        <h3 class=\"bil-spread modal-section-title\"><span class=\"en\">Gathering Packages & Events</span><span class=\"ar\" dir=\"rtl\">ÿ®ÿßŸÇÿßÿ™ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿßÿ™ ŸàÿßŸÑŸàŸÑÿßÿ¶ŸÖ</span></h3>\n        <div class=\"bil-row\">\n            <p class=\"en\">Event packages require 7 days notice for full refund, 3 days for 50% refund. Same-day cancellations incur full charges due to preparation costs.</p>\n            <p class=\"ar\" dir=\"rtl\">ÿ®ÿßŸÇÿßÿ™ ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿßÿ™ ÿ™ÿ™ÿ∑ŸÑÿ® ÿ•ÿ¥ÿπÿßÿ± 7 ÿ£ŸäÿßŸÖ ŸÑŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ÿßŸÑŸÉÿßŸÖŸÑÿå 3 ÿ£ŸäÿßŸÖ ŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ 50%. ÿ•ŸÑÿ∫ÿßÿ° ŸÜŸÅÿ≥ ÿßŸÑŸäŸàŸÖ Ÿäÿ™ÿ≠ŸÖŸÑ ÿßŸÑÿ±ÿ≥ŸàŸÖ ŸÉÿßŸÖŸÑÿ© ÿ®ÿ≥ÿ®ÿ® ÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±.</p>\n        </div>\n\n        <h3 class=\"bil-spread modal-section-title\"><span class=\"en\">International Orders</span><span class=\"ar\" dir=\"rtl\">ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿØŸàŸÑŸäÿ©</span></h3>\n        <div class=\"bil-row\">\n            <p class=\"en\">International customers enjoy the same quality guarantees. Shipping costs are non-refundable unless we fail to fulfill confirmed orders.</p>\n            <p class=\"ar\" dir=\"rtl\">ÿßŸÑÿπŸÖŸÑÿßÿ° ÿßŸÑÿØŸàŸÑŸäŸàŸÜ Ÿäÿ™ŸÖÿ™ÿπŸàŸÜ ÿ®ŸÜŸÅÿ≥ ÿ∂ŸÖÿßŸÜÿßÿ™ ÿßŸÑÿ¨ŸàÿØÿ©. ÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿ¥ÿ≠ŸÜ ÿ∫Ÿäÿ± ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ÿ•ŸÑÿß ÿ•ÿ∞ÿß ŸÅÿ¥ŸÑŸÜÿß ŸÅŸä ÿ™ŸÑÿ®Ÿäÿ© ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÖÿ§ŸÉÿØÿ©.</p>\n        </div>\n    ",
                        "app_email_sender_address": "noreply@sheep.land",
                        "app_email_sender_name": "Sheep Land",
                        "site_title_en": "Sheep Land",
                        "site_title_ar": "ÿ£ÿ±ÿ∂ ÿßŸÑÿ£ÿ∫ŸÜÿßŸÖ",
                        "site_desc_en": "Sheep, livesheep, fresh meat, and Sharia-compliant Udheya services. Serving Egypt and international customers.",
                        "site_desc_ar": "ÿ£ÿ∫ŸÜÿßŸÖ Ÿàÿ£ÿ∫ŸÜÿßŸÖ ŸàŸÑÿ≠ŸàŸÖ ÿ∑ÿßÿ≤ÿ¨ÿ© ŸàÿÆÿØŸÖÿßÿ™ ÿ£ÿ∂ÿßÿ≠Ÿä ŸÖÿ™ŸàÿßŸÅŸÇÿ© ŸÖÿπ ÿßŸÑÿ¥ÿ±Ÿäÿπÿ©. ŸÜÿÆÿØŸÖ ŸÖÿµÿ± ŸàÿßŸÑÿπŸÖŸÑÿßÿ° ÿßŸÑÿØŸàŸÑŸäŸäŸÜ."
                }
        ],
        "products": [
                {
                        "item_key": "baladi_udheya_40kg",
                        "product_category": "udheya",
                        "type_key": "baladi_sheep",
                        "type_name_en": "Baladi Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿ®ŸÑÿØŸä",
                        "type_description_en": "Egyptian Baladi sheep.",
                        "type_description_ar": "ÿ£ÿ∫ŸÜÿßŸÖ ÿ®ŸÑÿØŸäÿ© ŸÖÿµÿ±Ÿäÿ© ÿ™ÿ±ÿ®ÿ™ ŸÅŸä ŸÖÿ≤ÿßÿ±ÿπ ÿ®ÿ∑ÿ±ŸÇ ÿ™ŸÇŸÑŸäÿØŸäÿ©.",
                        "price_per_kg_egp": 280,
                        "variant_name_en": "Baladi Small (35-45kg)",
                        "variant_name_ar": "ÿ®ŸÑÿØŸä ÿµÿ∫Ÿäÿ± (Ÿ£Ÿ•-Ÿ§Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "35-45kg",
                        "weight_range_text_ar": "Ÿ£Ÿ•-Ÿ§Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 40,
                        "base_price_egp": 11200,
                        "stock_available_pb": 25,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Fayoum Farms",
                        "breed_info_en": "Traditional Egyptian breed",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿ© ŸÖÿµÿ±Ÿäÿ© ÿ™ŸÇŸÑŸäÿØŸäÿ©",
                        "sort_order_type": 1,
                        "sort_order_variant": 1,
                        "discount_percentage": 20
                },
                {
                        "item_key": "baladi_udheya_50kg",
                        "product_category": "udheya",
                        "type_key": "baladi_sheep",
                        "type_name_en": "Baladi Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿ®ŸÑÿØŸä",
                        "type_description_en": "Egyptian Baladi sheep.",
                        "type_description_ar": "ÿ£ÿ∫ŸÜÿßŸÖ ÿ®ŸÑÿØŸäÿ© ŸÖÿµÿ±Ÿäÿ© ÿ™ÿ±ÿ®ÿ™ ŸÅŸä ŸÖÿ≤ÿßÿ±ÿπ ÿ®ÿ∑ÿ±ŸÇ ÿ™ŸÇŸÑŸäÿØŸäÿ©.",
                        "price_per_kg_egp": 280,
                        "variant_name_en": "Baladi Medium (45-55kg)",
                        "variant_name_ar": "ÿ®ŸÑÿØŸä ŸÖÿ™Ÿàÿ≥ÿ∑ (Ÿ§Ÿ•-Ÿ•Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "45-55kg",
                        "weight_range_text_ar": "Ÿ§Ÿ•-Ÿ•Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 50,
                        "base_price_egp": 14000,
                        "stock_available_pb": 30,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Fayoum Farms",
                        "breed_info_en": "Traditional Egyptian breed",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿ© ŸÖÿµÿ±Ÿäÿ© ÿ™ŸÇŸÑŸäÿØŸäÿ©",
                        "sort_order_type": 1,
                        "sort_order_variant": 2,
                        "discount_percentage": 0
                },
                {
                        "item_key": "baladi_udheya_62kg",
                        "product_category": "udheya",
                        "type_key": "baladi_sheep",
                        "type_name_en": "Baladi Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿ®ŸÑÿØŸä",
                        "type_description_en": "Egyptian Baladi sheep.",
                        "type_description_ar": "ÿ£ÿ∫ŸÜÿßŸÖ ÿ®ŸÑÿØŸäÿ© ŸÖÿµÿ±Ÿäÿ© ÿ™ÿ±ÿ®ÿ™ ŸÅŸä ŸÖÿ≤ÿßÿ±ÿπ ÿ®ÿ∑ÿ±ŸÇ ÿ™ŸÇŸÑŸäÿØŸäÿ©.",
                        "price_per_kg_egp": 280,
                        "variant_name_en": "Baladi Large (55-70kg)",
                        "variant_name_ar": "ÿ®ŸÑÿØŸä ŸÉÿ®Ÿäÿ± (Ÿ•Ÿ•-ŸßŸ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "55-70kg",
                        "weight_range_text_ar": "Ÿ•Ÿ•-ŸßŸ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 62,
                        "base_price_egp": 17360,
                        "stock_available_pb": 20,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Fayoum Farms",
                        "breed_info_en": "Traditional Egyptian breed",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿ© ŸÖÿµÿ±Ÿäÿ© ÿ™ŸÇŸÑŸäÿØŸäÿ©",
                        "sort_order_type": 1,
                        "sort_order_variant": 3,
                        "discount_percentage": 0
                },
                {
                        "item_key": "barki_udheya_37kg",
                        "product_category": "udheya",
                        "type_key": "barki_sheep",
                        "type_name_en": "Barki Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿ®ÿ±ŸÇŸä",
                        "type_description_en": "Barki sheep with lean meat.",
                        "type_description_ar": "ÿ£ÿ∫ŸÜÿßŸÖ ÿ®ÿ±ŸÇŸä ŸÖŸÜ ŸÖŸÜÿßÿ∑ŸÇ ÿµÿ≠ÿ±ÿßŸàŸäÿ© ÿ®ŸÑÿ≠ŸÖ ŸÇŸÑŸäŸÑ ÿßŸÑÿØŸáŸÜ.",
                        "price_per_kg_egp": 320,
                        "variant_name_en": "Barki Small (35-40kg)",
                        "variant_name_ar": "ÿ®ÿ±ŸÇŸä ÿµÿ∫Ÿäÿ± (Ÿ£Ÿ•-Ÿ§Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "35-40kg",
                        "weight_range_text_ar": "Ÿ£Ÿ•-Ÿ§Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 37,
                        "base_price_egp": 11840,
                        "stock_available_pb": 15,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Marsa Matrouh Desert Farms",
                        "breed_info_en": "Desert-adapted Bedouin breed",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿ© ÿ®ÿØŸàŸäÿ© ŸÖÿ™ŸÉŸäŸÅÿ© ŸÖÿπ ÿßŸÑÿµÿ≠ÿ±ÿßÿ°",
                        "sort_order_type": 2,
                        "sort_order_variant": 1,
                        "discount_percentage": 15
                },
                {
                        "item_key": "barki_udheya_42kg",
                        "product_category": "udheya",
                        "type_key": "barki_sheep",
                        "type_name_en": "Barki Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿ®ÿ±ŸÇŸä",
                        "type_description_en": "Barki sheep with lean meat.",
                        "type_description_ar": "ÿ£ÿ∫ŸÜÿßŸÖ ÿ®ÿ±ŸÇŸä ŸÖŸÜ ŸÖŸÜÿßÿ∑ŸÇ ÿµÿ≠ÿ±ÿßŸàŸäÿ© ÿ®ŸÑÿ≠ŸÖ ŸÇŸÑŸäŸÑ ÿßŸÑÿØŸáŸÜ.",
                        "price_per_kg_egp": 320,
                        "variant_name_en": "Barki Medium (40-45kg)",
                        "variant_name_ar": "ÿ®ÿ±ŸÇŸä ŸÖÿ™Ÿàÿ≥ÿ∑ (Ÿ§Ÿ†-Ÿ§Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "40-45kg",
                        "weight_range_text_ar": "Ÿ§Ÿ†-Ÿ§Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 42,
                        "base_price_egp": 13440,
                        "stock_available_pb": 12,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Marsa Matrouh Desert Farms",
                        "breed_info_en": "Desert-adapted Bedouin breed",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿ© ÿ®ÿØŸàŸäÿ© ŸÖÿ™ŸÉŸäŸÅÿ© ŸÖÿπ ÿßŸÑÿµÿ≠ÿ±ÿßÿ°",
                        "sort_order_type": 2,
                        "sort_order_variant": 2,
                        "discount_percentage": 0
                },
                {
                        "item_key": "barki_udheya_47kg",
                        "product_category": "udheya",
                        "type_key": "barki_sheep",
                        "type_name_en": "Barki Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿ®ÿ±ŸÇŸä",
                        "type_description_en": "Barki sheep with lean meat.",
                        "type_description_ar": "ÿ£ÿ∫ŸÜÿßŸÖ ÿ®ÿ±ŸÇŸä ŸÖŸÜ ŸÖŸÜÿßÿ∑ŸÇ ÿµÿ≠ÿ±ÿßŸàŸäÿ© ÿ®ŸÑÿ≠ŸÖ ŸÇŸÑŸäŸÑ ÿßŸÑÿØŸáŸÜ.",
                        "price_per_kg_egp": 320,
                        "variant_name_en": "Barki Large (45-50kg)",
                        "variant_name_ar": "ÿ®ÿ±ŸÇŸä ŸÉÿ®Ÿäÿ± (Ÿ§Ÿ•-Ÿ•Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "45-50kg",
                        "weight_range_text_ar": "Ÿ§Ÿ•-Ÿ•Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 47,
                        "base_price_egp": 15040,
                        "stock_available_pb": 8,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Marsa Matrouh Desert Farms",
                        "breed_info_en": "Desert-adapted Bedouin breed",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿ© ÿ®ÿØŸàŸäÿ© ŸÖÿ™ŸÉŸäŸÅÿ© ŸÖÿπ ÿßŸÑÿµÿ≠ÿ±ÿßÿ°",
                        "sort_order_type": 2,
                        "sort_order_variant": 3,
                        "discount_percentage": 0
                },
                {
                        "item_key": "live_ram_baladi_breeding",
                        "product_category": "livesheep_general",
                        "type_key": "breeding_rams",
                        "type_name_en": "Rams",
                        "type_name_ar": "ŸÉÿ®ÿßÿ¥",
                        "type_description_en": "Breeding rams.",
                        "type_description_ar": "ŸÉÿ®ÿßÿ¥ ÿ™ÿ±ÿ®Ÿäÿ© ŸÑŸÑŸÖÿ≤ÿßÿ±ÿπ.",
                        "variant_name_en": "Baladi Ram (80-100kg)",
                        "variant_name_ar": "ŸÉÿ®ÿ¥ ÿ®ŸÑÿØŸä (Ÿ®Ÿ†-Ÿ°Ÿ†Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "80-100kg",
                        "weight_range_text_ar": "Ÿ®Ÿ†-Ÿ°Ÿ†Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 90,
                        "base_price_egp": 18000,
                        "stock_available_pb": 6,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Selection Breeding Center",
                        "breed_info_en": "Breeding genetics",
                        "breed_info_ar": "Ÿàÿ±ÿßÿ´ÿ© ÿ™ÿ±ÿ®Ÿäÿ©",
                        "sort_order_type": 5,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "live_ewe_saidi_breeding",
                        "product_category": "livesheep_general",
                        "type_key": "breeding_ewes",
                        "type_name_en": "Ewes",
                        "type_name_ar": "ŸÜÿπÿßÿ¨",
                        "type_description_en": "Breeding ewes with fertility records.",
                        "type_description_ar": "ŸÜÿπÿßÿ¨ ÿ™ÿ±ÿ®Ÿäÿ© ŸÖÿπ ÿ≥ÿ¨ŸÑÿßÿ™ ÿÆÿµŸàÿ®ÿ©. ÿ£ŸÖŸáÿßÿ™ ŸÖÿπ ÿ•ŸÜÿ™ÿßÿ¨ ÿ≠ŸÑŸäÿ® ÿ¨ŸäÿØ.",
                        "variant_name_en": "Saidi Ewe (55-70kg)",
                        "variant_name_ar": "ŸÜÿπÿ¨ÿ© ÿµÿπŸäÿØŸä (Ÿ•Ÿ•-ŸßŸ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "55-70kg",
                        "weight_range_text_ar": "Ÿ•Ÿ•-ŸßŸ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 62,
                        "base_price_egp": 12000,
                        "stock_available_pb": 10,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Elite Breeding Center",
                        "breed_info_en": "High fertility proven lines",
                        "breed_info_ar": "ÿ≥ŸÑÿßŸÑÿßÿ™ ÿπÿßŸÑŸäÿ© ÿßŸÑÿÆÿµŸàÿ®ÿ© ŸÖÿ´ÿ®ÿ™ÿ©",
                        "sort_order_type": 5,
                        "sort_order_variant": 2
                },
                {
                        "item_key": "live_lambs_weaned",
                        "product_category": "livesheep_general",
                        "type_key": "young_lambs",
                        "type_name_en": "Weaned Lambs",
                        "type_name_ar": "ÿ≠ŸÖŸÑÿßŸÜ ŸÖŸÅÿ∑ŸàŸÖÿ©",
                        "type_description_en": "Weaned lambs, 3-6 months old. Vaccinated and health-checked.",
                        "type_description_ar": "ÿ≠ŸÖŸÑÿßŸÜ ŸÖŸÅÿ∑ŸàŸÖÿ©ÿå ÿπŸÖÿ± Ÿ£-Ÿ¶ ÿ£ÿ¥Ÿáÿ±ÿå ŸÑŸÑÿ™ÿ±ÿ®Ÿäÿ© ÿ£Ÿà ÿßŸÑÿ™ÿ≥ŸÖŸäŸÜ. ŸÖÿ≠ÿµŸÜÿ© ŸàŸÖŸÅÿ≠Ÿàÿµÿ© ÿµÿ≠ŸäÿßŸã.",
                        "variant_name_en": "Weaned Lamb (15-25kg)",
                        "variant_name_ar": "ÿ≠ŸÖŸÑ ŸÖŸÅÿ∑ŸàŸÖ (Ÿ°Ÿ•-Ÿ¢Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "15-25kg",
                        "weight_range_text_ar": "Ÿ°Ÿ•-Ÿ¢Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 20,
                        "base_price_egp": 4500,
                        "stock_available_pb": 35,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Young Stock Farms",
                        "breed_info_en": "3-6 months weaned",
                        "breed_info_ar": "ŸÖŸÅÿ∑ŸàŸÖ Ÿ£-Ÿ¶ ÿ£ÿ¥Ÿáÿ±",
                        "sort_order_type": 6,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "aqiqah_boy_premium",
                        "product_category": "aqiqah",
                        "type_key": "aqiqah_sheep",
                        "type_name_en": "Aqiqah for Boy",
                        "type_name_ar": "ÿπŸÇŸäŸÇÿ© ŸàŸÑÿØ",
                        "type_description_en": "Premium sheep for Aqiqah ceremony (2 sheep for boy).",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅÿßŸÜ ŸÖŸÖŸäÿ≤ÿßŸÜ ŸÑÿπŸÇŸäŸÇÿ© ÿßŸÑŸÖŸàŸÑŸàÿØ ÿßŸÑÿ∞ŸÉÿ± ÿ≠ÿ≥ÿ® ÿßŸÑÿ≥ŸÜÿ©.",
                        "variant_name_en": "Premium Package (2 sheep)",
                        "variant_name_ar": "ÿ®ÿßŸÇÿ© ŸÖŸÖŸäÿ≤ÿ© (ÿÆÿ±ŸàŸÅÿßŸÜ)",
                        "weight_range_text_en": "40-50kg each",
                        "weight_range_text_ar": "Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ ŸÑŸÉŸÑ ÿÆÿ±ŸàŸÅ",
                        "avg_weight_kg": 90,
                        "base_price_egp": 28000,
                        "stock_available_pb": 10,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Selected for Aqiqah",
                        "breed_info_en": "Healthy young sheep",
                        "breed_info_ar": "ÿÆÿ±ÿßŸÅ ÿµÿ∫Ÿäÿ±ÿ© ÿµÿ≠Ÿäÿ©",
                        "sort_order_type": 8,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "aqiqah_girl_premium",
                        "product_category": "aqiqah",
                        "type_key": "aqiqah_sheep",
                        "type_name_en": "Aqiqah for Girl",
                        "type_name_ar": "ÿπŸÇŸäŸÇÿ© ÿ®ŸÜÿ™",
                        "type_description_en": "Premium sheep for Aqiqah ceremony (1 sheep for girl).",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅ ŸÖŸÖŸäÿ≤ ŸÑÿπŸÇŸäŸÇÿ© ÿßŸÑŸÖŸàŸÑŸàÿØÿ© ÿßŸÑÿ£ŸÜÿ´Ÿâ ÿ≠ÿ≥ÿ® ÿßŸÑÿ≥ŸÜÿ©.",
                        "variant_name_en": "Single Sheep (45-55kg)",
                        "variant_name_ar": "ÿÆÿ±ŸàŸÅ Ÿàÿßÿ≠ÿØ (Ÿ§Ÿ•-Ÿ•Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "45-55kg",
                        "weight_range_text_ar": "Ÿ§Ÿ•-Ÿ•Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 50,
                        "base_price_egp": 15000,
                        "stock_available_pb": 15,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Selected for Aqiqah",
                        "breed_info_en": "Healthy young sheep",
                        "breed_info_ar": "ÿÆÿ±ŸàŸÅ ÿµÿ∫Ÿäÿ± ÿµÿ≠Ÿä",
                        "sort_order_type": 8,
                        "sort_order_variant": 2
                },
                {
                        "item_key": "charity_small",
                        "product_category": "charity",
                        "type_key": "charity_sheep",
                        "type_name_en": "Charity Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿµÿØŸÇÿ©",
                        "type_description_en": "Sheep for charity distribution.",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅ ŸÑŸÑÿµÿØŸÇÿ© ŸàÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿπŸÑŸâ ÿßŸÑŸÖÿ≠ÿ™ÿßÿ¨ŸäŸÜ.",
                        "variant_name_en": "Small (35-40kg)",
                        "variant_name_ar": "ÿµÿ∫Ÿäÿ± (Ÿ£Ÿ•-Ÿ§Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "35-40kg",
                        "weight_range_text_ar": "Ÿ£Ÿ•-Ÿ§Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 37,
                        "base_price_egp": 10000,
                        "stock_available_pb": 20,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Local Farms",
                        "breed_info_en": "For charity distribution",
                        "breed_info_ar": "ŸÑŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿÆŸäÿ±Ÿä",
                        "sort_order_type": 9,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "charity_medium",
                        "product_category": "charity",
                        "type_key": "charity_sheep",
                        "type_name_en": "Charity Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ÿµÿØŸÇÿ©",
                        "type_description_en": "Sheep for charity distribution.",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅ ŸÑŸÑÿµÿØŸÇÿ© ŸàÿßŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿπŸÑŸâ ÿßŸÑŸÖÿ≠ÿ™ÿßÿ¨ŸäŸÜ.",
                        "variant_name_en": "Medium (40-50kg)",
                        "variant_name_ar": "ŸÖÿ™Ÿàÿ≥ÿ∑ (Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "40-50kg",
                        "weight_range_text_ar": "Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 45,
                        "base_price_egp": 12500,
                        "stock_available_pb": 15,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Local Farms",
                        "breed_info_en": "For charity distribution",
                        "breed_info_ar": "ŸÑŸÑÿ™Ÿàÿ≤Ÿäÿπ ÿßŸÑÿÆŸäÿ±Ÿä",
                        "sort_order_type": 9,
                        "sort_order_variant": 2
                },
                {
                        "item_key": "vow_fulfillment",
                        "product_category": "vow",
                        "type_key": "vow_sheep",
                        "type_name_en": "Vow Fulfillment Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ŸÜÿ∞ÿ±",
                        "type_description_en": "Sheep for fulfilling religious vows.",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅ ŸÑŸàŸÅÿßÿ° ÿßŸÑŸÜÿ∞ÿ± ÿßŸÑÿ¥ÿ±ÿπŸä.",
                        "variant_name_en": "Standard (45-55kg)",
                        "variant_name_ar": "ŸÇŸäÿßÿ≥Ÿä (Ÿ§Ÿ•-Ÿ•Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "45-55kg",
                        "weight_range_text_ar": "Ÿ§Ÿ•-Ÿ•Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 50,
                        "base_price_egp": 14000,
                        "stock_available_pb": 10,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Certified Halal",
                        "breed_info_en": "For vow fulfillment",
                        "breed_info_ar": "ŸÑŸàŸÅÿßÿ° ÿßŸÑŸÜÿ∞ÿ±",
                        "sort_order_type": 10,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "expiation_sheep",
                        "product_category": "expiation",
                        "type_key": "expiation_sheep",
                        "type_name_en": "Expiation Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ŸÉŸÅÿßÿ±ÿ©",
                        "type_description_en": "Sheep for religious expiation.",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅ ŸÑŸÑŸÉŸÅÿßÿ±ÿ© ÿßŸÑÿ¥ÿ±ÿπŸäÿ©.",
                        "variant_name_en": "Standard (40-50kg)",
                        "variant_name_ar": "ŸÇŸäÿßÿ≥Ÿä (Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "40-50kg",
                        "weight_range_text_ar": "Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 45,
                        "base_price_egp": 13000,
                        "stock_available_pb": 8,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Certified Halal",
                        "breed_info_en": "For religious expiation",
                        "breed_info_ar": "ŸÑŸÑŸÉŸÅÿßÿ±ÿ© ÿßŸÑÿ¥ÿ±ÿπŸäÿ©",
                        "sort_order_type": 11,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "ready_marinated_whole",
                        "product_category": "ready_to_eat",
                        "type_key": "ready_sheep",
                        "type_name_en": "Ready Marinated Sheep",
                        "type_name_ar": "ÿÆÿ±ŸàŸÅ ŸÖÿ™ÿ®ŸÑ ÿ¨ÿßŸáÿ≤",
                        "type_description_en": "Fully marinated and ready for roasting.",
                        "type_description_ar": "ÿÆÿ±ŸàŸÅ ŸÖÿ™ÿ®ŸÑ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ Ÿàÿ¨ÿßŸáÿ≤ ŸÑŸÑÿ¥ŸàŸä.",
                        "variant_name_en": "Whole Marinated (35-45kg)",
                        "variant_name_ar": "ŸÉÿßŸÖŸÑ ŸÖÿ™ÿ®ŸÑ (Ÿ£Ÿ•-Ÿ§Ÿ• ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "35-45kg",
                        "weight_range_text_ar": "Ÿ£Ÿ•-Ÿ§Ÿ• ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 40,
                        "base_price_egp": 16000,
                        "stock_available_pb": 5,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Our Kitchen",
                        "breed_info_en": "Marinated 24hrs",
                        "breed_info_ar": "ŸÖÿ™ÿ®ŸÑ Ÿ¢Ÿ§ ÿ≥ÿßÿπÿ©",
                        "sort_order_type": 12,
                        "sort_order_variant": 1,
                        "discount_percentage": 0
                },
                {
                        "item_key": "roasted_lamb_ready",
                        "product_category": "ready_to_eat",
                        "type_key": "ready_meals",
                        "type_name_en": "Roasted Lamb",
                        "type_name_ar": "ŸÑÿ≠ŸÖ ÿßŸÑÿ∂ÿ£ŸÜ ÿßŸÑŸÖÿ¥ŸàŸä",
                        "type_description_en": "Premium roasted lamb, ready to serve.",
                        "type_description_ar": "ŸÑÿ≠ŸÖ ÿ∂ÿ£ŸÜ ŸÖÿ¥ŸàŸä ŸÅÿßÿÆÿ±ÿå ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿ™ŸÇÿØŸäŸÖ.",
                        "variant_name_en": "Full Portion (serves 4-6)",
                        "variant_name_ar": "Ÿàÿ¨ÿ®ÿ© ŸÉÿßŸÖŸÑÿ© (Ÿ§-Ÿ¶ ÿ£ÿ¥ÿÆÿßÿµ)",
                        "base_price_egp": 900,
                        "stock_available_pb": 8,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Our Kitchen",
                        "breed_info_en": "Ready to serve",
                        "breed_info_ar": "ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿ™ŸÇÿØŸäŸÖ",
                        "sort_order_type": 12,
                        "sort_order_variant": 2,
                        "discount_percentage": 15
                },
                {
                        "item_key": "shank_okra_tajin",
                        "product_category": "ready_to_eat",
                        "type_key": "ready_meals",
                        "type_name_en": "Shank Okra Tajin",
                        "type_name_ar": "ÿ∑ÿßÿ¨ŸÜ ÿßŸÑÿ®ÿßŸÖŸäÿ© ÿ®ÿßŸÑŸÖŸàÿ≤ÿ©",
                        "type_description_en": "Traditional Egyptian tajin with lamb shank and okra.",
                        "type_description_ar": "ÿ∑ÿßÿ¨ŸÜ ŸÖÿµÿ±Ÿä ÿ™ŸÇŸÑŸäÿØŸä ÿ®ŸÖŸàÿ≤ÿ© ÿßŸÑÿ∂ÿ£ŸÜ ŸàÿßŸÑÿ®ÿßŸÖŸäÿ©.",
                        "variant_name_en": "Family Size",
                        "variant_name_ar": "ÿ≠ÿ¨ŸÖ ÿπÿßÿ¶ŸÑŸä",
                        "base_price_egp": 600,
                        "stock_available_pb": 10,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Our Kitchen",
                        "breed_info_en": "Traditional recipe",
                        "breed_info_ar": "ŸàÿµŸÅÿ© ÿ™ŸÇŸÑŸäÿØŸäÿ©",
                        "sort_order_type": 12,
                        "sort_order_variant": 3,
                        "discount_percentage": 0
                },
                {
                        "item_key": "slaughtered_halves",
                        "product_category": "slaughtered",
                        "type_key": "slaughtered_sheep",
                        "type_name_en": "Slaughtered in Halves",
                        "type_name_ar": "ŸÖÿ∞ÿ®Ÿàÿ≠ ŸÜÿµŸÅŸäŸÜ",
                        "type_description_en": "Professionally slaughtered and split in two halves.",
                        "type_description_ar": "ŸÖÿ∞ÿ®Ÿàÿ≠ ÿ≠ŸÑÿßŸÑ ŸàŸÖŸÇÿ≥ŸÖ ŸÜÿµŸÅŸäŸÜ.",
                        "variant_name_en": "Two Halves (40-50kg)",
                        "variant_name_ar": "ŸÜÿµŸÅŸäŸÜ (Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "40-50kg",
                        "weight_range_text_ar": "Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 45,
                        "base_price_egp": 14500,
                        "stock_available_pb": 12,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Halal Slaughterhouse",
                        "breed_info_en": "Cut in halves",
                        "breed_info_ar": "ŸÖŸÇÿ∑ÿπ ŸÜÿµŸÅŸäŸÜ",
                        "sort_order_type": 13,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "slaughtered_quarters",
                        "product_category": "slaughtered",
                        "type_key": "slaughtered_sheep",
                        "type_name_en": "Slaughtered in Quarters",
                        "type_name_ar": "ŸÖÿ∞ÿ®Ÿàÿ≠ ÿ£ÿ±ÿ®ÿßÿπ",
                        "type_description_en": "Professionally slaughtered and cut in four parts.",
                        "type_description_ar": "ŸÖÿ∞ÿ®Ÿàÿ≠ ÿ≠ŸÑÿßŸÑ ŸàŸÖŸÇÿ≥ŸÖ ÿ£ÿ±ÿ®ÿπÿ© ÿ£ÿ¨ÿ≤ÿßÿ°.",
                        "variant_name_en": "Four Quarters (40-50kg)",
                        "variant_name_ar": "ÿ£ÿ±ÿ®ÿπ ÿ£ÿ±ÿ®ÿßÿπ (Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "40-50kg",
                        "weight_range_text_ar": "Ÿ§Ÿ†-Ÿ•Ÿ† ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 45,
                        "base_price_egp": 15000,
                        "stock_available_pb": 10,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Halal Slaughterhouse",
                        "breed_info_en": "Cut in quarters",
                        "breed_info_ar": "ŸÖŸÇÿ∑ÿπ ÿ£ÿ±ÿ®ÿßÿπ",
                        "sort_order_type": 13,
                        "sort_order_variant": 2
                },
                {
                        "item_key": "lamb_chops_premium",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_premium_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Lamb chops.",
                        "type_description_ar": "ÿ±Ÿäÿ¥ ÿ∂ÿ£ŸÜ ŸÖŸÇÿ∑ÿπÿ© ÿ∑ÿßÿ≤ÿ¨ÿ© ŸäŸàŸÖŸäÿßŸã.",
                        "price_per_kg_egp": 520,
                        "variant_name_en": "Lamb Chops (per kg)",
                        "variant_name_ar": "ÿ±Ÿäÿ¥ ÿ∂ÿßŸÜŸä (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 520,
                        "stock_available_pb": 25,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Fresh Cut Daily",
                        "breed_info_en": "Grain-fed young lamb",
                        "breed_info_ar": "ÿ∂ÿ£ŸÜ ÿµÿ∫Ÿäÿ± Ÿäÿ™ÿ∫ÿ∞Ÿâ ÿπŸÑŸâ ÿßŸÑÿ≠ÿ®Ÿàÿ®",
                        "sort_order_type": 7,
                        "sort_order_variant": 1,
                        "discount_percentage": 25
                },
                {
                        "item_key": "lamb_leg_whole",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_premium_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Whole lamb leg for roasting.",
                        "type_description_ar": "ŸÅÿÆÿ∞ÿ© ÿ∂ÿ£ŸÜ ŸÉÿßŸÖŸÑÿ© ŸÑŸÑÿ™ÿ≠ŸÖŸäÿ± ÿ£Ÿà ÿßŸÑÿ∑ÿ®ÿÆ.",
                        "variant_name_en": "Lamb Leg (2.5-4kg)",
                        "variant_name_ar": "ŸÅÿÆÿ∞ÿ© ÿ∂ÿßŸÜŸä (Ÿ¢.Ÿ•-Ÿ§ ŸÉÿ¨ŸÖ)",
                        "weight_range_text_en": "2.5-4kg",
                        "weight_range_text_ar": "Ÿ¢.Ÿ•-Ÿ§ ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 3.2,
                        "base_price_egp": 1450,
                        "stock_available_pb": 15,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Fresh Cut Daily",
                        "breed_info_en": "Premium leg cuts",
                        "breed_info_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ŸÅÿÆÿ∞",
                        "sort_order_type": 7,
                        "sort_order_variant": 2,
                        "discount_percentage": 0
                },
                {
                        "item_key": "lamb_shoulder_boneless",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_standard_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Boneless lamb shoulder for slow cooking and stews.",
                        "type_description_ar": "ŸÉÿ™ŸÅ ÿ∂ÿ£ŸÜ ÿ®ÿØŸàŸÜ ÿπÿ∏ŸÖ ŸÑŸÑÿ∑ÿ®ÿÆ ÿßŸÑÿ®ÿ∑Ÿäÿ° ŸàÿßŸÑÿ∑Ÿàÿßÿ¨ŸÜ.",
                        "variant_name_en": "Lamb Shoulder (per kg)",
                        "variant_name_ar": "ŸÉÿ™ŸÅ ÿ∂ÿßŸÜŸä (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 380,
                        "stock_available_pb": 30,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Daily Fresh Cuts",
                        "breed_info_en": "Standard quality cuts",
                        "breed_info_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ¨ŸàÿØÿ© ÿπÿßÿØŸäÿ©",
                        "sort_order_type": 8,
                        "sort_order_variant": 1,
                        "discount_percentage": 0
                },
                {
                        "item_key": "lamb_mince_fresh",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_standard_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Ground lamb mince for kofta and kebabs.",
                        "type_description_ar": "ŸÑÿ≠ŸÖ ÿ∂ÿ£ŸÜ ŸÖŸÅÿ±ŸàŸÖ ÿ∑ÿßÿ≤ÿ¨ ŸÑŸÑŸÉŸÅÿ™ÿ© ŸàÿßŸÑŸÉÿ®ÿßÿ®. ŸäŸÅÿ±ŸÖ ÿ∑ÿßÿ≤ÿ¨ ŸäŸàŸÖŸäÿßŸã.",
                        "variant_name_en": "Lamb Mince (per kg)",
                        "variant_name_ar": "ŸÑÿ≠ŸÖ ÿ∂ÿßŸÜŸä ŸÖŸÅÿ±ŸàŸÖ (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 350,
                        "stock_available_pb": 40,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Daily Fresh Ground",
                        "breed_info_en": "Fresh daily grinding",
                        "breed_info_ar": "ŸÅÿ±ŸÖ ÿ∑ÿßÿ≤ÿ¨ ŸäŸàŸÖŸäÿßŸã",
                        "sort_order_type": 8,
                        "sort_order_variant": 2,
                        "discount_percentage": 15
                },
                {
                        "item_key": "mutton_stew_cuts",
                        "product_category": "meat_cuts",
                        "type_key": "mutton_cuts",
                        "type_name_en": "Mutton Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ŸÑÿ≠ŸÖ ÿßŸÑÿ∫ŸÜŸÖ",
                        "type_description_en": "Mutton stew cuts from mature sheep.",
                        "type_description_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ŸÑÿ≠ŸÖ ÿ∫ŸÜŸÖ ŸÑŸÑÿ∑Ÿàÿßÿ¨ŸÜ ŸÖŸÜ ÿ£ÿ∫ŸÜÿßŸÖ ŸÜÿßÿ∂ÿ¨ÿ©.",
                        "variant_name_en": "Mutton Stew Cuts (per kg)",
                        "variant_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∑ÿßÿ¨ŸÜ ŸÑÿ≠ŸÖ ÿ∫ŸÜŸÖ (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 320,
                        "stock_available_pb": 20,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Traditional Cuts",
                        "breed_info_en": "Mature sheep cuts",
                        "breed_info_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ£ÿ∫ŸÜÿßŸÖ ŸÜÿßÿ∂ÿ¨ÿ©",
                        "sort_order_type": 9,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "lamb_ribs_rack",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_premium_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Premium rack of lamb ribs.",
                        "type_description_ar": "ÿ±Ÿäÿ¥ ÿ∂ÿ£ŸÜ ŸÖŸÖŸäÿ≤ÿ© ŸÑŸÑÿ¥ŸàŸä.",
                        "variant_name_en": "Rack of Ribs (per kg)",
                        "variant_name_ar": "ÿ±Ÿäÿ¥ (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 480,
                        "stock_available_pb": 20,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Fresh Cut Daily",
                        "breed_info_en": "Premium ribs",
                        "breed_info_ar": "ÿ±Ÿäÿ¥ ŸÖŸÖŸäÿ≤ÿ©",
                        "sort_order_type": 7,
                        "sort_order_variant": 4
                },
                {
                        "item_key": "lamb_shank",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_premium_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Lamb shank/forearm.",
                        "type_description_ar": "ÿ≤ŸÜÿØ ÿ∂ÿ£ŸÜ ŸÑŸÑÿ∑ÿ®ÿÆ ÿßŸÑÿ®ÿ∑Ÿäÿ°.",
                        "variant_name_en": "Lamb Shank (per piece)",
                        "variant_name_ar": "ÿ≤ŸÜÿØ ÿ∂ÿßŸÜŸä (ÿ®ÿßŸÑŸÇÿ∑ÿπÿ©)",
                        "weight_range_text_en": "0.8-1.2kg",
                        "weight_range_text_ar": "Ÿ†.Ÿ®-Ÿ°.Ÿ¢ ŸÉÿ¨ŸÖ",
                        "avg_weight_kg": 1,
                        "base_price_egp": 380,
                        "stock_available_pb": 25,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Fresh Cut Daily",
                        "breed_info_en": "For slow cooking",
                        "breed_info_ar": "ŸÑŸÑÿ∑ÿ®ÿÆ ÿßŸÑÿ®ÿ∑Ÿäÿ°",
                        "sort_order_type": 7,
                        "sort_order_variant": 5
                },
                {
                        "item_key": "lamb_neck",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_standard_cuts",
                        "type_name_en": "Lamb Cuts",
                        "type_name_ar": "ŸÇÿ∑ÿπŸäÿßÿ™ ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Lamb neck for stewing.",
                        "type_description_ar": "ÿ±ŸÇÿ®ÿ© ÿ∂ÿ£ŸÜ ŸÑŸÑÿ∑ÿ®ÿÆ ŸàÿßŸÑŸÖÿ±ŸÇ.",
                        "variant_name_en": "Lamb Neck (per kg)",
                        "variant_name_ar": "ÿ±ŸÇÿ®ÿ© ÿ∂ÿßŸÜŸä (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 320,
                        "stock_available_pb": 30,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Fresh Cut Daily",
                        "breed_info_en": "For stewing",
                        "breed_info_ar": "ŸÑŸÑÿ∑ÿ®ÿÆ",
                        "sort_order_type": 8,
                        "sort_order_variant": 3
                },
                {
                        "item_key": "lamb_liver_fresh",
                        "product_category": "meat_cuts",
                        "type_key": "lamb_offal",
                        "type_name_en": "Lamb Offal",
                        "type_name_ar": "ÿ£ÿ≠ÿ¥ÿßÿ° ÿ∂ÿ£ŸÜ",
                        "type_description_en": "Fresh lamb liver.",
                        "type_description_ar": "ŸÉÿ®ÿØÿ© ÿ∂ÿ£ŸÜ ÿ∑ÿßÿ≤ÿ¨ÿ©.",
                        "variant_name_en": "Fresh Liver (per kg)",
                        "variant_name_ar": "ŸÉÿ®ÿØÿ© ÿ∂ÿßŸÜŸâ (ŸÑŸÑŸÉŸäŸÑŸà)",
                        "weight_range_text_en": "Per kg",
                        "weight_range_text_ar": "ŸÑŸÑŸÉŸäŸÑŸà",
                        "base_price_egp": 280,
                        "stock_available_pb": 15,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Fresh Daily",
                        "breed_info_en": "Fresh offal",
                        "breed_info_ar": "ÿ£ÿ≠ÿ¥ÿßÿ° ÿ∑ÿßÿ≤ÿ¨ÿ©",
                        "sort_order_type": 14,
                        "sort_order_variant": 1
                },
                {
                        "item_key": "gathering_small_family",
                        "product_category": "gathering_package",
                        "type_key": "family_packages",
                        "type_name_en": "Family Packages",
                        "type_name_ar": "ÿ®ÿßŸÇÿßÿ™ ÿπÿßÿ¶ŸÑŸäÿ©",
                        "type_description_en": "Family gathering packages with lamb, rice, salads, and bread.",
                        "type_description_ar": "ÿ®ÿßŸÇÿßÿ™ ÿ™ÿ¨ŸÖÿπÿßÿ™ ÿπÿßÿ¶ŸÑŸäÿ© ÿ™ÿ¥ŸÖŸÑ ÿ∂ÿ£ŸÜ Ÿàÿ£ÿ±ÿ≤ Ÿàÿ≥ŸÑÿ∑ÿßÿ™ ŸàÿÆÿ®ÿ≤.",
                        "variant_name_en": "Family Small (8-12 people)",
                        "variant_name_ar": "ÿπÿßÿ¶ŸÑŸä ÿµÿ∫Ÿäÿ± (Ÿ®-Ÿ°Ÿ¢ ŸÅÿ±ÿØ)",
                        "base_price_egp": 8500,
                        "stock_available_pb": 12,
                        "is_active": true,
                        "is_premium": false,
                        "origin_farm": "Complete Service",
                        "breed_info_en": "Full service package",
                        "breed_info_ar": "ÿ®ÿßŸÇÿ© ÿÆÿØŸÖÿ© ŸÉÿßŸÖŸÑÿ©",
                        "sort_order_type": 10,
                        "sort_order_variant": 1,
                        "discount_percentage": 10
                },
                {
                        "item_key": "gathering_medium_celebration",
                        "product_category": "gathering_package",
                        "type_key": "celebration_packages",
                        "type_name_en": "Celebration Packages",
                        "type_name_ar": "ÿ®ÿßŸÇÿßÿ™ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßŸÑÿßÿ™",
                        "type_description_en": "Celebration packages with whole sheep, side dishes, desserts, and service.",
                        "type_description_ar": "ÿ®ÿßŸÇÿßÿ™ ÿßÿ≠ÿ™ŸÅÿßŸÑÿßÿ™ ŸÑŸÑÿ£ŸÅÿ±ÿßÿ≠ ŸàÿßŸÑÿ™ÿÆÿ±ÿ¨ ŸàÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿßÿ™. ÿ™ÿ¥ŸÖŸÑ ÿÆÿ±ŸàŸÅ ŸÖÿ¨Ÿáÿ≤ Ÿàÿ£ÿ∑ÿ®ÿßŸÇ ÿ¨ÿßŸÜÿ®Ÿäÿ© Ÿàÿ≠ŸÑŸàŸäÿßÿ™ ŸàÿÆÿØŸÖÿ©.",
                        "variant_name_en": "Celebration Medium (20-30 people)",
                        "variant_name_ar": "ÿßÿ≠ÿ™ŸÅÿßŸÑ ŸÖÿ™Ÿàÿ≥ÿ∑ (Ÿ¢Ÿ†-Ÿ£Ÿ† ŸÅÿ±ÿØ)",
                        "base_price_egp": 18500,
                        "stock_available_pb": 8,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Premium Catering",
                        "breed_info_en": "Full celebration service",
                        "breed_info_ar": "ÿÆÿØŸÖÿ© ÿßÿ≠ÿ™ŸÅÿßŸÑ ŸÉÿßŸÖŸÑÿ©",
                        "sort_order_type": 11,
                        "sort_order_variant": 1,
                        "discount_percentage": 0
                },
                {
                        "item_key": "gathering_large_wedding",
                        "product_category": "gathering_package",
                        "type_key": "wedding_packages",
                        "type_name_en": "Wedding Packages",
                        "type_name_ar": "ÿ®ÿßŸÇÿßÿ™ ÿ£ŸÅÿ±ÿßÿ≠",
                        "type_description_en": "Wedding packages with multiple sheep, buffet, Egyptian dishes, and event management.",
                        "type_description_ar": "ÿ®ÿßŸÇÿßÿ™ ÿ£ŸÅÿ±ÿßÿ≠ ŸàŸÖŸÜÿßÿ≥ÿ®ÿßÿ™ ŸÉÿ®ÿ±Ÿâ. ÿπÿØÿ© ÿ£ÿ∫ŸÜÿßŸÖÿå ÿ•ÿπÿØÿßÿØ ÿ®ŸàŸÅŸäŸáÿå ÿ£ÿ∑ÿ®ÿßŸÇ ŸÖÿµÿ±Ÿäÿ©ÿå ÿ∑ÿßŸÇŸÖ ÿÆÿØŸÖÿ©ÿå Ÿàÿ•ÿØÿßÿ±ÿ© ŸÖŸÜÿßÿ≥ÿ®ÿßÿ™.",
                        "variant_name_en": "Wedding Large (50-80 people)",
                        "variant_name_ar": "ŸÅÿ±ÿ≠ ŸÉÿ®Ÿäÿ± (Ÿ•Ÿ†-Ÿ®Ÿ† ŸÅÿ±ÿØ)",
                        "base_price_egp": 45000,
                        "stock_available_pb": 4,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "Luxury Events",
                        "breed_info_en": "Full event management",
                        "breed_info_ar": "ÿ•ÿØÿßÿ±ÿ© ŸÖŸÜÿßÿ≥ÿ®ÿßÿ™ ŸÉÿßŸÖŸÑÿ©",
                        "sort_order_type": 11,
                        "sort_order_variant": 2,
                        "discount_percentage": 0
                },
                {
                        "item_key": "bbq_premium_mixed",
                        "product_category": "gathering_package",
                        "type_key": "bbq_packages",
                        "type_name_en": "BBQ & Grill Packages",
                        "type_name_ar": "ÿ®ÿßŸÇÿßÿ™ ÿßŸÑÿ¥Ÿàÿßÿ° ŸàÿßŸÑŸÖÿ¥ÿßŸàŸä",
                        "type_description_en": "BBQ packages with mixed grilled meats, kebabs, kofta, and chicken.",
                        "type_description_ar": "ÿ®ÿßŸÇÿßÿ™ ÿ¥Ÿàÿßÿ° ŸÖÿπ ŸÑÿ≠ŸàŸÖ ŸÖÿ¥ŸàŸäÿ© ŸÖÿÆÿ™ŸÑÿ∑ÿ© ŸàŸÉÿ®ÿßÿ® ŸàŸÉŸÅÿ™ÿ© ŸàÿØÿ¨ÿßÿ¨.",
                        "variant_name_en": "BBQ (15-25 people)",
                        "variant_name_ar": "ÿ¥Ÿàÿßÿ° (Ÿ°Ÿ•-Ÿ¢Ÿ• ŸÅÿ±ÿØ)",
                        "base_price_egp": 12500,
                        "stock_available_pb": 10,
                        "is_active": true,
                        "is_premium": true,
                        "origin_farm": "BBQ Specialists",
                        "breed_info_en": "Mixed grill specialties",
                        "breed_info_ar": "ŸÖÿ¥ÿßŸàŸä ŸÖÿÆÿ™ŸÑÿ∑ÿ©",
                        "sort_order_type": 12,
                        "sort_order_variant": 1,
                        "discount_percentage": 30
                }
        ],
        "users": [
                {
                        "email": "admin@sheep.land",
                        "password": "admin123456",
                        "passwordConfirm": "admin123456",
                        "name": "Admin User",
                        "phone": "+201234567890",
                        "country": "Egypt",
                        "preferred_currency": "EGP",
                        "is_admin": true,
                        "verified": true
                },
                {
                        "email": "user@example.com",
                        "password": "user123456",
                        "passwordConfirm": "user123456",
                        "name": "Test User",
                        "phone": "+201098765432",
                        "country": "Egypt",
                        "preferred_currency": "EGP",
                        "is_admin": false,
                        "verified": true
                }
        ]
};

    // PocketBase API-compliant validation functions
    // Based on official PocketBase API documentation
    const VALID_FIELD_TYPES = [
        'text', 'email', 'url', 'number', 'bool', 'date', 'select', 'json', 
        'file', 'relation', 'user', 'editor', 'autodate', 'password'
    ];
    
    // Additional field validation constraints from API docs
    const FIELD_CONSTRAINTS = {
        text: { maxLength: 5000 },
        email: { maxLength: 320 },
        url: { maxLength: 2048 },
        password: { minLength: 8, maxLength: 255 },
        select: { maxValues: 100, maxSelect: 100 },
        file: { maxSelect: 99, maxSize: 5368709120 }, // 5GB in bytes
        relation: { maxSelect: 100, maxDepth: 6 },
        json: { maxSize: 65536 } // 64KB for JSON fields
    };
    
    const VALID_COLLECTION_TYPES = ['base', 'auth', 'view'];
    
    function validateCollections(jsonText) {
        try {
            const collections = JSON.parse(jsonText);
            
            if (!Array.isArray(collections)) {
                return { valid: false, message: "‚ùå Must be an array of collections", details: null };
            }
            
            if (collections.length === 0) {
                return { valid: false, message: "‚ùå At least one collection required", details: null };
            }
            
            const requiredCollections = ['settings', 'products', 'users', 'orders'];
            const foundCollections = collections.map(c => c.name);
            const missingCollections = requiredCollections.filter(name => !foundCollections.includes(name));
            
            if (missingCollections.length > 0) {
                return { valid: false, message: `‚ùå Missing required collections: ${missingCollections.join(', ')}`, details: null };
            }
            
            // Validate each collection against PocketBase API specs
            for (const collection of collections) {
                const validation = validateSingleCollection(collection);
                if (!validation.valid) {
                    return validation;
                }
            }
            
            return { valid: true, message: `‚úÖ Valid collections structure (${collections.length} collections)`, details: { count: collections.length, names: foundCollections } };
            
        } catch (error) {
            return { valid: false, message: `‚ùå JSON Parse Error: ${error.message}`, details: error };
        }
    }
    
    function validateSingleCollection(collection) {
        // Validate required collection properties
        if (!collection.name || typeof collection.name !== 'string') {
            return { valid: false, message: "‚ùå Collection missing valid 'name' field", details: collection };
        }
        
        // Collection name validation (PocketBase requirements)
        if (!/^[a-zA-Z0-9_]+$/.test(collection.name) || collection.name.length < 1 || collection.name.length > 32) {
            return { valid: false, message: `‚ùå Collection '${collection.name}' has invalid name (alphanumeric + underscore, 1-32 chars)`, details: collection };
        }
        
        if (!collection.type || !VALID_COLLECTION_TYPES.includes(collection.type)) {
            return { valid: false, message: `‚ùå Collection '${collection.name}' has invalid type (must be: ${VALID_COLLECTION_TYPES.join(', ')})`, details: collection };
        }
        
        if (!Array.isArray(collection.fields)) {
            return { valid: false, message: `‚ùå Collection '${collection.name}' missing fields array`, details: collection };
        }
        
        // Validate system property
        if (collection.system !== undefined && typeof collection.system !== 'boolean') {
            return { valid: false, message: `‚ùå Collection '${collection.name}' system property must be boolean`, details: collection };
        }
        
        // Validate API rules (can be null, empty string, or valid rule string)
        const rules = ['listRule', 'viewRule', 'createRule', 'updateRule', 'deleteRule'];
        for (const rule of rules) {
            if (collection[rule] !== undefined && collection[rule] !== null && typeof collection[rule] !== 'string') {
                return { valid: false, message: `‚ùå Collection '${collection.name}' ${rule} must be string or null`, details: collection };
            }
            
            // Enhanced API rule syntax validation
            if (collection[rule] && typeof collection[rule] === 'string') {
                const ruleValidation = validateAPIRule(collection[rule], rule, collection.name);
                if (!ruleValidation.valid) {
                    return { valid: false, message: ruleValidation.message, details: ruleValidation.details || collection };
                }
            }
        }
        
        // Validate auth collection options
        if (collection.type === 'auth' && collection.options) {
            const authValidation = validateAuthOptions(collection.options, collection.name);
            if (!authValidation.valid) {
                return authValidation;
            }
        }
        
        // Validate fields
        for (let i = 0; i < collection.fields.length; i++) {
            const fieldValidation = validateField(collection.fields[i], collection.name, i);
            if (!fieldValidation.valid) {
                return fieldValidation;
            }
        }
        
        // Validate collection-specific requirements
        const specificValidation = validateCollectionSpecificRequirements(collection);
        if (!specificValidation.valid) {
            return specificValidation;
        }
        
        return { valid: true, message: `‚úÖ Collection '${collection.name}' is valid`, details: null };
    }
    
    function validateField(field, collectionName, index) {
        if (!field.name || typeof field.name !== 'string') {
            return { valid: false, message: `‚ùå Field ${index + 1} in '${collectionName}' missing valid name`, details: field };
        }
        
        // Field name validation
        if (!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(field.name) || field.name.length > 64) {
            return { valid: false, message: `‚ùå Field '${field.name}' has invalid name (must start with letter, alphanumeric + underscore, max 64 chars)`, details: field };
        }
        
        if (!field.type || !VALID_FIELD_TYPES.includes(field.type)) {
            return { valid: false, message: `‚ùå Field '${field.name}' has invalid type (must be: ${VALID_FIELD_TYPES.join(', ')})`, details: field };
        }
        
        // Type-specific validation based on PocketBase API documentation
        switch (field.type) {
            case 'text':
                if (field.min !== undefined && (typeof field.min !== 'number' || field.min < 0)) {
                    return { valid: false, message: `‚ùå Text field '${field.name}' min must be positive number`, details: field };
                }
                if (field.max !== undefined && (typeof field.max !== 'number' || field.max < 1 || field.max > FIELD_CONSTRAINTS.text.maxLength)) {
                    return { valid: false, message: `‚ùå Text field '${field.name}' max must be 1-${FIELD_CONSTRAINTS.text.maxLength}`, details: field };
                }
                if (field.pattern !== undefined && typeof field.pattern !== 'string') {
                    return { valid: false, message: `‚ùå Text field '${field.name}' pattern must be valid regex string`, details: field };
                }
                break;
                
            case 'email':
                if (field.max !== undefined && field.max > FIELD_CONSTRAINTS.email.maxLength) {
                    return { valid: false, message: `‚ùå Email field '${field.name}' max length cannot exceed ${FIELD_CONSTRAINTS.email.maxLength}`, details: field };
                }
                if (field.exceptDomains !== undefined && !Array.isArray(field.exceptDomains)) {
                    return { valid: false, message: `‚ùå Email field '${field.name}' exceptDomains must be array`, details: field };
                }
                if (field.onlyDomains !== undefined && !Array.isArray(field.onlyDomains)) {
                    return { valid: false, message: `‚ùå Email field '${field.name}' onlyDomains must be array`, details: field };
                }
                break;
                
            case 'url':
                if (field.max !== undefined && field.max > FIELD_CONSTRAINTS.url.maxLength) {
                    return { valid: false, message: `‚ùå URL field '${field.name}' max length cannot exceed ${FIELD_CONSTRAINTS.url.maxLength}`, details: field };
                }
                break;
                
            case 'password':
                if (field.min !== undefined && field.min < FIELD_CONSTRAINTS.password.minLength) {
                    return { valid: false, message: `‚ùå Password field '${field.name}' min must be at least ${FIELD_CONSTRAINTS.password.minLength}`, details: field };
                }
                if (field.max !== undefined && field.max > FIELD_CONSTRAINTS.password.maxLength) {
                    return { valid: false, message: `‚ùå Password field '${field.name}' max cannot exceed ${FIELD_CONSTRAINTS.password.maxLength}`, details: field };
                }
                if (field.pattern !== undefined && typeof field.pattern !== 'string') {
                    return { valid: false, message: `‚ùå Password field '${field.name}' pattern must be valid regex string`, details: field };
                }
                break;
                
            case 'number':
                if (field.min !== undefined && typeof field.min !== 'number') {
                    return { valid: false, message: `‚ùå Number field '${field.name}' min must be number`, details: field };
                }
                if (field.max !== undefined && typeof field.max !== 'number') {
                    return { valid: false, message: `‚ùå Number field '${field.name}' max must be number`, details: field };
                }
                if (field.noDecimal !== undefined && typeof field.noDecimal !== 'boolean') {
                    return { valid: false, message: `‚ùå Number field '${field.name}' noDecimal must be boolean`, details: field };
                }
                break;
                
            case 'bool':
                // Boolean fields don't have additional constraints
                break;
                
            case 'date':
                if (field.min !== undefined && typeof field.min !== 'string') {
                    return { valid: false, message: `‚ùå Date field '${field.name}' min must be ISO date string`, details: field };
                }
                if (field.max !== undefined && typeof field.max !== 'string') {
                    return { valid: false, message: `‚ùå Date field '${field.name}' max must be ISO date string`, details: field };
                }
                break;
                
            case 'select':
                if (!Array.isArray(field.values) || field.values.length === 0) {
                    return { valid: false, message: `‚ùå Select field '${field.name}' must have non-empty values array`, details: field };
                }
                if (field.values.length > FIELD_CONSTRAINTS.select.maxValues) {
                    return { valid: false, message: `‚ùå Select field '${field.name}' cannot have more than ${FIELD_CONSTRAINTS.select.maxValues} values`, details: field };
                }
                if (field.maxSelect !== undefined && (typeof field.maxSelect !== 'number' || field.maxSelect < 1 || field.maxSelect > FIELD_CONSTRAINTS.select.maxSelect)) {
                    return { valid: false, message: `‚ùå Select field '${field.name}' maxSelect must be 1-${FIELD_CONSTRAINTS.select.maxSelect}`, details: field };
                }
                break;
                
            case 'json':
                if (field.maxSize !== undefined && field.maxSize > FIELD_CONSTRAINTS.json.maxSize) {
                    return { valid: false, message: `‚ùå JSON field '${field.name}' maxSize cannot exceed ${FIELD_CONSTRAINTS.json.maxSize} bytes`, details: field };
                }
                break;
                
            case 'file':
                if (field.maxSelect !== undefined && (typeof field.maxSelect !== 'number' || field.maxSelect < 1 || field.maxSelect > FIELD_CONSTRAINTS.file.maxSelect)) {
                    return { valid: false, message: `‚ùå File field '${field.name}' maxSelect must be 1-${FIELD_CONSTRAINTS.file.maxSelect}`, details: field };
                }
                if (field.maxSize !== undefined && (typeof field.maxSize !== 'number' || field.maxSize < 1 || field.maxSize > FIELD_CONSTRAINTS.file.maxSize)) {
                    return { valid: false, message: `‚ùå File field '${field.name}' maxSize must be 1-${FIELD_CONSTRAINTS.file.maxSize} bytes`, details: field };
                }
                if (field.mimeTypes !== undefined && !Array.isArray(field.mimeTypes)) {
                    return { valid: false, message: `‚ùå File field '${field.name}' mimeTypes must be array`, details: field };
                }
                if (field.thumbs !== undefined && !Array.isArray(field.thumbs)) {
                    return { valid: false, message: `‚ùå File field '${field.name}' thumbs must be array`, details: field };
                }
                break;
                
            case 'relation':
                if (!field.collectionId || typeof field.collectionId !== 'string') {
                    return { valid: false, message: `‚ùå Relation field '${field.name}' must have collectionId`, details: field };
                }
                if (field.cascadeDelete !== undefined && typeof field.cascadeDelete !== 'boolean') {
                    return { valid: false, message: `‚ùå Relation field '${field.name}' cascadeDelete must be boolean`, details: field };
                }
                if (field.minSelect !== undefined && (typeof field.minSelect !== 'number' || field.minSelect < 0)) {
                    return { valid: false, message: `‚ùå Relation field '${field.name}' minSelect must be non-negative number`, details: field };
                }
                if (field.maxSelect !== undefined && (typeof field.maxSelect !== 'number' || field.maxSelect < 1 || field.maxSelect > FIELD_CONSTRAINTS.relation.maxSelect)) {
                    return { valid: false, message: `‚ùå Relation field '${field.name}' maxSelect must be 1-${FIELD_CONSTRAINTS.relation.maxSelect}`, details: field };
                }
                if (field.displayFields !== undefined && !Array.isArray(field.displayFields)) {
                    return { valid: false, message: `‚ùå Relation field '${field.name}' displayFields must be array`, details: field };
                }
                break;
                
            case 'user':
                // User fields inherit from relation field constraints
                if (field.maxSelect !== undefined && (typeof field.maxSelect !== 'number' || field.maxSelect < 1 || field.maxSelect > FIELD_CONSTRAINTS.relation.maxSelect)) {
                    return { valid: false, message: `‚ùå User field '${field.name}' maxSelect must be 1-${FIELD_CONSTRAINTS.relation.maxSelect}`, details: field };
                }
                if (field.displayFields !== undefined && !Array.isArray(field.displayFields)) {
                    return { valid: false, message: `‚ùå User field '${field.name}' displayFields must be array`, details: field };
                }
                break;
                
            case 'editor':
                if (field.convertURLs !== undefined && typeof field.convertURLs !== 'boolean') {
                    return { valid: false, message: `‚ùå Editor field '${field.name}' convertURLs must be boolean`, details: field };
                }
                break;
                
            case 'autodate':
                if (field.onCreate !== undefined && typeof field.onCreate !== 'boolean') {
                    return { valid: false, message: `‚ùå Autodate field '${field.name}' onCreate must be boolean`, details: field };
                }
                if (field.onUpdate !== undefined && typeof field.onUpdate !== 'boolean') {
                    return { valid: false, message: `‚ùå Autodate field '${field.name}' onUpdate must be boolean`, details: field };
                }
                break;
        }
        
        // Common field properties validation
        if (field.required !== undefined && typeof field.required !== 'boolean') {
            return { valid: false, message: `‚ùå Field '${field.name}' required must be boolean`, details: field };
        }
        
        if (field.presentable !== undefined && typeof field.presentable !== 'boolean') {
            return { valid: false, message: `‚ùå Field '${field.name}' presentable must be boolean`, details: field };
        }
        
        if (field.unique !== undefined && typeof field.unique !== 'boolean') {
            return { valid: false, message: `‚ùå Field '${field.name}' unique must be boolean`, details: field };
        }
        
        return { valid: true, message: `‚úÖ Field '${field.name}' is valid`, details: null };
    }
    
    function validateAuthOptions(options, collectionName) {
        // Enhanced auth options based on PocketBase API documentation
        const validOptions = [
            'allowEmailAuth', 'allowUsernameAuth', 'allowOAuth2Auth', 
            'requireEmailVerification', 'exceptEmailDomains', 'onlyEmailDomains',
            'minPasswordLength', 'manageRule', 'emailVisibility', 'onlyVerified',
            'allowPasswordAuth', 'allowOAuth2Auth', 'allowUsernameAuth',
            'requireOTP', 'allowOTP', 'otpDuration', 'otpEmailTemplate',
            'verificationTemplate', 'resetPasswordTemplate', 'confirmEmailChangeTemplate'
        ];
        
        for (const key in options) {
            if (!validOptions.includes(key)) {
                return { valid: false, message: `‚ùå Auth collection '${collectionName}' has invalid option: ${key}`, details: options };
            }
        }
        
        // Comprehensive auth options validation based on PocketBase API
        const booleanOptions = [
            'allowEmailAuth', 'allowUsernameAuth', 'allowOAuth2Auth', 'allowPasswordAuth',
            'requireEmailVerification', 'emailVisibility', 'onlyVerified', 
            'requireOTP', 'allowOTP'
        ];
        
        for (const option of booleanOptions) {
            if (options[option] !== undefined && typeof options[option] !== 'boolean') {
                return { valid: false, message: `‚ùå Auth collection '${collectionName}' ${option} must be boolean`, details: options };
            }
        }
        
        if (options.minPasswordLength !== undefined && (typeof options.minPasswordLength !== 'number' || options.minPasswordLength < 5 || options.minPasswordLength > 255)) {
            return { valid: false, message: `‚ùå Auth collection '${collectionName}' minPasswordLength must be 5-255`, details: options };
        }
        
        if (options.otpDuration !== undefined && (typeof options.otpDuration !== 'number' || options.otpDuration < 60 || options.otpDuration > 86400)) {
            return { valid: false, message: `‚ùå Auth collection '${collectionName}' otpDuration must be 60-86400 seconds`, details: options };
        }
        
        const arrayOptions = ['exceptEmailDomains', 'onlyEmailDomains'];
        for (const option of arrayOptions) {
            if (options[option] !== undefined && !Array.isArray(options[option])) {
                return { valid: false, message: `‚ùå Auth collection '${collectionName}' ${option} must be array`, details: options };
            }
        }
        
        const stringOptions = ['manageRule', 'otpEmailTemplate', 'verificationTemplate', 'resetPasswordTemplate', 'confirmEmailChangeTemplate'];
        for (const option of stringOptions) {
            if (options[option] !== undefined && typeof options[option] !== 'string') {
                return { valid: false, message: `‚ùå Auth collection '${collectionName}' ${option} must be string`, details: options };
            }
        }
        
        return { valid: true, message: `‚úÖ Auth options valid`, details: null };
    }
    
    function validateCollectionSpecificRequirements(collection) {
        // Validate collection-specific business logic
        switch (collection.name) {
            case 'products':
                const requiredProductFields = ['item_key', 'product_category', 'variant_name_en', 'base_price_egp', 'stock_available_pb'];
                const fieldNames = collection.fields.map(f => f.name);
                const missingFields = requiredProductFields.filter(name => !fieldNames.includes(name));
                if (missingFields.length > 0) {
                    return { valid: false, message: `‚ùå Products collection missing critical fields: ${missingFields.join(', ')}`, details: collection };
                }
                
                // Check for unique constraint on item_key
                const itemKeyField = collection.fields.find(f => f.name === 'item_key');
                if (!itemKeyField.unique) {
                    return { valid: false, message: `‚ùå Products collection item_key field must be unique`, details: collection };
                }
                break;
                
            case 'orders':
                const requiredOrderFields = ['order_id_text', 'customer_name', 'customer_email', 'total_amount_due_egp'];
                const orderFieldNames = collection.fields.map(f => f.name);
                const missingOrderFields = requiredOrderFields.filter(name => !orderFieldNames.includes(name));
                if (missingOrderFields.length > 0) {
                    return { valid: false, message: `‚ùå Orders collection missing critical fields: ${missingOrderFields.join(', ')}`, details: collection };
                }
                break;
                
            case 'settings':
                const requiredSettingsFields = ['xchgRates', 'defCurr', 'servFeeEGP'];
                const settingsFieldNames = collection.fields.map(f => f.name);
                const missingSettingsFields = requiredSettingsFields.filter(name => !settingsFieldNames.includes(name));
                if (missingSettingsFields.length > 0) {
                    return { valid: false, message: `‚ùå Settings collection missing critical fields: ${missingSettingsFields.join(', ')}`, details: collection };
                }
                break;
        }
        
        return { valid: true, message: `‚úÖ Collection-specific requirements met`, details: null };
    }
    
    // Enhanced validation for API rules based on PocketBase filter syntax
    function validateAPIRule(rule, ruleName, collectionName) {
        if (!rule || rule === '') return { valid: true, message: '‚úÖ Empty rule is valid' };
        
        // Basic syntax validation for PocketBase filter rules
        const validOperators = ['=', '!=', '>', '<', '>=', '<=', '~', '!~', '?=', '?!=', '?>', '?<', '?>=', '?<=', '?~', '?!~'];
        const validLogicals = ['&&', '||'];
        
        // Check for common rule patterns
        const commonPatterns = [
            /@request\.auth\.id/,
            /@request\.auth\.verified/,
            /@request\.auth\.admin/,
            /@request\.query\./,
            /@request\.data\./,
            /@collection\./,
            /^\s*$/,  // empty rule
            /^""$|^''$/  // empty string rule
        ];
        
        // Validate that rule contains valid PocketBase syntax
        let hasValidPattern = false;
        for (const pattern of commonPatterns) {
            if (pattern.test(rule)) {
                hasValidPattern = true;
                break;
            }
        }
        
        // Check for field references (basic validation)
        const fieldReferencePattern = /\w+\s*[=!<>~?]+/;
        if (fieldReferencePattern.test(rule)) {
            hasValidPattern = true;
        }
        
        if (!hasValidPattern && rule.trim() !== '') {
            return { 
                valid: false, 
                message: `‚ö†Ô∏è ${ruleName} in '${collectionName}' may have invalid syntax - use @request.auth.*, field references, or collection patterns`,
                details: { rule, suggestion: 'Common patterns: @request.auth.id != "", field = value, @request.auth.collectionName = "_superusers"' }
            };
        }
        
        return { valid: true, message: `‚úÖ ${ruleName} syntax appears valid` };
    }
    
    // Validate record data against collection schema
    function validateRecordData(record, collectionFields, collectionName) {
        const errors = [];
        const warnings = [];
        
        // Check required fields
        const requiredFields = collectionFields.filter(f => f.required);
        for (const field of requiredFields) {
            if (record[field.name] === undefined || record[field.name] === null || record[field.name] === '') {
                errors.push(`Required field '${field.name}' is missing or empty`);
            }
        }
        
        // Validate field types and constraints
        for (const [fieldName, value] of Object.entries(record)) {
            // Skip system fields
            if (['id', 'created', 'updated', 'collectionId', 'collectionName'].includes(fieldName)) {
                continue;
            }
            
            const fieldDef = collectionFields.find(f => f.name === fieldName);
            if (!fieldDef) {
                warnings.push(`Field '${fieldName}' not defined in collection schema`);
                continue;
            }
            
            const validation = validateFieldValue(value, fieldDef, fieldName);
            if (!validation.valid) {
                errors.push(validation.message);
            }
        }
        
        return {
            valid: errors.length === 0,
            errors,
            warnings,
            message: errors.length === 0 ? 
                `‚úÖ Record data valid for '${collectionName}'` : 
                `‚ùå Record validation failed: ${errors.slice(0, 3).join(', ')}${errors.length > 3 ? '...' : ''}`
        };
    }
    
    // Validate individual field values
    function validateFieldValue(value, fieldDef, fieldName) {
        if (value === null || value === undefined) {
            return fieldDef.required ? 
                { valid: false, message: `Required field '${fieldName}' cannot be null/undefined` } :
                { valid: true };
        }
        
        switch (fieldDef.type) {
            case 'text':
            case 'email':
            case 'url':
            case 'password':
            case 'editor':
                if (typeof value !== 'string') {
                    return { valid: false, message: `Field '${fieldName}' must be string` };
                }
                if (fieldDef.min && value.length < fieldDef.min) {
                    return { valid: false, message: `Field '${fieldName}' too short (min: ${fieldDef.min})` };
                }
                if (fieldDef.max && value.length > fieldDef.max) {
                    return { valid: false, message: `Field '${fieldName}' too long (max: ${fieldDef.max})` };
                }
                break;
                
            case 'number':
                if (typeof value !== 'number' && !Number.isFinite(Number(value))) {
                    return { valid: false, message: `Field '${fieldName}' must be a valid number` };
                }
                const numValue = Number(value);
                if (fieldDef.min !== undefined && numValue < fieldDef.min) {
                    return { valid: false, message: `Field '${fieldName}' below minimum (${fieldDef.min})` };
                }
                if (fieldDef.max !== undefined && numValue > fieldDef.max) {
                    return { valid: false, message: `Field '${fieldName}' above maximum (${fieldDef.max})` };
                }
                break;
                
            case 'bool':
                if (typeof value !== 'boolean') {
                    return { valid: false, message: `Field '${fieldName}' must be boolean` };
                }
                break;
                
            case 'date':
            case 'autodate':
                if (typeof value === 'string') {
                    const date = new Date(value);
                    if (isNaN(date.getTime())) {
                        return { valid: false, message: `Field '${fieldName}' must be valid ISO date` };
                    }
                } else if (!(value instanceof Date)) {
                    return { valid: false, message: `Field '${fieldName}' must be date string or Date object` };
                }
                break;
                
            case 'select':
                if (Array.isArray(value)) {
                    if (fieldDef.maxSelect && value.length > fieldDef.maxSelect) {
                        return { valid: false, message: `Field '${fieldName}' too many selections (max: ${fieldDef.maxSelect})` };
                    }
                    for (const item of value) {
                        if (!fieldDef.values.includes(item)) {
                            return { valid: false, message: `Field '${fieldName}' contains invalid value: ${item}` };
                        }
                    }
                } else {
                    if (!fieldDef.values.includes(value)) {
                        return { valid: false, message: `Field '${fieldName}' invalid value: ${value}` };
                    }
                }
                break;
                
            case 'json':
                try {
                    if (typeof value === 'string') {
                        JSON.parse(value);
                    } else if (typeof value !== 'object') {
                        return { valid: false, message: `Field '${fieldName}' must be valid JSON` };
                    }
                } catch {
                    return { valid: false, message: `Field '${fieldName}' contains invalid JSON` };
                }
                break;
                
            case 'file':
                if (Array.isArray(value)) {
                    if (fieldDef.maxSelect && value.length > fieldDef.maxSelect) {
                        return { valid: false, message: `Field '${fieldName}' too many files (max: ${fieldDef.maxSelect})` };
                    }
                }
                break;
        }
        
        return { valid: true };
    }
    
    function validateSeedData(jsonText) {
        try {
            const seedData = JSON.parse(jsonText);
            
            if (!seedData || typeof seedData !== 'object') {
                return { valid: false, message: "‚ùå Must be an object", details: null };
            }
            
            const requiredSections = ['settings', 'products'];
            const foundSections = Object.keys(seedData);
            const missingSections = requiredSections.filter(name => !foundSections.includes(name));
            
            if (missingSections.length > 0) {
                return { valid: false, message: `‚ùå Missing required sections: ${missingSections.join(', ')}`, details: null };
            }
            
            // Validate settings
            if (!Array.isArray(seedData.settings) || seedData.settings.length === 0) {
                return { valid: false, message: "‚ùå Settings must be non-empty array", details: null };
            }
            
            const settings = seedData.settings[0];
            const requiredSettingsFields = ['xchgRates', 'defCurr', 'servFeeEGP'];
            const missingSettingsFields = requiredSettingsFields.filter(field => !(field in settings));
            
            if (missingSettingsFields.length > 0) {
                return { valid: false, message: `‚ùå Settings missing fields: ${missingSettingsFields.join(', ')}`, details: settings };
            }
            
            // Validate products
            if (!Array.isArray(seedData.products)) {
                return { valid: false, message: "‚ùå Products must be an array", details: null };
            }
            
            if (seedData.products.length === 0) {
                return { valid: true, message: "‚ö†Ô∏è Valid structure, but no products defined", details: { productsCount: 0, settingsValid: true } };
            }
            
            // Enhanced product structure validation with field type checking
            for (let i = 0; i < Math.min(3, seedData.products.length); i++) {
                const product = seedData.products[i];
                const requiredProductFields = ['item_key', 'product_category', 'variant_name_en', 'base_price_egp'];
                const missingProductFields = requiredProductFields.filter(field => !(field in product));
                
                if (missingProductFields.length > 0) {
                    return { valid: false, message: `‚ùå Product ${i + 1} missing fields: ${missingProductFields.join(', ')}`, details: product };
                }
                
                // Validate field types for critical fields
                if (typeof product.item_key !== 'string' || product.item_key.length === 0) {
                    return { valid: false, message: `‚ùå Product ${i + 1} item_key must be non-empty string`, details: product };
                }
                
                if (typeof product.base_price_egp !== 'number' || product.base_price_egp < 0) {
                    return { valid: false, message: `‚ùå Product ${i + 1} base_price_egp must be positive number`, details: product };
                }
                
                const validCategories = ['udheya', 'meat_cuts', 'gathering_package', 'breeding_stock', 'feed_supplies'];
                if (!validCategories.includes(product.product_category)) {
                    return { valid: false, message: `‚ùå Product ${i + 1} invalid product_category: ${product.product_category}`, details: product };
                }
                
                // Validate stock if present
                if (product.stock_available_pb !== undefined && (typeof product.stock_available_pb !== 'number' || product.stock_available_pb < 0)) {
                    return { valid: false, message: `‚ùå Product ${i + 1} stock_available_pb must be non-negative number`, details: product };
                }
            }
            
            return { valid: true, message: `‚úÖ Valid seed data (${seedData.products.length} products, settings configured)`, details: { productsCount: seedData.products.length, sectionsCount: foundSections.length } };
            
        } catch (error) {
            return { valid: false, message: `‚ùå JSON Parse Error: ${error.message}`, details: error };
        }
    }
    
    function updateValidationDisplay(validationDiv, textarea, result) {
        validationDiv.innerHTML = '';
        
        const statusSpan = document.createElement('span');
        statusSpan.textContent = result.message;
        
        if (result.valid) {
            statusSpan.className = 'validation-success';
            textarea.className = textarea.className.replace(' textarea-invalid', '') + ' textarea-valid';
        } else {
            statusSpan.className = 'validation-error';
            textarea.className = textarea.className.replace(' textarea-valid', '') + ' textarea-invalid';
        }
        
        validationDiv.appendChild(statusSpan);
        
        if (result.details && !result.valid) {
            const detailsDiv = document.createElement('div');
            detailsDiv.className = 'validation-info';
            detailsDiv.style.marginTop = '2px';
            
            if (result.details.suggestion) {
                detailsDiv.textContent = `üí° ${result.details.suggestion}`;
            } else {
                detailsDiv.textContent = `üí° Check: ${JSON.stringify(result.details).substring(0, 100)}...`;
            }
            validationDiv.appendChild(detailsDiv);
        }
        
        // Show validation summary for successful validations
        if (result.valid && result.details && (result.details.count || result.details.productsCount)) {
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'validation-info';
            summaryDiv.style.marginTop = '2px';
            
            if (result.details.count) {
                summaryDiv.textContent = `üìä Collections: ${result.details.names ? result.details.names.join(', ') : result.details.count}`;
            } else if (result.details.productsCount !== undefined) {
                summaryDiv.textContent = `üì¶ Products: ${result.details.productsCount}, Sections: ${result.details.sectionsCount || 'N/A'}`;
            }
            validationDiv.appendChild(summaryDiv);
        }
    }
    
    // Live validation event listeners
    collectionsTextarea.addEventListener('input', () => {
        const result = validateCollections(collectionsTextarea.value);
        updateValidationDisplay(collectionsValidationDiv, collectionsTextarea, result);
        
        // Enable/disable buttons based on validation
        const isValid = result.valid;
        runFullSetupButton.disabled = !isValid;
        runSchemaOnlyButton.disabled = !isValid;
    });
    
    seedTextarea.addEventListener('input', () => {
        const result = validateSeedData(seedTextarea.value);
        updateValidationDisplay(seedValidationDiv, seedTextarea, result);
    });
    
    // Populate textareas with default data and validate immediately
    collectionsTextarea.value = JSON.stringify(collectionsDefinition, null, 2);
    seedTextarea.value = JSON.stringify(seedData, null, 2);
    
    // Check if PocketBase is already set up
    async function checkPocketBaseStatus() {
        try {
            const response = await fetch('/api/health');
            if (response.ok) {
                const setupInfo = document.createElement('div');
                setupInfo.className = 'setup-info';
                setupInfo.innerHTML = `
                    <p><strong>‚úÖ PocketBase is already running!</strong></p>
                    <p>It appears PocketBase is already configured and running. You can:</p>
                    <div style="margin-top: 8px;">
                        <button onclick="window.location.href='/'">üè† Go to Main Site</button>
                        <button onclick="window.location.href='/_'">‚öôÔ∏è Open PocketBase Admin</button>
                        <button onclick="this.parentElement.parentElement.style.display='none'">üîß Continue with Setup (Advanced)</button>
                    </div>
                `;
                document.querySelector('.c').insertBefore(setupInfo, document.querySelector('.c').children[1]);
            }
        } catch (error) {
            // PocketBase not running, which is expected for initial setup
            console.log('PocketBase not detected, ready for initial setup');
        }
    }
    
    checkPocketBaseStatus();
    
    // Trigger initial validation
    setTimeout(() => {
        collectionsTextarea.dispatchEvent(new Event('input'));
        seedTextarea.dispatchEvent(new Event('input'));
    }, 100);

    async function safeExecute(operation, operationName, pbInstance = null) {
        const pb = pbInstance || new PocketBase(pbUrl);
        try {
            log(`üöÄ Starting ${operationName}...`, 'i');
            const result = await operation(pb);
            log(`‚úÖ ${operationName} completed successfully.`, 's');
            return { success: true, result };
        } catch (error) {
            log(`‚ùå ${operationName} FAILED: ${error.message}`, 'e');
            console.error(`${operationName} error:`, error);
            if (error.response && error.response.data) {
                log('üìã Server error details:', 'e', error.response.data);
            } else if (error.data) {
                 log('üìã Error details:', 'e', error.data);
            }
            return { success: false, error };
        } finally {
            if (pbInstance === null && pb.authStore.isValid && pb.authStore.record?.collectionName === '_superusers') {
                log(`üîí Clearing temporary admin auth after ${operationName}`, 'd');
                pb.authStore.clear();
            }
        }
    }

    async function setupSchema(pb) {
        if (!await authenticateAdmin(pb)) return false;

        log('üìã Processing collections (settings, products, users, orders)...', 'i');
        
        let collectionsToUse;
        try {
            collectionsToUse = JSON.parse(collectionsTextarea.value);
        } catch (e) {
            log('‚ùå Invalid Collections JSON: ' + e.message, 'e');
            return false;
        }
        
        if (!await importOrUpdateCollections(pb, collectionsToUse)) { 
             log('‚ùå Collection setup failed.', 'e'); 
             return false;
        }
        
        log('üîó Processing relation fields for "orders" collection...', 'i');
        if (!await addOrVerifyRelationFields(pb)) {
             log('‚ùå Relation field setup for "orders" failed.', 'e'); 
             return false;
        }

        log('‚úÖ Schema setup phase completed successfully.', 's');
        return true;
    }
    
    async function importOrUpdateCollections(pb, collectionsToProcess) {
        log('üìã Starting collection schema setup/update...', 'i');
        
        // First pass: create all collections without relation fields
        const collectionIdMap = {};
        
        // Get existing collections first
        try {
            const existingCollections = await pb.collections.getFullList();
            existingCollections.forEach(col => {
                collectionIdMap[col.name] = col.id;
                // Also map _pb_users_auth_ to users for backward compatibility
                if (col.name === '_pb_users_auth_') {
                    collectionIdMap['users'] = col.id;
                    log('üìå Found legacy _pb_users_auth_ collection, mapping to users', 'i');
                }
            });
        } catch (e) {
            log('‚ö†Ô∏è Could not fetch existing collections', 'w');
        }
        
        // First pass - create collections without relation fields
        for (const collectionDef of collectionsToProcess) {
            let existingCollection = null;
            const isAuthCollection = collectionDef.name === "users";
            const collectionNameToUse = collectionDef.name;

            try {
                // Special handling for users collection - check both names
                if (collectionNameToUse === 'users') {
                    try {
                        existingCollection = await pb.collections.getOne('_pb_users_auth_');
                        log(`üîÑ Found legacy _pb_users_auth_ collection, will update as users...`, 'i');
                    } catch {
                        existingCollection = await pb.collections.getOne('users');
                        log(`üîÑ Collection "users" exists. Updating...`, 'i');
                    }
                } else {
                    existingCollection = await pb.collections.getOne(collectionNameToUse);
                    log(`üîÑ Collection "${collectionNameToUse}" exists. Updating...`, 'i');
                }
                
                // For existing collections, we need to handle relation fields separately
                const fieldsWithoutRelations = collectionDef.fields.filter(f => f.type !== 'relation');
                
                const updatePayload = {
                    listRule: collectionDef.listRule,
                    viewRule: collectionDef.viewRule,
                    createRule: collectionDef.createRule,
                    updateRule: collectionDef.updateRule,
                    deleteRule: collectionDef.deleteRule,
                    fields: fieldsWithoutRelations,
                };
                
                if (isAuthCollection && collectionDef.options) { 
                    updatePayload.options = { ... (existingCollection.options || {}), ...collectionDef.options };
                }
                
                // Use the actual collection name (might be _pb_users_auth_ for users)
                const actualCollectionName = existingCollection.name || collectionNameToUse;
                await pb.collections.update(actualCollectionName, updatePayload);
                log(`‚úÖ Collection "${actualCollectionName}" updated successfully.`, 's');

            } catch (e) {
                if (e.status === 404 && !isAuthCollection) { 
                    log(`‚ûï Collection "${collectionDef.name}" not found. Creating...`, 'i');
                    try {
                        // Filter out relation fields for initial creation
                        const fieldsWithoutRelations = collectionDef.fields.filter(f => f.type !== 'relation');
                        
                        // For collections with relation fields, temporarily simplify rules
                        const hasRelationFields = collectionDef.fields.some(f => f.type === 'relation');
                        const needsSimplifiedRules = hasRelationFields && 
                            (collectionDef.listRule?.includes(' = user') || 
                             collectionDef.viewRule?.includes(' = user') ||
                             collectionDef.updateRule?.includes(' = user') ||
                             collectionDef.deleteRule?.includes(' = user'));
                        
                        const newCollectionData = {
                            name: collectionDef.name,
                            type: collectionDef.type,
                            system: collectionDef.system || false,
                            fields: fieldsWithoutRelations, 
                            listRule: needsSimplifiedRules ? "@request.auth.id != ''" : (collectionDef.listRule !== undefined ? collectionDef.listRule : null),
                            viewRule: needsSimplifiedRules ? "@request.auth.id != ''" : (collectionDef.viewRule !== undefined ? collectionDef.viewRule : null),
                            createRule: collectionDef.createRule !== undefined ? collectionDef.createRule : null,
                            updateRule: needsSimplifiedRules ? "@request.auth.id != ''" : (collectionDef.updateRule !== undefined ? collectionDef.updateRule : null),
                            deleteRule: needsSimplifiedRules ? "@request.auth.id != ''" : (collectionDef.deleteRule !== undefined ? collectionDef.deleteRule : null),
                            options: collectionDef.options || {} 
                        };
                        
                        const createdCollection = await pb.collections.create(newCollectionData); 
                        collectionIdMap[collectionDef.name] = createdCollection.id;
                        log(`‚úÖ Collection "${collectionDef.name}" created successfully.`, 's');
                    } catch (createError) {
                        log(`‚ùå Error CREATING collection "${collectionDef.name}": ${createError.message}`, 'e', createError.data || createError);
                        return false; 
                    }
                } else { 
                    log(`‚ùå Error processing collection "${collectionNameToUse}": ${e.message}`, 'e', e.data || e);
                    return false; 
                }
            }
            await new Promise(r => setTimeout(r, 150));
        }
        
        // Second pass - add relation fields now that all collections exist
        log('üîó Adding relation fields...', 'i');
        for (const collectionDef of collectionsToProcess) {
            const relationFields = collectionDef.fields.filter(f => f.type === 'relation');
            if (relationFields.length > 0) {
                try {
                    // Map collection names to IDs in relation fields
                    const mappedRelationFields = relationFields.map(field => {
                        const mappedField = { ...field };
                        if (mappedField.collectionId && collectionIdMap[mappedField.collectionId]) {
                            mappedField.collectionId = collectionIdMap[mappedField.collectionId];
                        }
                        // Set default values for required relation properties
                        if (mappedField.type === 'relation') {
                            mappedField.cascadeDelete = mappedField.cascadeDelete !== undefined ? mappedField.cascadeDelete : false;
                            mappedField.minSelect = mappedField.minSelect !== undefined ? mappedField.minSelect : null;
                            mappedField.maxSelect = mappedField.maxSelect !== undefined ? mappedField.maxSelect : 1;
                            mappedField.displayFields = mappedField.displayFields || [];
                        }
                        return mappedField;
                    });
                    
                    // Get current collection fields (handle legacy _pb_users_auth_)
                    let currentCollection;
                    let actualCollectionName = collectionDef.name;
                    
                    if (collectionDef.name === 'users') {
                        try {
                            currentCollection = await pb.collections.getOne('_pb_users_auth_');
                            actualCollectionName = '_pb_users_auth_';
                        } catch {
                            currentCollection = await pb.collections.getOne('users');
                        }
                    } else {
                        currentCollection = await pb.collections.getOne(collectionDef.name);
                    }
                    
                    const allFields = [...currentCollection.fields, ...mappedRelationFields];
                    
                    // Update collection with relation fields
                    await pb.collections.update(actualCollectionName, { fields: allFields });
                    log(`‚úÖ Added relation fields to "${collectionDef.name}"`, 's');
                } catch (e) {
                    log(`‚ùå Error adding relation fields to "${collectionDef.name}": ${e.message}`, 'e');
                }
            }
        }
        
        // Third pass - update rules that reference relation fields
        log('üìè Updating collection rules...', 'i');
        for (const collectionDef of collectionsToProcess) {
            const hasRelationFields = collectionDef.fields.some(f => f.type === 'relation');
            const needsRuleUpdate = hasRelationFields && 
                (collectionDef.listRule?.includes(' = user') || 
                 collectionDef.viewRule?.includes(' = user') ||
                 collectionDef.updateRule?.includes(' = user') ||
                 collectionDef.deleteRule?.includes(' = user'));
            
            if (needsRuleUpdate) {
                try {
                    let actualCollectionName = collectionDef.name;
                    
                    // Handle legacy _pb_users_auth_
                    if (collectionDef.name === 'users') {
                        try {
                            await pb.collections.getOne('_pb_users_auth_');
                            actualCollectionName = '_pb_users_auth_';
                        } catch {
                            // Use users if _pb_users_auth_ doesn't exist
                        }
                    }
                    
                    const ruleUpdate = {
                        listRule: collectionDef.listRule,
                        viewRule: collectionDef.viewRule,
                        createRule: collectionDef.createRule,
                        updateRule: collectionDef.updateRule,
                        deleteRule: collectionDef.deleteRule
                    };
                    
                    await pb.collections.update(actualCollectionName, ruleUpdate);
                    log(`‚úÖ Updated rules for "${collectionDef.name}"`, 's');
                } catch (e) {
                    log(`‚ùå Error updating rules for "${collectionDef.name}": ${e.message}`, 'e');
                }
            }
        }
        
        log('‚úÖ Collection schema processing finished.', 's');
        return true;
    }
    
    async function addOrVerifyRelationFields(pb) {
        log('üîó Adding/Verifying relation fields...', 'i');
        let overallSuccess = true;
        
        let usersCollectionId;
        try {
            const usersCollection = await pb.collections.getOne("users");
            usersCollectionId = usersCollection.id;
            log(`‚úÖ Found users collection ID: ${usersCollectionId}`, 'd');
        } catch (error) {
            log(`‚ùå Failed to get users collection: ${error.message}`, 'e');
            return false;
        }
        
        const relationsToAdd = [
            { 
                sourceCollectionName: "orders", 
                fieldName: "user", 
                targetCollectionId: usersCollectionId,
                cascadeDelete: false, 
                minSelect: null, 
                maxSelect: 1, 
                displayFields: ["email", "name"],
                required: false, 
                presentable: true
            }
        ];

        for (const rel of relationsToAdd) {
            try {
                const sourceCollection = await pb.collections.getOne(rel.sourceCollectionName);
                let fields = sourceCollection.fields || [];
                const fieldExists = fields.find(f => f.name === rel.fieldName && f.type === "relation");

                if (fieldExists) {
                    log(`‚ö†Ô∏è Relation field "${rel.fieldName}" already exists.`, 'w');
                    continue;
                }
                
                const newField = {
                    name: rel.fieldName,
                    type: "relation",
                    required: rel.required,
                    presentable: rel.presentable,
                    collectionId: rel.targetCollectionId,
                    cascadeDelete: rel.cascadeDelete,
                    minSelect: rel.minSelect,
                    maxSelect: rel.maxSelect,
                    displayFields: rel.displayFields 
                };
                
                fields.push(newField);
                await pb.collections.update(sourceCollection.id, { fields: fields });
                log(`‚úÖ Relation field "${rel.fieldName}" added to "${rel.sourceCollectionName}" successfully.`, 's');
                
                if (rel.sourceCollectionName === "orders") {
                    log('üîÑ Updating orders collection API rules with user field references...', 'i');
                    await pb.collections.update(sourceCollection.id, {
                        listRule: "(@request.auth.id != '' && user = @request.auth.id) || (@request.query.lookupOrderID != '' && order_id_text = @request.query.lookupOrderID) || @request.auth.collectionName = '_superusers'",
                        viewRule: "(@request.auth.id != '' && user = @request.auth.id) || (@request.query.lookupOrderID != '' && order_id_text = @request.query.lookupOrderID) || @request.auth.collectionName = '_superusers'"
                    });
                    log('‚úÖ Orders collection API rules updated successfully.', 's');
                }

            } catch (error) {
                log(`‚ùå Error adding relation field "${rel.fieldName}" to "${rel.sourceCollectionName}": ${error.message}`, 'e', error.data || error);
                overallSuccess = false;
            }
            await new Promise(r => setTimeout(r, 150)); 
        }
        return overallSuccess;
    }

    async function seedCollectionData(pb, collectionName, seedItems, uniqueKeyField = null) {
        log(`üå± Seeding data for ${collectionName}...`, 'i');
        let createdCount = 0, updatedCount = 0, errorCount = 0;
        
        for (const item of seedItems) {
            try {
                let existingRecord = null;
                if (uniqueKeyField && item[uniqueKeyField] !== undefined) { 
                    try { 
                        existingRecord = await pb.collection(collectionName).getFirstListItem(`${uniqueKeyField}="${pb.utils.escapeFilterValue(item[uniqueKeyField])}"`); 
                    } catch (e) { }
                } else if (!uniqueKeyField && collectionName === "settings") { 
                    const list = await pb.collection(collectionName).getList(1, 1);
                    if (list.items.length > 0) existingRecord = list.items[0];
                }

                if (existingRecord) {
                    await pb.collection(collectionName).update(existingRecord.id, item);
                    updatedCount++;
                } else {
                    // Special handling for auth collections (users)
                    if (collectionName === "users") {
                        // For auth collections, we need to ensure password fields are handled correctly
                        const userData = { ...item };
                        if (userData.password && !userData.passwordConfirm) {
                            userData.passwordConfirm = userData.password;
                        }
                        await pb.collection(collectionName).create(userData);
                    } else {
                        await pb.collection(collectionName).create(item);
                    }
                    createdCount++;
                }
            } catch (error) {
                log(`‚ùå Error processing item in ${collectionName}: ${error.message}`, 'e');
                if (error.data) {
                    log(`   Details: ${JSON.stringify(error.data)}`, 'd');
                }
                errorCount++;
            }
        }
        log(`üìä Seeding ${collectionName} complete. Created: ${createdCount}, Updated: ${updatedCount}, Errors: ${errorCount}`, errorCount > 0 ? 'w' : 's');
        return { created: createdCount, updated: updatedCount, errors: errorCount };
    }

    async function setupSeedData(pb) {
        log('üå± === SEED DATA PHASE ===', 'i');
        if (!await authenticateAdmin(pb)) return false;

        log('‚è≥ Pausing for 1 second before seeding...', 'i');
        await new Promise(resolve => setTimeout(resolve, 1000));

        let seedDataToUse;
        try {
            seedDataToUse = JSON.parse(seedTextarea.value);
        } catch (e) {
            log('‚ùå Invalid Seed Data JSON: ' + e.message, 'e');
            return false;
        }

        let anySeedErrors = false;
        const settingsResult = await seedCollectionData(pb, 'settings', seedDataToUse.settings);
        if(settingsResult.errors > 0) anySeedErrors = true;

        const productsResult = await seedCollectionData(pb, 'products', seedDataToUse.products, 'item_key');
        if(productsResult.errors > 0) anySeedErrors = true;
        
        // Seed users (if present in seed data)
        if (seedDataToUse.users && Array.isArray(seedDataToUse.users)) {
            log('üë• Seeding users...', 'i');
            const usersResult = await seedCollectionData(pb, 'users', seedDataToUse.users, 'email');
            if(usersResult.errors > 0) anySeedErrors = true;
            
            // Log admin user info
            const adminUsers = seedDataToUse.users.filter(u => u.is_admin === true);
            if (adminUsers.length > 0) {
                log('üîë Admin users created:', 's');
                adminUsers.forEach(admin => {
                    log(`   ‚Ä¢ ${admin.email} (password: ${admin.password})`, 'i');
                });
                log('üìå To access admin panel: Add #admin to the URL', 'i');
            }
        }
        
        if (anySeedErrors) {
            log('‚ö†Ô∏è Seed data setup completed with errors.', 'w');
            return false; 
        }
        log('‚úÖ Seed data setup completed successfully.', 's');
        return true;
    }

    runFullSetupButton.onclick = async () => {
        [runFullSetupButton, runSchemaOnlyButton, runSeedOnlyButton].forEach(b => b.disabled = true);
        outputDiv.innerHTML = ''; 
        log('üöÄ === FULL SETUP PROCESS STARTED ===', 'i');
        pbUrl = pbUrlInput.value;
        const pb = new PocketBase(pbUrl);
        let schemaSuccess = false;
        
        try {
            const schemaResult = await safeExecute(async (pbInstance) => setupSchema(pbInstance), "Schema Setup", pb);
            schemaSuccess = schemaResult.success;

            if (!schemaSuccess) {
                log('‚ùå Schema setup failed, aborting full setup', 'e');
            } else {
                const seedResult = await safeExecute(async (pbInstance) => setupSeedData(pbInstance), "Seed Data", pb);
                log('üéâ === FULL SETUP COMPLETED ===', seedResult.success ? 's' : 'w');
            }
        } catch (error) {
            log(`üí• CRITICAL ERROR during full setup: ${error.message}`, 'e');
        } finally {
            if (pb.authStore.isValid && pb.authStore.record?.collectionName === '_superusers') pb.authStore.clear();
            [runFullSetupButton, runSchemaOnlyButton].forEach(b => b.disabled = false);
             runSeedOnlyButton.disabled = !schemaSuccess; 
        }
    };

    runSchemaOnlyButton.onclick = async () => {
        [runFullSetupButton, runSchemaOnlyButton, runSeedOnlyButton].forEach(b => b.disabled = true);
        outputDiv.innerHTML = ''; 
        log('üìã === SCHEMA ONLY SETUP STARTED ===', 'i');
        pbUrl = pbUrlInput.value;
        const pb = new PocketBase(pbUrl);
        let success = false;
        
        try {
            const schemaResult = await safeExecute(async (pbInstance) => setupSchema(pbInstance), "Schema Setup", pb);
            success = schemaResult.success;
            log('üìã Schema setup completed', success ? 's' : 'e');
        } catch (error) {
            log(`‚ùå ERROR during schema setup: ${error.message}`, 'e');
        } finally {
            if (pb.authStore.isValid && pb.authStore.record?.collectionName === '_superusers') pb.authStore.clear();
            [runFullSetupButton, runSchemaOnlyButton].forEach(b => b.disabled = false);
            runSeedOnlyButton.disabled = !success;
        }
    };

    runSeedOnlyButton.onclick = async () => {
        [runFullSetupButton, runSchemaOnlyButton, runSeedOnlyButton].forEach(b => b.disabled = true);
        outputDiv.innerHTML = ''; 
        log('üå± === SEED DATA ONLY STARTED ===', 'i');
        pbUrl = pbUrlInput.value;
        const pb = new PocketBase(pbUrl);
        
        try {
            const seedResult = await safeExecute(async (pbInstance) => setupSeedData(pbInstance), "Seed Data", pb);
            log('üå± Seed data setup completed', seedResult.success ? 's' : 'w');
        } catch (error) {
            log(`‚ùå ERROR during seed setup: ${error.message}`, 'e');
        } finally {
            if (pb.authStore.isValid && pb.authStore.record?.collectionName === '_superusers') pb.authStore.clear();
            [runFullSetupButton, runSchemaOnlyButton, runSeedOnlyButton].forEach(b => b.disabled = false);
        }
    };
    
    // Help button event listener
    document.getElementById('showHelp').onclick = () => {
        document.getElementById('helpModal').style.display = 'block';
    };
    
    // Close modal when clicking outside
    document.getElementById('helpModal').onclick = (e) => {
        if (e.target.id === 'helpModal') {
            document.getElementById('helpModal').style.display = 'none';
        }
    };
    
    // ESC key to close modal
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('helpModal').style.display === 'block') {
            document.getElementById('helpModal').style.display = 'none';
        }
    });
</script>
</body>
</html>
