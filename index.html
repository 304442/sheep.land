<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sheep Land - Udheya Booking</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Kufi+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style> [x-cloak] { display: none !important; } </style>
</head>
<body x-data="udheyaBooking" x-init="initApp()" x-cloak>

    <!-- Loading and API Error Indicators -->
    <div x-show="isLoading.init && !apiError" class="global-loading-indicator">
        Loading application data... Please wait.
    </div>
    <div x-show="apiError" class="global-error-indicator" x-text="'Error: ' + apiError + ' Please check setup.'"></div>

    <header class="site-header">
        <div class="c nav-container">
            <a href="index.html" class="brand-logo" @click.prevent="isMobileMenuOpen = false; scrollToSection('body')">
                <span class="en">Sheep Land</span><span class="ar" dir="rtl">ุฃุฑุถ ุงูุฃุบูุงู</span>
            </a>
            <nav class="main-nav desktop-nav">
                <ul class="nav-list">
                    <li><a href="#udheya-booking-start" class="nav-link" @click.prevent="scrollToSection('#udheya-booking-start')"><span class="en">Book Udheya</span><span class="ar">ุญุฌุฒ ุงูุฃุถุญูุฉ</span></a></li>
                    <li><a href="#how-it-works" class="nav-link" @click.prevent="scrollToSection('#how-it-works')"><span class="en">Our Process</span><span class="ar">ุนูููุชูุง</span></a></li>
                    <li><a href="#check-booking-status" class="nav-link" @click.prevent="scrollToSection('#check-booking-status')"><span class="en">Check Status</span><span class="ar">ุชุญูู ูู ุงูุญุงูุฉ</span></a></li>
                </ul>
            </nav>
            <div class="header-extras desktop-extras">
                <div class="currency-switcher">
                    <label for="currency-select-desktop" class="sr-only">Select Currency</label>
                    <select id="currency-select-desktop" name="currency" x-model="currentCurrency">
                        <template x-for="code in Object.keys(appSettings.exchange_rates)" :key="code"><option :value="code" x-text="code"></option></template>
                    </select>
                </div>
                <div class="whatsapp-contact">
                    <a :href="'https://wa.me/' + (appSettings.whatsapp_number_raw || '201234567890')" target="_blank" rel="noopener noreferrer" title="Chat on WhatsApp">
                        <svg class="whatsapp-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.35 3.43 16.84L2.05 22l5.26-1.39c1.44.75 3.05 1.18 4.73 1.18 5.46 0 9.91-4.45 9.91-9.91S17.5 2 12.04 2zm0 18.13c-1.48 0-2.91-.38-4.15-1.08l-.34-.2-3.14.83.85-3.05-.22-.35A8.04 8.04 0 0 1 3.79 11.91c0-4.41 3.72-8.13 8.25-8.13s8.25 3.72 8.25 8.13-3.72 8.13-8.25 8.13zm5.32-5.68c-.25-.13-1.55-.76-1.79-.85s-.42-.13-.6.12c-.17.25-.67.85-.82 1.02s-.3.18-.55.06c-.25-.12-1.11-.41-2.15-1.33S10.08 13 9.91 12.74s.13-.24.26-.37c.11-.11.25-.29.39-.46s.05-.11.18-.36c.13-.25.08-.43 0-.55s-.56-1.39-.79-1.94c-.23-.55-.45-.49-.62-.49h-.17c-.16 0-.42.05-.64.3s-.85.82-.85 2.02S8.11 13.5 8.24 13.67s1.47 2.28 3.74 3.2c.5.25.93.4 1.26.51.52.15.94.12 1.27.07.38-.06 1.07-.44 1.27-.81.2-.38.2-.7.15-.82s-.15-.07-.4-.18z"/></svg>
                        <span class="whatsapp-number" x-text="appSettings.whatsapp_number_display || '+20 11 17117489'"></span>
                    </a>
                </div>
            </div>
            <button class="hamburger-btn" @click="isMobileMenuOpen = !isMobileMenuOpen" aria-label="Toggle menu" :aria-expanded="isMobileMenuOpen.toString()">
                <svg viewBox="0 0 24 24" fill="currentColor" width="28" height="28">
                    <path x-show="!isMobileMenuOpen" d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" style="display:none;"></path>
                    <path x-show="isMobileMenuOpen" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" style="display:none;"></path>
                </svg>
            </button>
        </div>
        <div class="mobile-nav-menu" x-show="isMobileMenuOpen" x-transition @click.outside="isMobileMenuOpen = false" style="display:none;">
            <ul class="nav-list-mobile">
                <li><a href="#udheya-booking-start" class="nav-link-mobile" @click="isMobileMenuOpen = false; scrollToSection('#udheya-booking-start')"><span class="en">Book Udheya</span><span class="ar">ุญุฌุฒ ุงูุฃุถุญูุฉ</span></a></li>
                <li><a href="#how-it-works" class="nav-link-mobile" @click="isMobileMenuOpen = false; scrollToSection('#how-it-works')"><span class="en">Our Process</span><span class="ar">ุนูููุชูุง</span></a></li>
                <li><a href="#check-booking-status" class="nav-link-mobile" @click="isMobileMenuOpen = false; scrollToSection('#check-booking-status')"><span class="en">Check Status</span><span class="ar">ุชุญูู ูู ุงูุญุงูุฉ</span></a></li>
            </ul>
            <div class="mobile-header-extras">
                <div class="currency-switcher">
                    <label for="currency-select-mobile" class="sr-only">Select Currency</label>
                    <select id="currency-select-mobile" name="currency_mobile" x-model="currentCurrency">
                        <template x-for="code in Object.keys(appSettings.exchange_rates)" :key="code"><option :value="code" x-text="code"></option></template>
                    </select>
                </div>
                <div class="whatsapp-contact">
                     <a :href="'https://wa.me/' + (appSettings.whatsapp_number_raw || '201234567890')" target="_blank" rel="noopener noreferrer" title="Chat on WhatsApp" @click="isMobileMenuOpen = false">
                        <svg class="whatsapp-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.35 3.43 16.84L2.05 22l5.26-1.39c1.44.75 3.05 1.18 4.73 1.18 5.46 0 9.91-4.45 9.91-9.91S17.5 2 12.04 2zm0 18.13c-1.48 0-2.91-.38-4.15-1.08l-.34-.2-3.14.83.85-3.05-.22-.35A8.04 8.04 0 0 1 3.79 11.91c0-4.41 3.72-8.13 8.25-8.13s8.25 3.72 8.25 8.13-3.72 8.13-8.25 8.13zm5.32-5.68c-.25-.13-1.55-.76-1.79-.85s-.42-.13-.6.12c-.17.25-.67.85-.82 1.02s-.3.18-.55.06c-.25-.12-1.11-.41-2.15-1.33S10.08 13 9.91 12.74s.13-.24.26-.37c.11-.11.25-.29.39-.46s.05-.11.18-.36c.13-.25.08-.43 0-.55s-.56-1.39-.79-1.94c-.23-.55-.45-.49-.62-.49h-.17c-.16 0-.42.05-.64.3s-.85.82-.85 2.02S8.11 13.5 8.24 13.67s1.47 2.28 3.74 3.2c.5.25.93.4 1.26.51.52.15.94.12 1.27.07.38-.06 1.07-.44 1.27-.81.2-.38.2-.7.15-.82s-.15-.07-.4-.18z"/></svg>
                        <span class="whatsapp-number" x-text="appSettings.whatsapp_number_display || '+20 11 17117489'"></span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="hero-section sec">
            <div class="c tc">
                <div class="hero-title-row"><h1><span class="en">Book Your Udhiya Online</span><span class="ar" dir="rtl">ุงุญุฌุฒ ุฃุถุญูุชู ุนุจุฑ ุงูุฅูุชุฑูุช</span></h1></div>
                <div class="hero-subtitle-row"><h2><span class="en">Farm to Your Table, Sharia Compliant</span><span class="ar" dir="rtl">ูู ุงููุฒุฑุนุฉ ุฅูู ูุงุฆุฏุชูุ ููู ุงูุดุฑูุนุฉ</span></h2></div>
                <div class="hero-desc-row bil-row bil-row-prefer-inline">
                    <p class="en">Select your preferred livestock and customize your Qurbani with our straightforward options. We ensure a Sharia-compliant, and transparent service for your peace of mind.</p>
                    <p class="ar" dir="rtl">ุงุฎุชุฑ ูุงุดูุชู ุงูููุถูุฉ ูุฎุตุต ุฃุถุญูุชู ุจุฎูุงุฑุงุชูุง ุงููุงุถุญุฉ. ูุถูู ูู ุฎุฏูุฉ ูุชูุงููุฉ ูุน ุงูุดุฑูุนุฉุ ูุดูุงูุฉ ูุฑุงุญุฉ ุจุงูู.</p>
                </div>
                <div class="hero-promo-wrapper">
                    <a href="#udheya-booking-start" @click.prevent="scrollToSection('#udheya-booking-start')" class="hero-promo-cta-link">
                        <div class="pban">
                            <div class="pban-text-content">
                                <div class="bil-row">
                                    <div>
                                        <h3 class="prm-h en">
                                            Eid Al-Adha Offer!
                                            <span x-show="calculatedPromoDaysLeft > 0">
                                                <strong x-text="calculatedPromoDaysLeft"></strong> days left.
                                            </span>
                                            <span x-show="appSettings.promo_is_active && calculatedPromoDaysLeft > 0">
                                                Book early & get <span x-text="(appSettings.promo_discount_percent || 'Y') + '% Discount!'"></span>
                                            </span>
                                        </h3>
                                    </div>
                                    <div>
                                        <h3 class="prm-h ar" dir="rtl">
                                            ุนุฑุถ ุนูุฏ ุงูุฃุถุญู!
                                            <span x-show="calculatedPromoDaysLeft > 0" dir="rtl">
                                                ูุชุจูู <strong x-text="calculatedPromoDaysLeft"></strong> ููููุง.
                                            </span>
                                            <span x-show="appSettings.promo_is_active && calculatedPromoDaysLeft > 0" dir="rtl">
                                                ุงุญุฌุฒ ูุจูุฑูุง ูุงุญุตู ุนูู <span x-text="'ุฎุตู ' + (appSettings.promo_discount_percent || 'Y') + '%!'"></span>
                                            </span>
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <span class="btn bac pban-cta-btn" @click.stop><span class="en">Start Udheya Booking</span><span class="ar">ุงุจุฏุฃ ุญุฌุฒ ุงูุฃุถุญูุฉ</span></span>
                        </div>
                    </a>
                </div>
                <div class="why-choose-us-content-wrapper hero-why-choose">
                    <div class="sec-head tc why-choose-us-hero-head"><h2><span class="en">Why Choose Sheep Land?</span><span class="ar">ููุงุฐุง ุฃุฑุถ ุงูุฃุบูุงูุ</span></h2></div>
                    <div class="feature-grid why-choose-us-hero-grid">
                        <div class="feature-item">
                            <div class="icon-placeholder">๐</div><h4><span class="en">Sharia Compliant</span><span class="ar">ูุชูุงูู ูุน ุงูุดุฑูุนุฉ</span></h4>
                            <p class="card-p en">All animals meet age, health, and Zabiha requirements.</p><p class="card-p ar">ุฌููุน ุงูุญููุงูุงุช ุชุณุชููู ูุชุทูุจุงุช ุงูุนูุฑ ูุงูุตุญุฉ ูุงูุฐุจูุญุฉ.</p>
                        </div>
                        <div class="feature-item">
                            <div class="icon-placeholder">โญ</div><h4><span class="en">Premium Quality</span><span class="ar">ุฌูุฏุฉ ุนุงููุฉ</span></h4>
                            <p class="card-p en">Healthy, well-cared-for livestock for the best meat.</p><p class="card-p ar">ูุงุดูุฉ ุตุญูุฉ ููุนุชูู ุจูุง ุฌูุฏูุง ูุฃูุถู ุฃููุงุน ุงููุญูู.</p>
                        </div>
                        <div class="feature-item">
                            <div class="icon-placeholder">๐ป</div><h4><span class="en">Easy Online Booking</span><span class="ar">ุญุฌุฒ ุณูู ุนุจุฑ ุงูุฅูุชุฑูุช</span></h4>
                            <p class="card-p en">Secure your Udheya conveniently from anywhere.</p><p class="card-p ar">ุงุญุฌุฒ ุฃุถุญูุชู ุจุณูููุฉ ูู ุฃู ููุงู.</p>
                        </div>
                         <div class="feature-item">
                            <div class="icon-placeholder">๐</div><h4><span class="en">Reliable Delivery</span><span class="ar">ุชูุตูู ููุซูู</span></h4>
                            <p class="card-p en">Prepared and delivered according to your choices.</p><p class="card-p ar">ุชูุฌูุฒ ูุชููุตู ููููุง ูุงุฎุชูุงุฑุงุชู.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="main-page-section how-it-works-section sec seca" id="how-it-works">
            <div class="c"><div class="uprocess-wrap"><div class="uprocess">
                <div class="sec-head"><h2 class="how-it-works-title-row"><span class="en">Our Simple Process</span><span class="ar">ุนูููุชูุง ุงููุจุณูุทุฉ</span></h2></div>
                <div class="feature-grid how-it-works-grid">
                    <div class="feature-item">
                        <div class="icon-placeholder number-icon">1</div><h4><span class="en">Select & Customize</span><span class="ar" dir="rtl">ุงุฎุชุฑ ูุฎุตุต</span></h4>
                        <p class="card-p en">Choose animal, weight, preparation, packaging online.</p><p class="card-p ar" dir="rtl">ุงุฎุชุฑ ุญููุงููุ ูุฒููุ ุงูุชุฌููุฒุ ูุงูุชุบููู ุนุจุฑ ุงูุฅูุชุฑูุช.</p>
                    </div>
                    <div class="feature-item">
                        <div class="icon-placeholder number-icon">2</div><h4><span class="en">Confirm & Pay</span><span class="ar" dir="rtl">ุฃูุฏ ูุงุฏูุน</span></h4>
                        <p class="card-p en">Review order and complete booking securely.</p><p class="card-p ar" dir="rtl">ุฑุงุฌุน ุทูุจู ูุฃููู ุญุฌุฒู ุจุฃูุงู.</p>
                    </div>
                    <div class="feature-item">
                        <div class="icon-placeholder number-icon">3</div><h4><span class="en">Humane Sacrifice</span><span class="ar" dir="rtl">ุฐุจุญ ุฑุญูู</span></h4>
                        <p class="card-p en">Performed by experts per Islamic traditions.</p><p class="card-p ar" dir="rtl">ูุชู ููููุง ููุชูุงููุฏ ุงูุฅุณูุงููุฉ ุนูู ูุฏ ุฎุจุฑุงุก.</p>
                    </div>
                    <div class="feature-item">
                        <div class="icon-placeholder number-icon">4</div><h4><span class="en">Receive Your Udheya</span><span class="ar" dir="rtl">ุงุณุชูู ุฃุถุญูุชู</span></h4>
                        <p class="card-p en">Butchered, packaged, delivered/distributed per selections.</p><p class="card-p ar" dir="rtl">ูุฌูุฒุฉุ ูุบููุฉุ ูููุฒุนุฉ/ููุตูุฉ ุญุณุจ ุงุฎุชูุงุฑู.</p>
                    </div>
                </div>
            </div></div></div>
        </section>

        <section class="udheya-booking-section main-page-section sec" id="udheya-booking-start">
            <div class="c" x-show="!bookingConfirmed">
                <div class="sec-head tc booking-section-head">
                    <h2><span class="en">Book Your Udheya</span><span class="ar">ุงุญุฌุฒ ุฃุถุญูุชู</span></h2>
                </div>
            </div>

            <form id="final-udheya-booking-form" @submit.prevent="submitBooking()">
                <div class="stepper-outer-wrapper" x-show="!bookingConfirmed">
                    <div class="c">
                        <div class="stepper-content-flex">
                            <!-- Step 1: Animal -->
                            <a href="#udheya-booking-form-panel" class="stepper-item"
                               :class="{ 'active': currentActiveStep === 1, 'completed': selectedAnimal.type }"
                               @click.prevent="updateStepperState(1); scrollToSection('#udheya-booking-form-panel')">
                               <span class="step-number">1</span><span class="step-label en">Animal</span><span class="step-label ar">ุงูุญููุงู</span>
                            </a>
                            <div class="stepper-connector"></div>
                            <!-- Step 2: Prep & Package -->
                            <a href="#udheya-booking-form-panel" class="stepper-item"
                               :class="{
                                   'active': currentActiveStep === 2 && selectedAnimal.type,
                                   'completed': selectedAnimal.type && selectedPrepStyle.value && selectedPackaging.value,
                                   'disabled': !selectedAnimal.type
                               }"
                               @click.prevent="if(selectedAnimal.type) { updateStepperState(2); scrollToSection('#udheya-booking-form-panel'); }">
                               <span class="step-number">2</span><span class="step-label en">Prep & Package</span><span class="step-label ar">ุงูุชุฌููุฒ ูุงูุชุบููู</span>
                            </a>
                            <div class="stepper-connector"></div>
                            <!-- Step 3: Logistics -->
                            <a href="#udheya-booking-form-panel" class="stepper-item"
                               :class="{
                                   'active': currentActiveStep === 3 && selectedAnimal.type && selectedPrepStyle.value && selectedPackaging.value,
                                   'completed': selectedAnimal.type && selectedPrepStyle.value && selectedPackaging.value && canProceedFromLogistics(),
                                   'disabled': !(selectedAnimal.type && selectedPrepStyle.value && selectedPackaging.value)
                               }"
                               @click.prevent="if(selectedAnimal.type && selectedPrepStyle.value && selectedPackaging.value) { updateStepperState(3); scrollToSection('#udheya-booking-form-panel'); }">
                               <span class="step-number">3</span><span class="step-label en">Logistics</span><span class="step-label ar">ุงูุชูุงุตูู</span>
                            </a>
                            <div class="stepper-connector"></div>
                            <!-- Step 4: Review -->
                            <a href="#udheya-booking-form-panel" class="stepper-item"
                               :class="{
                                   'active': currentActiveStep === 4 && canProceedFromLogistics(),
                                   'disabled': !canProceedFromLogistics()
                               }"
                               @click.prevent="if(canProceedFromLogistics()) { updateStepperState(4); scrollToSection('#udheya-booking-form-panel'); }">
                               <span class="step-number">4</span><span class="step-label en">Review</span><span class="step-label ar">ุงููุฑุงุฌุนุฉ</span>
                            </a>
                        </div>
                    </div>
                </div>

                <div x-show="!bookingConfirmed">
                    <input type="hidden" name="animal_type" :value="selectedAnimal.type"><input type="hidden" name="animal_weight" :value="selectedAnimal.weight">
                    <input type="hidden" name="animal_base_price" :value="selectedAnimal.basePriceEGP"><input type="hidden" name="preparation_style" :value="selectedPrepStyle.value">
                    <input type="hidden" name="packaging_preference" :value="selectedPackaging.value"><textarea name="custom_preparation_details_hidden" style="display:none;" :value="customPrepDetails"></textarea>
                    <input type="hidden" name="sacrifice_day_selected_value" :value="selectedSacrificeDay.value"><input type="hidden" name="final_split_details_text" :value="splitDetails">

                    <!-- SINGLE FORM PANEL CARD for all steps -->
                    <div class="c">
                        <div id="udheya-booking-form-panel" class="card form-panel-card all-steps-panel">
                            <div class="card-b"> <!-- Common card body for padding for all steps -->

                                <!-- Step 1: Animal Selection -->
                                <div id="step1-content" x-show="currentActiveStep === 1" class="form-step-content" x-transition>
                                    <div class="sec-head"><h2><span class="en">Step 1: Select Animal & Approximate Weight</span><span class="ar">ุงูุฎุทูุฉ ุงูุฃููู: ุงุฎุชุฑ ุงูุญููุงู ูุงููุฒู ุงูุชูุฑูุจู</span></h2></div>
                                    <div class="livestock-sharia-note bil-row bil-row-prefer-inline">
                                        <p class="en">All animals meet Sharia age/health requirements for Udheya.</p><p class="ar" dir="rtl">ุฌููุน ุงูุญููุงูุงุช ุชุณุชููู ูุชุทูุจุงุช ุงูุดุฑูุนุฉ ููุนูุฑ ูุงูุตุญุฉ ููุฃุถุญูุฉ.</p>
                                    </div>
                                    <div class="product-grid grid2">
                                        <div id="baladi" class="card livestock-card" :class="{'livestock-card-selected': selectedAnimal.value === 'baladi'}">
                                            <div class="card-img"><img src="/images/baladi-sheep.jpg" alt="Baladi Sheep"><div class="badge bhalal"><span class="en">BALADI</span><span class="ar" dir="rtl">ุจูุฏู</span></div></div>
                                            <div class="card-b">
                                                <div class="card-content"><div class="bil-row"><div><h3 class="card-h en">Baladi Sheep</h3><p class="card-p en">Local breed, rich flavor.</p></div><div><h3 class="card-h ar" dir="rtl">ุฎุฑูู ุจูุฏู</h3><p class="card-p ar" dir="rtl">ุณูุงูุฉ ูุญููุฉุ ูููุฉ ุบููุฉ.</p></div></div></div>
                                                <div class="card-foot">
                                                    <div class="price bil-row"><span class="en">From <span x-text="getFormattedPrice(productOptions.livestock.find(a => a.value_key === 'baladi')?.weights_prices[0]?.price_egp || 0)"></span></span><span class="ar">ูุจุฏุฃ ูู <span x-text="getFormattedPrice(productOptions.livestock.find(a => a.value_key === 'baladi')?.weights_prices[0]?.price_egp || 0)"></span></span></div>
                                                    <div class="card-act">
                                                        <label for="baladi_weight_select_s1" class="sr-only">Select Baladi Weight</label><select id="baladi_weight_select_s1" name="animal_weight_baladi" class="livestock-weight-select"></select>
                                                        <button type="button" class="btn bp livestock-select-btn" @click="selectAnimal($el.closest('.livestock-card'), 'baladi')" :class="{'disabled-btn': isLivestockWeightOutOfStock($el.closest('.livestock-card').querySelector('.livestock-weight-select'), 'baladi')}" :disabled="isLivestockWeightOutOfStock($el.closest('.livestock-card').querySelector('.livestock-weight-select'), 'baladi')"><span class="en">Select</span><span class="ar">ุงุฎุชุฑ</span></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="barki" class="card livestock-card" :class="{'livestock-card-selected': selectedAnimal.value === 'barki'}">
                                            <div class="card-img"><img src="/images/barki-sheep.jpg" alt="Barki Sheep"><div class="badge bhalal"><span class="en">BARKI</span><span class="ar" dir="rtl">ุจุฑูู</span></div></div>
                                            <div class="card-b">
                                                <div class="card-content"><div class="bil-row"><div><h3 class="card-h en">Barki Sheep</h3><p class="card-p en">Desert breed, lean meat.</p></div><div><h3 class="card-h ar" dir="rtl">ุฎุฑูู ุจุฑูู</h3><p class="card-p ar" dir="rtl">ุณูุงูุฉ ุตุญุฑุงููุฉุ ูุญู ูููู ุงูุฏูู.</p></div></div></div>
                                                <div class="card-foot">
                                                    <div class="price bil-row"><span class="en">From <span x-text="getFormattedPrice(productOptions.livestock.find(a => a.value_key === 'barki')?.weights_prices[0]?.price_egp || 0)"></span></span><span class="ar">ูุจุฏุฃ ูู <span x-text="getFormattedPrice(productOptions.livestock.find(a => a.value_key === 'barki')?.weights_prices[0]?.price_egp || 0)"></span></span></div>
                                                    <div class="card-act">
                                                        <label for="barki_weight_select_s1" class="sr-only">Select Barki Weight</label><select id="barki_weight_select_s1" name="animal_weight_barki" class="livestock-weight-select"></select>
                                                        <button type="button" class="btn bp livestock-select-btn" @click="selectAnimal($el.closest('.livestock-card'), 'barki')" :class="{'disabled-btn': isLivestockWeightOutOfStock($el.closest('.livestock-card').querySelector('.livestock-weight-select'), 'barki')}" :disabled="isLivestockWeightOutOfStock($el.closest('.livestock-card').querySelector('.livestock-weight-select'), 'barki')"><span class="en">Select</span><span class="ar">ุงุฎุชุฑ</span></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-action tc page-step-action">
                                        <button type="button" class="btn bac btn-lg" @click="if(selectedAnimal.type) { updateStepperState(2); scrollToSection('#udheya-booking-form-panel'); } else { alert('Please select an animal and weight.');}" :disabled="!selectedAnimal.type" :class="{'disabled-btn': !selectedAnimal.type }">
                                            <span class="en">Next: Preparation & Packaging</span><span class="ar">ุงูุชุงูู: ุงูุชุฌููุฒ ูุงูุชุบููู</span>
                                        </button>
                                    </div>
                                </div>

                                <!-- Step 2: Preparation & Packaging (Combined) -->
                                <div id="step2-content" x-show="currentActiveStep === 2 && selectedAnimal.type" class="form-step-content seca" x-transition>
                                    <div class="sec-head"><h2><span class="en">Step 2: Choose Preparation & Packaging</span><span class="ar">ุงูุฎุทูุฉ ุงูุซุงููุฉ: ุงุฎุชุฑ ุทุฑููุฉ ุงูุชุฌููุฒ ูุงูุชุบููู</span></h2></div>
                                    
                                    <div class="fg">
                                        <label for="prep_style_select_s2" class="bil-row"><span class="en">Preparation Style</span><span class="ar">ุทุฑููุฉ ุงูุชุฌููุฒ</span></label>
                                        <select id="prep_style_select_s2" name="preparation_style_dropdown" class="form-input-styled"
                                                x-model="selectedPrepStyle.value" @change="handlePrepStyleChangeFromDropdown($event.target.value)">
                                            <option value="" disabled><span class="en">-- Select Preparation --</span><span class="ar" dir="rtl">-- ุงุฎุชุฑ ุทุฑููุฉ ุงูุชุฌููุฒ --</span></option>
                                            <option value="Standard Mixed Cuts" data-is-custom="false" data-name-en="Standard Mix" data-name-ar="ูุฒูุฌ ููุงุณู">Standard Mix / ูุฒูุฌ ููุงุณู</option>
                                            <option value="Charity Portions" data-is-custom="false" data-name-en="Charity Portions" data-name-ar="ุญุตุต ุตุฏูุฉ">Charity Portions / ุญุตุต ุตุฏูุฉ</option>
                                            <option value="Feast Preparation" data-is-custom="false" data-name-en="Feast Preparation" data-name-ar="ุชุฌููุฒ ููุงุฆู">Feast Preparation / ุชุฌููุฒ ููุงุฆู</option>
                                            <option value="Custom & Ground Mix" data-is-custom="true" data-name-en="Custom & Ground" data-name-ar="ูุฎุตุต ูููุฑูู">Custom & Ground / ูุฎุตุต ูููุฑูู</option>
                                        </select>
                                    </div>
                                    <div class="fg custom-prep-details-container" x-show="selectedPrepStyle.is_custom" x-transition>
                                        <label for="custom_prep_details_s2" class="bil-row"><span class="en">Custom Preparation Details</span><span class="ar">ุชูุงุตูู ุงูุชุฌููุฒ ุงููุฎุตุต</span></label>
                                        <textarea id="custom_prep_details_s2" name="custom_preparation_details" class="form-input-styled" x-model="customPrepDetails" placeholder="e.g., mostly leg cuts, 1kg mince"></textarea>
                                    </div>

                                    <div class="fg" style="margin-top: var(--s3);"> <!-- Added margin for separation -->
                                        <label for="packaging_select_s2" class="bil-row"><span class="en">Packaging Preference</span><span class="ar">ุทุฑููุฉ ุงูุชุบููู</span></label>
                                        <select id="packaging_select_s2" name="packaging_preference_dropdown" class="form-input-styled"
                                                x-model="selectedPackaging.value" @change="handlePackagingChangeFromDropdown($event.target.value)">
                                            <option value="" disabled><span class="en">-- Select Packaging --</span><span class="ar" dir="rtl">-- ุงุฎุชุฑ ุทุฑููุฉ ุงูุชุบููู --</span></option>
                                            <option value="standard" data-addon-price-egp="0" data-name-en="Standard Packaging" data-name-ar="ุชุนุจุฆุฉ ููุงุณูุฉ">Standard Packaging / ุชุนุจุฆุฉ ููุงุณูุฉ</option>
                                            <option value="vacuum_sealed" data-addon-price-egp="100" data-name-en="Vacuum Sealed" data-name-ar="ุชุนุจุฆุฉ ููุฑุบุฉ">Vacuum Sealed (Add <span x-text="getFormattedPrice(appSettings.packaging_addons.vacuum_sealed_price_egp || 100)"></span>) / ุชุนุจุฆุฉ ููุฑุบุฉ (ุฅุถุงูุฉ <span x-text="getFormattedPrice(appSettings.packaging_addons.vacuum_sealed_price_egp || 100)"></span>)</option>
                                        </select>
                                    </div>
                                    <div class="form-action tc page-step-action">
                                        <button type="button" class="btn bac btn-lg" 
                                                @click="if(selectedPrepStyle.value && selectedPackaging.value) { updateStepperState(3); scrollToSection('#udheya-booking-form-panel'); } else { alert(appSettings.alert_select_prep_packaging_en + ' / ' + appSettings.alert_select_prep_packaging_ar);}"
                                                :disabled="!selectedPrepStyle.value || !selectedPackaging.value"
                                                :class="{'disabled-btn': !selectedPrepStyle.value || !selectedPackaging.value }">
                                            <span class="en">Next: Logistics</span><span class="ar">ุงูุชุงูู: ุงูุชูุงุตูู</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Step 3: Logistics & Personalization (Original Step 4 Content) -->
                                <div id="step4-content" x-show="currentActiveStep === 3 && selectedAnimal.type && selectedPrepStyle.value && selectedPackaging.value" class="form-step-content" x-transition>
                                    <div class="sec-head"><h2><span class="en">Step 3: Logistics & Personalization</span><span class="ar">ุงูุฎุทูุฉ ุงูุซุงูุซุฉ: ุงูุฎุฏูุงุช ุงูููุฌุณุชูุฉ ูุงูุชุฎุตูุต</span></h2></div>
                                    <div class="content-grid grid1 logistics-content-grid">
                                        <h4 class="form-panel-title bil-row"><span class="en">Scheduling</span><span class="ar">ุงูููุงุนูุฏ</span></h4>
                                        <div class="fg">
                                            <label for="sacrifice_day_select_s4" class="bil-row"><span class="en">Preferred Sacrifice Day</span><span class="ar">ููู ุงูุฐุจุญ ุงูููุถู</span></label>
                                            <select id="sacrifice_day_select_s4" name="sacrifice_day" class="form-input-styled" x-model="selectedSacrificeDay.value">
                                                <option value="day1_10_dhul_hijjah" data-en="Day 1 of Eid (10th Dhul Hijjah)" data-ar="ุงูููู ุงูุฃูู (10 ุฐู ุงูุญุฌุฉ)">Day 1 of Eid / ุงูููู ุงูุฃูู</option>
                                                <option value="day2_11_dhul_hijjah" data-en="Day 2 of Eid (11th Dhul Hijjah)" data-ar="ุงูููู ุงูุซุงูู (11 ุฐู ุงูุญุฌุฉ)">Day 2 of Eid / ุงูููู ุงูุซุงูู</option>
                                                <option value="day3_12_dhul_hijjah" data-en="Day 3 of Eid (12th Dhul Hijjah)" data-ar="ุงูููู ุงูุซุงูุซ (12 ุฐู ุงูุญุฌุฉ)">Day 3 of Eid / ุงูููู ุงูุซุงูุซ</option>
                                                <option value="day4_13_dhul_hijjah" data-en="Day 4 of Eid (13th Dhul Hijjah)" data-ar="ุงูููู ุงูุฑุงุจุน (13 ุฐู ุงูุญุฌุฉ)">Day 4 of Eid / ุงูููู ุงูุฑุงุจุน</option>
                                            </select>
                                            <div class="bil-row field-note-wrapper sacrifice-day-note bil-row-prefer-inline"><p class="field-note en">Day 1: after Eid prayers. Day 4: permissible by some scholars.</p><p class="field-note ar" dir="rtl">ุงูููู ุงูุฃูู: ุจุนุฏ ุตูุงุฉ ุงูุนูุฏ. ุงูููู ุงูุฑุงุจุน: ุฌุงุฆุฒ ุนูุฏ ุจุนุถ ุฃูู ุงูุนูู.</p></div>
                                        </div>
                                        <div class="fg">
                                            <label class="bil-row"><span class="en">Preferred Time Slot</span><span class="ar">ุงูููุช ุงูููุถู</span></label>
                                            <div class="tslots">
                                                <div class="ts" :class="{'sel': selectedTimeSlot === '7 AM-8 AM'}" @click="selectedTimeSlot = '7 AM-8 AM'">7-8 AM</div><div class="ts" :class="{'sel': selectedTimeSlot === '8 AM-9 AM'}" @click="selectedTimeSlot = '8 AM-9 AM'">8-9 AM</div><div class="ts" :class="{'sel': selectedTimeSlot === '9 AM-10 AM'}" @click="selectedTimeSlot = '9 AM-10 AM'">9-10 AM</div><div class="ts" :class="{'sel': selectedTimeSlot === '10 AM-11 AM'}" @click="selectedTimeSlot = '10 AM-11 AM'">10-11 AM</div><div class="ts" :class="{'sel': selectedTimeSlot === '11 AM-12 PM'}" @click="selectedTimeSlot = '11 AM-12 PM'">11-12 PM</div><div class="ts" :class="{'sel': selectedTimeSlot === '12 PM-1 PM'}" @click="selectedTimeSlot = '12 PM-1 PM'">12-1 PM</div><div class="ts" :class="{'sel': selectedTimeSlot === '1 PM-2 PM'}" @click="selectedTimeSlot = '1 PM-2 PM'">1-2 PM</div><div class="ts" :class="{'sel': selectedTimeSlot === '2 PM-3 PM'}" @click="selectedTimeSlot = '2 PM-3 PM'">2-3 PM</div>
                                            </div>
                                            <div class="bil-row field-note-wrapper time-slot-note bil-row-prefer-inline"><p class="field-note en">Sacrifice time. Delivery confirmed separately if chosen.</p><p class="field-note ar" dir="rtl">ููุช ุงูุฐุจุญ. ููุช ุงูุชูุตูู ูุคูุฏ ูููุตูุงู ุฅุฐุง ุงุฎุชุฑุช ุงูุชูุตูู.</p></div>
                                        </div>
                                        <hr class="form-divider">
                                        <h4 class="form-panel-title bil-row distribution-dedication-title"><span class="en">Distribution & Dedication</span><span class="ar">ุงูุชูุฒูุน ูุงูุฅูุฏุงุก</span></h4>
                                        <div class="fg">
                                            <label class="bil-row"><span class="en">Udheya Distribution?</span><span class="ar">ููู ุชูุฏ ุชูุฒูุน ุฃุถุญูุชูุ</span></label>
                                            <div class="rgrp">
                                                <label><input type="radio" name="dist_choice" value="me" x-model="distributionChoice"><span class="en">Deliver All to Me</span><span class="ar" dir="rtl">ุชูุตูู ุงููู ูู</span></label>
                                                <label><input type="radio" name="dist_choice" value="char" x-model="distributionChoice"><span class="en">Donate All (Sheep Land distributes)</span><span class="ar" dir="rtl">ุชุจุฑุน ุจุงููู (ุฃุฑุถ ุงูุฃุบูุงู ุชูุฒุน)</span></label>
                                                <label><input type="radio" name="dist_choice" value="split" x-model="distributionChoice"><span class="en">Split Portions</span><span class="ar" dir="rtl">ุชูุณูู ุงูุญุตุต</span></label>
                                            </div>
                                            <div class="rgrp split-options-rgrp" x-show="distributionChoice === 'split'" x-transition>
                                                <label><input type="radio" name="split_option_choice" value="1/3_me_2/3_charity_sl" x-model="splitDetailsOption"><span class="en">1/3 me, 2/3 charity (SL)</span><span class="ar" dir="rtl">ุซูุซ ููุ ุซูุซุงู ุตุฏูุฉ (ุฃุฑุถ ุงูุฃุบูุงู)</span></label>
                                                <label><input type="radio" name="split_option_choice" value="1/2_me_1/2_charity_sl" x-model="splitDetailsOption"><span class="en">1/2 me, 1/2 charity (SL)</span><span class="ar" dir="rtl">ูุตู ููุ ูุตู ุตุฏูุฉ (ุฃุฑุถ ุงูุฃุบูุงู)</span></label>
                                                <label><input type="radio" name="split_option_choice" value="2/3_me_1/3_charity_sl" x-model="splitDetailsOption"><span class="en">2/3 me, 1/3 charity (SL)</span><span class="ar" dir="rtl">ุซูุซุงู ููุ ุซูุซ ุตุฏูุฉ (ุฃุฑุถ ุงูุฃุบูุงู)</span></label>
                                                <label><input type="radio" name="split_option_choice" value="all_me_custom_distro" x-model="splitDetailsOption"><span class="en">All for me (I distribute)</span><span class="ar" dir="rtl">ุงููู ูู (ุฃูุง ุฃูุฒุน)</span></label>
                                                <label><input type="radio" name="split_option_choice" value="custom" x-model="splitDetailsOption"><span class="en">Other (Specify)</span><span class="ar" dir="rtl">ุฃุฎุฑู (ุญุฏุฏ)</span></label>
                                                <textarea name="custom_split_details_text" class="form-input-styled custom-split-textarea" x-show="distributionChoice === 'split' && splitDetailsOption === 'custom'" x-model="customSplitDetailsText" placeholder="e.g., 1/4 me, 3/4 relative (all delivered to me)" rows="2"></textarea>
                                            </div>
                                            <div class="bil-row field-note-wrapper distribution-note bil-row-prefer-inline"><p class="field-note en">Delivery details required if any portion is for you. "Charity (SL)" means we handle that distribution.</p><p class="field-note ar" dir="rtl">ุชูุงุตูู ุงูุชูุตูู ูุทููุจุฉ ุฅุฐุง ูุงู ุฌุฒุก ูู. "ุตุฏูุฉ (ุฃุฑุถ ุงูุฃุบูุงู)" ุชุนูู ุฃููุง ูุชููู ุงูุชูุฒูุน.</p></div>
                                        </div>
                                        <div class="bil-row field-note-wrapper wakeel-note bil-row-prefer-inline"><p class="field-note en">If Sheep Land distributes to charity, we act as your Wakeel.</p><p class="field-note ar" dir="rtl">ุฅุฐุง ูุฒุนุช "ุฃุฑุถ ุงูุฃุบูุงู" ููุฌูุนูุงุชุ ููุญู ููููู.</p></div>
                                        <div class="fg niyyah-names-wrapper">
                                            <label for="niyyah_names_input_s4" class="bil-row"><span class="en">Names for Niyyah</span><span class="ar">ุฃุณูุงุก ุงูููุฉ</span></label>
                                            <input id="niyyah_names_input_s4" type="text" name="niyyah_names" class="form-input-styled" x-model="niyyahNames">
                                            <div class="bil-row field-note-wrapper niyyah-note bil-row-prefer-inline"><p class="field-note en">Niyyah is core. List names for whom sacrifice is made.</p><p class="field-note ar" dir="rtl">ุงูููุฉ ุฃุณุงุณูุฉ. ุงุฐูุฑ ุฃุณูุงุก ูู ุชุถุญู ุนููู.</p></div>
                                        </div>
                                        <hr class="form-divider">
                                        <div x-show="_needsDeliveryDetails">
                                            <h4 class="form-panel-title bil-row delivery-details-title"><span class="en">Delivery Details</span><span class="ar">ุชูุงุตูู ุงูุชูุตูู</span></h4>
                                            <div>
                                                <label for="delivery_name_input_s4" class="bil-row"><span class="en">Full Name (delivery)</span><span class="ar">ุงูุงุณู ุงููุงูู (ููุชูุตูู)</span></label><input id="delivery_name_input_s4" type="text" name="delivery_name" class="form-input-styled fg" x-model="deliveryName">
                                                <label for="delivery_phone_input_s4" class="bil-row"><span class="en">Phone (delivery)</span><span class="ar">ุฑูู ุงููุงุชู (ููุชูุตูู)</span></label><input id="delivery_phone_input_s4" type="tel" name="delivery_phone" class="form-input-styled fg" x-model="deliveryPhone">
                                                <label for="customer_email_input_s4" class="bil-row"><span class="en">Your Email (confirmation)</span><span class="ar">ุจุฑูุฏู ุงูุฅููุชุฑููู (ููุชุฃููุฏ)</span></label><input id="customer_email_input_s4" type="email" name="customer_email" class="form-input-styled fg" x-model="customerEmail" placeholder="optional@example.com">
                                                <div class="fg"><label for="delivery_governorate_s4" class="bil-row"><span class="en">Governorate</span><span class="ar">ุงููุญุงูุธุฉ</span></label><select id="delivery_governorate_s4" name="delivery_governorate" class="form-input-styled" x-model="selectedGovernorate"><option value="">-- Select --</option><template x-for="gov in appSettings.delivery_areas" :key="gov.id"><option :value="gov.id" x-text="gov.name_en + ' / ' + gov.name_ar"></option></template></select></div>
                                                <div class="fg"><label for="delivery_city_select_s4" class="bil-row"><span class="en">City</span><span class="ar">ุงููุฏููุฉ</span></label><select id="delivery_city_select_s4" name="delivery_city" class="form-input-styled" x-model="deliveryCity" :disabled="!selectedGovernorate || availableCities.length === 0"><option value="">-- Select --</option><template x-for="city in availableCities" :key="city.id"><option :value="city.id" x-text="city.name_en + ' / ' + city.name_ar"></option></template></select>
                                                    <div class="bil-row field-note-wrapper bil-row-prefer-inline" x-show="selectedGovernorate && availableCities.length === 0 && appSettings.delivery_areas.find(g => g.id === selectedGovernorate)?.cities?.length > 0"><p class="field-note en">Please select city.</p><p class="field-note ar" dir="rtl">ูุฑุฌู ุงุฎุชูุงุฑ ูุฏููุฉ.</p></div>
                                                    <div class="bil-row field-note-wrapper bil-row-prefer-inline" x-show="selectedGovernorate && appSettings.delivery_areas.find(g => g.id === selectedGovernorate)?.cities?.length === 0"><p class="field-note en">No cities listed. Contact us.</p><p class="field-note ar" dir="rtl">ูุง ุชูุฌุฏ ูุฏู. ุงุชุตู ุจูุง.</p></div>
                                                </div>
                                                <label for="delivery_address_input_s4" class="bil-row"><span class="en">Full Address</span><span class="ar">ุงูุนููุงู ุจุงููุงูู</span></label><textarea id="delivery_address_input_s4" name="delivery_address" class="form-input-styled fg" rows="2" x-model="deliveryAddress"></textarea>
                                                <label for="delivery_instructions_input_s4" class="bil-row"><span class="en">Special Instructions (Optional)</span><span class="ar">ุชุนูููุงุช ุฎุงุตุฉ (ุงุฎุชูุงุฑู)</span></label><textarea id="delivery_instructions_input_s4" name="delivery_instructions" class="form-input-styled fg" rows="2" x-model="deliveryInstructions"></textarea>
                                                <div class="bil-row field-note-wrapper bil-row-prefer-inline"><p class="field-note en">Delivery details required if Udheya is delivered to you.</p><p class="field-note ar" dir="rtl">ุชูุงุตูู ุงูุชูุตูู ูุทููุจุฉ ุฅุฐุง ุณุชููุตู ุงูุฃุถุญูุฉ ุฅููู.</p></div>
                                            </div>
                                        </div>
                                        <template x-if="!_needsDeliveryDetails"><p class="bil-row field-note en ar no-delivery-note bil-row-prefer-inline"><span class="en">Delivery details not required.</span><span class="ar">ุชูุงุตูู ุงูุชูุตูู ุบูุฑ ูุทููุจุฉ.</span></p></template>
                                    </div>
                                    <div class="form-action tc page-step-action logistics-form-action">
                                        <button type="button" class="btn bac btn-lg btn-block" @click="proceedToReview()" :disabled="!canProceedFromLogistics()" :class="{'disabled-btn': !canProceedFromLogistics()}"><span class="en">Continue to Review & Payment</span><span class="ar">ุงููุชุงุจุนุฉ ูููุฑุงุฌุนุฉ ูุงูุฏูุน</span></button>
                                    </div>
                                </div>

                                <!-- Step 4: Review, Options & Payment (Original Step 5 Content) -->
                                <div id="step5-content" x-show="currentActiveStep === 4 && canProceedFromLogistics()" class="form-step-content" x-transition>
                                    <div class="sec-head"><h2><span class="en">Step 4: Review, Options & Payment</span><span class="ar">ุงูุฎุทูุฉ ุงูุฑุงุจุนุฉ: ุงููุฑุงุฌุนุฉุ ุงูุฎูุงุฑุงุช ูุงูุฏูุน</span></h2></div>
                                    <div class="review-summary-wrapper">
                                        <h3 class="form-panel-title bil-row review-summary-title"><span class="en">Your Udheya Booking Summary</span><span class="ar">ููุฎุต ุญุฌุฒ ุฃุถุญูุชู</span></h3>
                                        <div x-show="selectedAnimal.type">
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Sheep:</span><span class="ar">ุงูุฎุฑูู:</span></strong> <span x-text="selectedAnimal.nameEN || '(Type)'"></span>, <span x-text="selectedAnimal.weight || '(Weight)'"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูุฎุฑูู:</span><span class="en">Sheep:</span></strong> <span x-text="selectedAnimal.nameAR || '(ุงูููุน)'"></span>ุ <span x-text="selectedAnimal.weight || '(ุงููุฒู)'"></span></div></div>
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Prep:</span><span class="ar">ุงูุชุฌููุฒ:</span></strong> <span x-text="selectedPrepStyle.nameEN || '(Style)'"></span> <span x-show="selectedPrepStyle.is_custom && customPrepDetails" x-text="'(' + customPrepDetails.substring(0,20) + (customPrepDetails.length > 20 ? '...' : '') + ')'"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูุชุฌููุฒ:</span><span class="en">Prep:</span></strong> <span x-text="selectedPrepStyle.nameAR || '(ุงูุทุฑููุฉ)'"></span> <span x-show="selectedPrepStyle.is_custom && customPrepDetails" x-text="'(' + customPrepDetails.substring(0,20) + (customPrepDetails.length > 20 ? '...' : '') + ')'"></span></div></div>
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Package:</span><span class="ar">ุงูุชุนุจุฆุฉ:</span></strong> <span x-text="selectedPackaging.nameEN || '(Pkg)'"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูุชุนุจุฆุฉ:</span><span class="en">Package:</span></strong> <span x-text="selectedPackaging.nameAR || '(ุงูุชุบููู)'"></span></div></div>
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Sacrifice Day:</span><span class="ar">ููู ุงูุฐุจุญ:</span></strong> <span x-text="selectedSacrificeDay.textEN"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ููู ุงูุฐุจุญ:</span><span class="en">Sacrifice Day:</span></strong> <span x-text="selectedSacrificeDay.textAR"></span></div></div>
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Time Slot:</span><span class="ar">ุงูููุช:</span></strong> <span x-text="selectedTimeSlot"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูููุช:</span><span class="en">Time Slot:</span></strong> <span x-text="selectedTimeSlot"></span></div></div>
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Delivery To:</span><span class="ar">ุงูุชูุตูู ุฅูู:</span></strong> <span x-text="summaryDeliveryToEN"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูุชูุตูู ุฅูู:</span><span class="en">Delivery To:</span></strong> <span x-text="summaryDeliveryToAR"></span></div></div>
                                            <div class="summary-item bil-row"><div class="en"><strong><span class="en">Distribution:</span><span class="ar">ุงูุชูุฒูุน:</span></strong> <span x-text="summaryDistributionEN"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูุชูุฒูุน:</span><span class="en">Distribution:</span></strong> <span x-text="summaryDistributionAR"></span></div></div>
                                            <hr class="summary-hr"><div class="summary-total bil-row"><div class="en"><strong><span class="en">Total:</span><span class="ar">ุงูุฅุฌูุงูู:</span></strong> <span x-text="getFormattedPrice(totalPriceEGP)"></span></div><div class="ar" dir="rtl"><strong><span class="ar">ุงูุฅุฌูุงูู:</span><span class="en">Total:</span></strong> <span x-text="getFormattedPrice(totalPriceEGP)"></span></div></div>
                                        </div>
                                        <div x-show="!selectedAnimal.type" class="tc review-no-selection-text"><p class="en">Selections will appear here.</p><p class="ar" dir="rtl">ุณุชุธูุฑ ุงุฎุชูุงุฑุงุชู ููุง.</p></div>
                                        <div class="bil-row tc review-care-note bil-row-prefer-inline"><p class="en review-care-note-text">Review carefully before confirming.</p><p class="ar review-care-note-text" dir="rtl">ุฑุงุฌุน ุงุฎุชูุงุฑุงุชู ุจุนูุงูุฉ ูุจู ุงูุชุฃููุฏ.</p></div>
                                    </div>
                                    <div class="additional-options-payment-wrapper">
                                        <h4 class="form-panel-title bil-row"><span class="en">Additional Options & Payment</span><span class="ar">ุงูุฎูุงุฑุงุช ุงูููุงุฆูุฉ ูุงูุฏูุน</span></h4>
                                        <div class="fg"><label class="bil-row"><input type="checkbox" name="group_purchase_final" x-model="groupPurchase"><span class="en">Group Purchase? (Save up to 20% - We'll contact)</span><span class="ar">ุดุฑุงุก ุฌูุงุนูุ (ููุฑ ุญุชู 20% - ุณูุชูุงุตู ูุนู)</span></label></div><hr class="form-divider">
                                        <div class="fg">
                                            <label class="bil-row"><span class="en">Payment Method</span><span class="ar">ุทุฑููุฉ ุงูุฏูุน</span></label>
                                            <div class="pmeths">
                                                <div class="pm" :class="{'sel': paymentMethod === 'fa'}" @click="paymentMethod = 'fa'"><input type="radio" id="pm-fa" name="payment_method_final" value="fa" x-model="paymentMethod"><label for="pm-fa" title="Fawry"><img src="/images/Fawry.svg" alt="Fawry" class="payment-icon"></label></div>
                                                <div class="pm" :class="{'sel': paymentMethod === 'vo'}" @click="paymentMethod = 'vo'"><input type="radio" id="pm-vo" name="payment_method_final" value="vo" x-model="paymentMethod"><label for="pm-vo" title="Vodafone Cash"><img src="/images/vodafone.svg" alt="Vodafone Cash" class="payment-icon"></label></div>
                                                <div class="pm" :class="{'sel': paymentMethod === 'cod'}" @click="paymentMethod = 'cod'"><input type="radio" id="pm-cod" name="payment_method_final" value="cod" x-model="paymentMethod"><label for="pm-cod" title="Cash on Delivery"><img src="/images/cod.svg" alt="Cash on Delivery" class="payment-icon"></label></div>
                                                <div class="pm" :class="{'sel': paymentMethod === 'ip'}" @click="paymentMethod = 'ip'"><input type="radio" id="pm-ip" name="payment_method_final" value="ip" x-model="paymentMethod"><label for="pm-ip" title="InstaPay"><img src="/images/instapay.svg" alt="InstaPay" class="payment-icon"></label></div>
                                                <div class="pm" :class="{'sel': paymentMethod === 'revolut'}" @click="paymentMethod = 'revolut'"><input type="radio" id="pm-revolut" name="payment_method_final" value="revolut" x-model="paymentMethod"><label for="pm-revolut" title="Revolut"><img src="/images/revolut_icon.svg" alt="Revolut" class="payment-icon"></label></div>
                                                <div class="pm" :class="{'sel': paymentMethod === 'bank_transfer'}" @click="paymentMethod = 'bank_transfer'"><input type="radio" id="pm-bank" name="payment_method_final" value="bank_transfer" x-model="paymentMethod"><label for="pm-bank" title="Bank Transfer"><img src="/images/bank_transfer_icon.svg" alt="Bank Transfer" class="payment-icon"></label></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-action tc page-step-action final-submit-action">
                                        <button type="submit" name="submit_udheya_booking" class="btn bac btn-lg btn-block mt1" :disabled="isLoading.booking || !selectedAnimal.type || !selectedPrepStyle.value || !selectedPackaging.value || !canProceedFromLogistics()" :class="{'disabled-btn': isLoading.booking || !selectedAnimal.type || !selectedPrepStyle.value || !selectedPackaging.value || !canProceedFromLogistics()}">
                                            <span x-show="!isLoading.booking"><span class="en">Confirm & Place Udheya Order</span><span class="ar">ุชุฃููุฏ ูุฅุฑุณุงู ุทูุจ ุงูุฃุถุญูุฉ</span></span>
                                            <span x-show="isLoading.booking"><span class="en">Processing...</span><span class="ar">ุฌุงุฑู ุงููุนุงูุฌุฉ...</span></span>
                                        </button>
                                    </div>
                                </div>

                            </div> <!-- end .card-b (common card body) -->
                        </div> <!-- end #udheya-booking-form-panel -->
                    </div> <!-- end .c (wrapper for the panel) -->
                </div> <!-- end x-show="!bookingConfirmed" for form content -->

                <section id="step5-booking-confirmation" class="sec udheya-page-step" x-show="bookingConfirmed" x-transition.opacity.duration.300ms>
                    <div class="c tc">
                        <div class="sec-head booking-confirmed-head"><h2><span class="en">Booking Confirmed!</span><span class="ar">ุชู ุชุฃููุฏ ุงูุญุฌุฒ!</span></h2></div>
                        <div class="confirmation-message">
                            <div class="bil-row confirmation-intro-text bil-row-prefer-inline"><p class="en">Thank you for your Udheya booking.</p><p class="ar" dir="rtl">ุดูุฑุงู ูุญุฌุฒ ุฃุถุญูุชูู.</p></div>
                            <div class="card form-panel-card booking-id-card"><div class="card-b booking-id-card-body">
                                <div class="bil-row">
                                    <p class="en booking-id-card-important"><strong>Important: Your Booking Details</strong></p>
                                    <p class="ar booking-id-card-important" dir="rtl"><strong>ูุงู: ุชูุงุตูู ุญุฌุฒูู</strong></p>
                                </div>
                                <div class="bil-row">
                                    <p class="en booking-id-card-label">Booking ID:</p>
                                    <p class="ar booking-id-card-label" dir="rtl">ุฑูู ุญุฌุฒูู:</p>
                                </div>
                                <p class="booking-id-display" x-text="bookingID"></p>
                                <p class="en booking-id-card-note">Save ID for status check. Confirmation email sent to <strong x-text="customerEmail && isValidEmail(customerEmail) ? customerEmail : 'your email (if provided)'"></strong>.</p><p class="ar booking-id-card-note" dir="rtl">ุงุญูุธ ุงูุฑูู ููุชุญูู. ุชู ุฅุฑุณุงู ุชุฃููุฏ ุฅูู <strong x-text="customerEmail && isValidEmail(customerEmail) ? customerEmail : 'ุจุฑูุฏู (ุฅุฐุง ููุฏู)'"></strong>.</p>
                            </div></div>
                            <div class="quick-recap-wrapper">
                                <h4 class="form-panel-title bil-row quick-recap-title"><span class="en">Quick Order Recap</span><span class="ar">ููุฎุต ุณุฑูุน ููุทูุจ</span></h4>
                                <div class="summary-item bil-row"><div class="en"><strong>Animal:</strong> <span x-text="selectedAnimal.nameEN + ', ' + selectedAnimal.weight"></span></div><div class="ar" dir="rtl"><strong>ุงูุญููุงู:</strong> <span x-text="selectedAnimal.nameAR + '\u060C ' + selectedAnimal.weight"></span></div></div>
                                <div class="summary-item bil-row"><div class="en"><strong>Prep:</strong> <span x-text="selectedPrepStyle.nameEN"></span></div><div class="ar" dir="rtl"><strong>ุงูุชุฌููุฒ:</strong> <span x-text="selectedPrepStyle.nameAR"></span></div></div>
                                <div class="summary-item bil-row"><div class="en"><strong>Package:</strong> <span x-text="selectedPackaging.nameEN"></span></div><div class="ar" dir="rtl"><strong>ุงูุชุนุจุฆุฉ:</strong> <span x-text="selectedPackaging.nameAR"></span></div></div>
                                <div class="summary-item bil-row"><div class="en"><strong>Sacrifice:</strong> <span x-text="selectedSacrificeDay.textEN + ', ' + selectedTimeSlot"></span></div><div class="ar" dir="rtl"><strong>ุงูุฐุจุญ:</strong> <span x-text="selectedSacrificeDay.textAR + '\u060C ' + selectedTimeSlot"></span></div></div>
                            </div>
                            <div class="payment-instructions-wrapper">
                                <h4 class="form-panel-title bil-row payment-instructions-title"><span class="en">Next Steps & Payment</span><span class="ar">ุงูุฎุทูุงุช ุงูุชุงููุฉ ูุงูุฏูุน</span></h4>
                                <div x-show="paymentMethod === 'vi' || paymentMethod === 'mc'"><p class="bil-row bil-row-prefer-inline"><span class="en">Booking confirmed. Card payment demo.</span><span class="ar" dir="rtl">ุชู ุงูุชุฃููุฏ. ุนุฑุถ ุฏูุน ุจุงูุจุทุงูุฉ.</span></p></div>
                                <div x-show="paymentMethod === 'fa'"><p class="bil-row bil-row-prefer-inline"><span class="en">Fawry: Use Booking ID <strong class="payment-ref-highlight" x-text="bookingID"></strong>. Total: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong>. Due in 24h.</span><span class="ar" dir="rtl">ููุฑู: ุงุณุชุฎุฏู ุฑูู ุงูุญุฌุฒ <strong class="payment-ref-highlight" x-text="bookingID"></strong>. ุงูุฅุฌูุงูู: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong>. ุฎูุงู 24ุณ.</span></p></div>
                                <div x-show="paymentMethod === 'vo'"><p class="bil-row bil-row-prefer-inline"><span class="en">Vodafone Cash: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> to <strong class="payment-ref-highlight" x-text="appSettings.payment_details.vodafone_cash || '010X'"></strong>. Ref: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. Confirm via WA: <a :href="'https://wa.me/' + appSettings.whatsapp_number_raw" target="_blank" x-text="appSettings.whatsapp_number_display"></a></span><span class="ar" dir="rtl">ููุฏุงููู ูุงุด: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> ุฅูู <strong class="payment-ref-highlight" x-text="appSettings.payment_details.vodafone_cash || '010X'"></strong>. ูุฑุฌุน: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. ุฃูุฏ ุนุจุฑ ูุงุชุณุงุจ: <a :href="'https://wa.me/' + appSettings.whatsapp_number_raw" target="_blank" x-text="appSettings.whatsapp_number_display"></a></span></p></div>
                                <div x-show="paymentMethod === 'ip'"><p class="bil-row bil-row-prefer-inline"><span class="en">InstaPay: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> to <strong class="payment-ref-highlight" x-text="appSettings.payment_details.instapay_ipn || 'IPN@insta'"></strong>. Ref: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. Confirm WA.</span><span class="ar" dir="rtl">ุฅูุณุชุง ุจุงู: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> ุฅูู <strong class="payment-ref-highlight" x-text="appSettings.payment_details.instapay_ipn || 'IPN@insta'"></strong>. ูุฑุฌุน: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. ุฃูุฏ ูุงุชุณุงุจ.</span></p></div>
                                <div x-show="paymentMethod === 'revolut'"><p class="bil-row bil-row-prefer-inline"><span class="en">Revolut: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> to <strong class="payment-ref-highlight" x-text="appSettings.payment_details.revolut_details || '@Revtag'"></strong>. Ref: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. Confirm WA.</span><span class="ar" dir="rtl">ุฑูููููุช: <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> ุฅูู <strong class="payment-ref-highlight" x-text="appSettings.payment_details.revolut_details || '@Revtag'"></strong>. ูุฑุฌุน: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. ุฃูุฏ ูุงุชุณุงุจ.</span></p></div>
                                <div x-show="paymentMethod === 'bank_transfer'">
                                    <p class="bil-row bil-row-prefer-inline"><span class="en">Bank Transfer <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> to:</span><span class="ar" dir="rtl">ุชุญููู ุจููู <strong x-text="getFormattedPrice(totalPriceEGP)"></strong> ุฅูู:</span></p>
                                    <ul class="bank-details-list bil-row">
                                        <div class="en"><li>Bank: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_name || '[BANK]'"></strong></li><li>Acc Name: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_account_name || '[NAME]'"></strong></li><li>Acc No: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_account_number || '[NUMBER]'"></strong></li><li x-show="appSettings.payment_details.bank_iban">IBAN: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_iban"></strong></li><li x-show="appSettings.payment_details.bank_swift">SWIFT: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_swift"></strong></li></div>
                                        <div class="ar" dir="rtl"><li>ุงูุจูู: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_name || '[ุงูุจูู]'"></strong></li><li>ุงุณู ุงูุญุณุงุจ: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_account_name || '[ุงูุงุณู]'"></strong></li><li>ุฑูู ุงูุญุณุงุจ: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_account_number || '[ุงูุฑูู]'"></strong></li><li x-show="appSettings.payment_details.bank_iban">IBAN: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_iban"></strong></li><li x-show="appSettings.payment_details.bank_swift">SWIFT: <strong class="payment-ref-highlight" x-text="appSettings.payment_details.bank_swift"></strong></li></div>
                                    </ul>
                                    <p class="bil-row bank-transfer-crucial-note bil-row-prefer-inline"><span class="en">Crucial: Ref Booking ID: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. Confirm WA.</span><span class="ar" dir="rtl">ูุงู: ูุฑุฌุน ุงูุญุฌุฒ: <strong class="payment-ref-highlight" x-text="bookingID"></strong>. ุฃูุฏ ูุงุชุณุงุจ.</span></p>
                                </div>
                                <div x-show="paymentMethod === 'cod'"><p class="bil-row bil-row-prefer-inline"><span class="en">COD: Team will call <strong x-text="deliveryPhone"></strong>. Amount <strong x-text="getFormattedPrice(totalPriceEGP)"></strong>. ID: <strong x-text="bookingID"></strong>.</span><span class="ar" dir="rtl">ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู: ุณูุชุตู ุจู ุงููุฑูู ุนูู <strong x-text="deliveryPhone"></strong>. ุงููุจูุบ <strong x-text="getFormattedPrice(totalPriceEGP)"></strong>. ุฑูู ุงูุญุฌุฒ: <strong x-text="bookingID"></strong>.</span></p></div>
                            </div>
                        </div>
                        <div class="form-action tc page-step-action"><a href="#udheya-booking-start" class="btn bp btn-lg btn-block" @click.prevent="resetAndStartOver()"><span class="en">Book Another Udheya</span><span class="ar">ุญุฌุฒ ุฃุถุญูุฉ ุฃุฎุฑู</span></a></div>
                    </div>
                </section>
            </form>
        </section>

        <section id="check-booking-status" class="sec udheya-page-step seca check-status-section"><div class="c">
            <div class="sec-head"><h2><span class="en">Check Udheya Booking Status</span><span class="ar">ุชุญูู ูู ุญุงูุฉ ุญุฌุฒ ุฃุถุญูุชู</span></h2></div>
            <div class="card form-panel-card check-status-form-card"><div class="card-b">
                <form id="check-status-form-tag" @submit.prevent="checkBookingStatus()">
                    <label for="booking_id_lookup" class="bil-row check-status-label"><span class="en">Enter Booking ID</span><span class="ar">ุฃุฏุฎู ุฑูู ุงูุญุฌุฒ</span></label>
                    <div class="card-act"><input type="text" id="booking_id_lookup" name="booking_id_lookup" class="form-input-styled check-status-input" x-model="lookupBookingID" placeholder="e.g., SL-UDHY-YYYY-XXXXX"><button type="submit" id="btn-check-status" class="btn bp check-status-button" :disabled="isLoading.status"><span x-show="!isLoading.status"><span class="en">Check</span><span class="ar">ุชุญูู</span></span><span x-show="isLoading.status"><span class="en">Checking...</span><span class="ar">ุฌุงุฑู...</span></span></button></div>
                </form>
            </div></div>
            <div id="booking-status-results" class="card form-panel-card booking-status-results-card" x-show="isLoading.status || statusResult || statusNotFound" x-transition><div class="card-b">
                <div x-show="isLoading.status" class="loading-text">Checking...</div>
                <div x-show="statusResult && !isLoading.status">
                    <h4 class="form-panel-title bil-row"><span class="en">Booking Details</span><span class="ar">ุชูุงุตูู ุงูุญุฌุฒ</span></h4><div id="status-content">
                        <div class="summary-item bil-row"><div class="en"><strong>ID:</strong> <span x-text="statusResult?.booking_id_text"></span></div><div class="ar" dir="rtl"><strong>ุฑูู ุงูุญุฌุฒ:</strong> <span x-text="statusResult?.booking_id_text"></span></div></div>
                        <div class="summary-item bil-row"><div class="en"><strong>Status:</strong> <span class="status-highlight" x-text="statusResult?.status"></span></div><div class="ar" dir="rtl"><strong>ุงูุญุงูุฉ:</strong> <span class="status-highlight" x-text="statusResult?.status"></span></div></div>
                        <div class="summary-item bil-row"><div class="en"><strong>Animal:</strong> <span x-text="statusResult?.animal_type"></span>, <span x-text="statusResult?.animal_weight_selected"></span></div><div class="ar" dir="rtl"><strong>ุงูุญููุงู:</strong> <span x-text="statusResult?.animal_type"></span>ุ <span x-text="statusResult?.animal_weight_selected"></span></div></div>
                        <div class="summary-item bil-row"><div class="en"><strong>Scheduled:</strong> <span x-text="(statusResult?.sacrifice_day ? getSacrificeDayText(statusResult.sacrifice_day).en : '') + ', ' + statusResult?.time_slot"></span></div><div class="ar" dir="rtl"><strong>ุงูููุนุฏ:</strong> <span x-text="(statusResult?.sacrifice_day ? getSacrificeDayText(statusResult.sacrifice_day).ar : '') + '\u060C ' + statusResult?.time_slot"></span></div></div>
                    </div>
                </div>
                <div id="status-no-results" class="status-no-results-text" x-show="statusNotFound && !isLoading.status"><p class="en">No booking found. Check ID or contact support.</p><p class="ar" dir="rtl">ูู ูุชู ุงูุนุซูุฑ ุนูู ุญุฌุฒ. ุชุญูู ูู ุงูุฑูู ุฃู ุงุชุตู ุจุงูุฏุนู.</p></div>
            </div></div>
        </section>
    </main>

    <footer class="site-footer-main main-page-section"><div class="c">
        <div class="grid3 footer-grid">
                <p class="footer-brand-desc">
                    <span class="en">We are your full-service Egyptian team, committed to meeting your needs with exceptional speed and quality, sparing you the inconvenience of market visits.</span>
                    <span class="ar">ูุญู ูุฑูู ูุชูุงูู ูุชูุจูุฉ ุงุญุชูุงุฌุงุชู ุจุฃุณุฑุน ููุช ูุฃูุถู ุฌูุฏุฉุ ูููููู ุนูุงุก ุงูุฐูุงุจ ููุณูู.</span>
                </p>
            </div>
        </div>
    </div></footer>

    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
